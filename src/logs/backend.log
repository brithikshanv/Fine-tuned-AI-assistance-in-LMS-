2025-05-12 16:40:36,895 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='organizations'
2025-05-12 16:40:36,896 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS organizations (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                slug TEXT NOT NULL UNIQUE,
                name TEXT NOT NULL,
                default_logo_color TEXT,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                openai_api_key TEXT,
                openai_free_trial BOOLEAN
            )
2025-05-12 16:40:36,897 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_org_slug ON organizations (slug)
2025-05-12 16:40:36,898 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='org_api_keys'
2025-05-12 16:40:36,898 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS org_api_keys (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                org_id INTEGER NOT NULL,
                hashed_key TEXT NOT NULL UNIQUE,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,898 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_org_api_key_org_id ON org_api_keys (org_id)
2025-05-12 16:40:36,898 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_org_api_key_hashed_key ON org_api_keys (hashed_key)
2025-05-12 16:40:36,899 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='users'
2025-05-12 16:40:36,899 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS users (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                email TEXT NOT NULL UNIQUE,
                first_name TEXT,
                middle_name TEXT,
                last_name TEXT,
                default_dp_color TEXT,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP
            )
2025-05-12 16:40:36,899 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='user_organizations'
2025-05-12 16:40:36,900 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS user_organizations (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER NOT NULL,
                org_id INTEGER NOT NULL,
                role TEXT NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                UNIQUE(user_id, org_id),
                FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
                FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,900 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_user_org_user_id ON user_organizations (user_id)
2025-05-12 16:40:36,900 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_user_org_org_id ON user_organizations (org_id)
2025-05-12 16:40:36,901 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='cohorts'
2025-05-12 16:40:36,901 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS cohorts (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                name TEXT NOT NULL,
                org_id INTEGER NOT NULL,
                FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,902 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_cohort_org_id ON cohorts (org_id)
2025-05-12 16:40:36,902 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS user_cohorts (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER NOT NULL,
                cohort_id INTEGER NOT NULL,
                role TEXT NOT NULL,
                UNIQUE(user_id, cohort_id),
                FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
                FOREIGN KEY (cohort_id) REFERENCES cohorts(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,902 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_user_cohort_user_id ON user_cohorts (user_id)
2025-05-12 16:40:36,903 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_user_cohort_cohort_id ON user_cohorts (cohort_id)
2025-05-12 16:40:36,903 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS groups (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                cohort_id INTEGER NOT NULL,
                name TEXT,
                FOREIGN KEY (cohort_id) REFERENCES cohorts(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,903 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_group_cohort_id ON groups (cohort_id)
2025-05-12 16:40:36,903 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS user_groups (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER NOT NULL,
                group_id INTEGER NOT NULL,
                UNIQUE(user_id, group_id),
                FOREIGN KEY (group_id) REFERENCES groups(id) ON DELETE CASCADE,
                FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,904 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_user_group_user_id ON user_groups (user_id)
2025-05-12 16:40:36,904 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_user_group_group_id ON user_groups (group_id)
2025-05-12 16:40:36,904 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='courses'
2025-05-12 16:40:36,904 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS courses (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                org_id INTEGER NOT NULL,
                name TEXT NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,905 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_course_org_id ON courses (org_id)
2025-05-12 16:40:36,905 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='course_cohorts'
2025-05-12 16:40:36,906 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS course_cohorts (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                course_id INTEGER NOT NULL,
                cohort_id INTEGER NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                UNIQUE(course_id, cohort_id),
                FOREIGN KEY (course_id) REFERENCES courses(id) ON DELETE CASCADE,
                FOREIGN KEY (cohort_id) REFERENCES cohorts(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,906 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_course_cohort_course_id ON course_cohorts (course_id)
2025-05-12 16:40:36,906 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_course_cohort_cohort_id ON course_cohorts (cohort_id)
2025-05-12 16:40:36,906 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='milestones'
2025-05-12 16:40:36,907 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS milestones (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                org_id INTEGER NOT NULL,
                name TEXT NOT NULL,
                color TEXT,
                FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,907 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_milestone_org_id ON milestones (org_id)
2025-05-12 16:40:36,907 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='tags'
2025-05-12 16:40:36,908 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS tags (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                name TEXT NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                org_id INTEGER NOT NULL,
                FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,908 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_tag_org_id ON tags (org_id)
2025-05-12 16:40:36,908 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS task_tags (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                task_id INTEGER NOT NULL,
                tag_id INTEGER NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                UNIQUE(task_id, tag_id),
                FOREIGN KEY (task_id) REFERENCES tasks(id) ON DELETE CASCADE,
                FOREIGN KEY (tag_id) REFERENCES tags(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,909 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_task_tag_task_id ON task_tags (task_id)
2025-05-12 16:40:36,909 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='badges'
2025-05-12 16:40:36,909 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS badges (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER NOT NULL,
                value TEXT NOT NULL,
                type TEXT NOT NULL,
                image_path TEXT NOT NULL,
                bg_color TEXT NOT NULL,
                cohort_id INTEGER NOT NULL,
                FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
                FOREIGN KEY (cohort_id) REFERENCES cohorts(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,910 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_badge_user_id ON badges (user_id)
2025-05-12 16:40:36,910 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='tasks'
2025-05-12 16:40:36,910 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS tasks (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    org_id INTEGER NOT NULL,
                    type TEXT NOT NULL,
                    blocks TEXT,
                    title TEXT NOT NULL,
                    status TEXT NOT NULL,
                    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                    deleted_at DATETIME,
                    scheduled_publish_at DATETIME,
                    FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE
                )
2025-05-12 16:40:36,910 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_task_org_id ON tasks (org_id)
2025-05-12 16:40:36,911 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='questions'
2025-05-12 16:40:36,911 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS questions (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                task_id INTEGER NOT NULL,
                type TEXT NOT NULL,
                blocks TEXT,
                answer TEXT,
                input_type TEXT NOT NULL,
                coding_language TEXT,
                generation_model TEXT,
                response_type TEXT NOT NULL,
                position INTEGER NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                deleted_at DATETIME,
                max_attempts INTEGER,
                is_feedback_shown BOOLEAN NOT NULL,
                context TEXT,
                FOREIGN KEY (task_id) REFERENCES tasks(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,911 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_question_task_id ON questions (task_id)
2025-05-12 16:40:36,912 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='scorecards'
2025-05-12 16:40:36,912 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS scorecards (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                org_id INTEGER NOT NULL,
                title TEXT NOT NULL,
                criteria TEXT NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,912 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_scorecard_org_id ON scorecards (org_id)
2025-05-12 16:40:36,912 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='question_scorecards'
2025-05-12 16:40:36,913 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS question_scorecards (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                question_id INTEGER NOT NULL,
                scorecard_id INTEGER NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (question_id) REFERENCES questions(id) ON DELETE CASCADE,
                FOREIGN KEY (scorecard_id) REFERENCES scorecards(id) ON DELETE CASCADE,
                UNIQUE(question_id, scorecard_id)
            )
2025-05-12 16:40:36,913 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_question_scorecard_question_id ON question_scorecards (question_id)
2025-05-12 16:40:36,914 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_question_scorecard_scorecard_id ON question_scorecards (scorecard_id)
2025-05-12 16:40:36,914 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='task_scoring_criteria'
2025-05-12 16:40:36,914 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS task_scoring_criteria (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                task_id INTEGER NOT NULL,
                category TEXT NOT NULL,
                description TEXT NOT NULL,
                min_score INTEGER NOT NULL,
                max_score INTEGER NOT NULL,
                FOREIGN KEY (task_id) REFERENCES tasks(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,915 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_scoring_criteria_task_id ON task_scoring_criteria (task_id)
2025-05-12 16:40:36,915 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='tests'
2025-05-12 16:40:36,915 - api.utils.logging - INFO - Executing operation: 
            CREATE TABLE IF NOT EXISTS tests (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                task_id INTEGER NOT NULL,
                input TEXT NOT NULL,  -- This will store a JSON-encoded list of strings
                output TEXT NOT NULL,
                description TEXT,
                FOREIGN KEY (task_id) REFERENCES tasks(id) ON DELETE CASCADE
            )
            
2025-05-12 16:40:36,916 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_test_task_id ON tests (task_id)
2025-05-12 16:40:36,916 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='chat_history'
2025-05-12 16:40:36,916 - api.utils.logging - INFO - Executing operation: 
                CREATE TABLE IF NOT EXISTS chat_history (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    user_id INTEGER NOT NULL,
                    question_id INTEGER NOT NULL,
                    role TEXT NOT NULL,
                    content TEXT,
                    response_type TEXT,
                    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                    FOREIGN KEY (question_id) REFERENCES questions(id),
                    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
                )
2025-05-12 16:40:36,917 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_chat_history_user_id ON chat_history (user_id)
2025-05-12 16:40:36,917 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_chat_history_question_id ON chat_history (question_id)
2025-05-12 16:40:36,917 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='task_completions'
2025-05-12 16:40:36,918 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS task_completions (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER NOT NULL,
                task_id INTEGER,
                question_id INTEGER,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
                FOREIGN KEY (task_id) REFERENCES tasks(id) ON DELETE CASCADE,
                FOREIGN KEY (question_id) REFERENCES questions(id) ON DELETE CASCADE,
                UNIQUE(user_id, task_id),
                UNIQUE(user_id, question_id)
            )
2025-05-12 16:40:36,918 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_task_completion_user_id ON task_completions (user_id)
2025-05-12 16:40:36,918 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_task_completion_task_id ON task_completions (task_id)
2025-05-12 16:40:36,918 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_task_completion_question_id ON task_completions (question_id)
2025-05-12 16:40:36,919 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='course_tasks'
2025-05-12 16:40:36,919 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS course_tasks (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                task_id INTEGER NOT NULL,
                course_id INTEGER NOT NULL,
                ordering INTEGER NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                milestone_id INTEGER,
                UNIQUE(task_id, course_id),
                FOREIGN KEY (task_id) REFERENCES tasks(id) ON DELETE CASCADE,
                FOREIGN KEY (course_id) REFERENCES courses(id) ON DELETE CASCADE,
                FOREIGN KEY (milestone_id) REFERENCES milestones(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,919 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_course_task_task_id ON course_tasks (task_id)
2025-05-12 16:40:36,920 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_course_task_course_id ON course_tasks (course_id)
2025-05-12 16:40:36,920 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_course_task_milestone_id ON course_tasks (milestone_id)
2025-05-12 16:40:36,920 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='course_milestones'
2025-05-12 16:40:36,920 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS course_milestones (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                course_id INTEGER NOT NULL,
                milestone_id INTEGER,
                ordering INTEGER NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                UNIQUE(course_id, milestone_id),
                FOREIGN KEY (course_id) REFERENCES courses(id) ON DELETE CASCADE,
                FOREIGN KEY (milestone_id) REFERENCES milestones(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,921 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_course_milestone_course_id ON course_milestones (course_id)
2025-05-12 16:40:36,921 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_course_milestone_milestone_id ON course_milestones (milestone_id)
2025-05-12 16:40:36,922 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='cv_review_usage'
2025-05-12 16:40:36,922 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS cv_review_usage (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER NOT NULL,
                role TEXT NOT NULL,
                ai_review TEXT NOT NULL,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
            )
            
2025-05-12 16:40:36,923 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='course_generation_jobs'
2025-05-12 16:40:36,923 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS course_generation_jobs (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                uuid TEXT NOT NULL,
                course_id INTEGER NOT NULL,
                status TEXT NOT NULL,
                job_details TEXT,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (course_id) REFERENCES courses(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,923 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_course_generation_job_course_id ON course_generation_jobs (course_id)
2025-05-12 16:40:36,923 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='task_generation_jobs'
2025-05-12 16:40:36,924 - api.utils.logging - INFO - Executing operation: CREATE TABLE IF NOT EXISTS task_generation_jobs (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                uuid TEXT NOT NULL,
                task_id INTEGER NOT NULL,
                course_id INTEGER NOT NULL,
                status TEXT NOT NULL,
                job_details TEXT,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (task_id) REFERENCES tasks(id) ON DELETE CASCADE,
                FOREIGN KEY (course_id) REFERENCES courses(id) ON DELETE CASCADE
            )
2025-05-12 16:40:36,924 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_task_generation_job_task_id ON task_generation_jobs (task_id)
2025-05-12 16:40:36,924 - api.utils.logging - INFO - Executing operation: CREATE INDEX idx_task_generation_job_course_id ON task_generation_jobs (course_id)
2025-05-12 16:42:07,460 - api.utils.logging - INFO - Logging system initialized
2025-05-12 16:42:08,497 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-12 16:42:08,497 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-12 16:43:07,773 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:43:07,783 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:13:07.697279+00:00'
        RETURNING id
        
2025-05-12 16:43:07,786 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:44:07,744 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:44:07,753 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:14:07.698109+00:00'
        RETURNING id
        
2025-05-12 16:44:07,755 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:44:32,191 - api.utils.logging - INFO - Executing operation: SELECT * FROM users WHERE email = 'saranz1593@gmail.com'
2025-05-12 16:44:32,194 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:44:32,194 - api.utils.logging - INFO - Executing operation: 
        INSERT INTO users (email, default_dp_color, first_name, middle_name, last_name)
        VALUES ('saranz1593@gmail.com', '#6ecddd', 'Saran', NULL, '')
    
2025-05-12 16:44:32,195 - api.utils.logging - INFO - Executing operation: SELECT * FROM users WHERE email = 'saranz1593@gmail.com'
2025-05-12 16:44:32,196 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:44:34,144 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-12 16:44:34,148 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 16:44:34,155 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 16:44:34,164 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 16:45:07,661 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:45:07,662 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:15:07.658201+00:00'
        RETURNING id
        
2025-05-12 16:45:07,663 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:46:07,654 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:46:07,655 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:16:07.649826+00:00'
        RETURNING id
        
2025-05-12 16:46:07,655 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:47:07,711 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:47:07,721 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:17:07.673422+00:00'
        RETURNING id
        
2025-05-12 16:47:07,722 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:48:02,102 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 16:48:02,134 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-12 16:48:02,137 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 16:48:02,139 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 16:48:07,673 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:48:07,677 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:18:07.666801+00:00'
        RETURNING id
        
2025-05-12 16:48:07,678 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:49:07,690 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:49:07,694 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:19:07.667295+00:00'
        RETURNING id
        
2025-05-12 16:49:07,695 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:50:07,669 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:50:07,670 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:20:07.662627+00:00'
        RETURNING id
        
2025-05-12 16:50:07,671 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:51:07,671 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:51:07,672 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:21:07.667087+00:00'
        RETURNING id
        
2025-05-12 16:51:07,672 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:52:07,653 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:52:07,654 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:22:07.649703+00:00'
        RETURNING id
        
2025-05-12 16:52:07,654 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:53:07,674 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:53:07,675 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:23:07.670693+00:00'
        RETURNING id
        
2025-05-12 16:53:07,676 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:54:07,653 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:54:07,653 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:24:07.649058+00:00'
        RETURNING id
        
2025-05-12 16:54:07,654 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:55:07,658 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:55:07,658 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:25:07.654381+00:00'
        RETURNING id
        
2025-05-12 16:55:07,659 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:56:07,665 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:56:07,665 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:26:07.661434+00:00'
        RETURNING id
        
2025-05-12 16:56:07,665 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:57:07,651 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:57:07,651 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:27:07.647416+00:00'
        RETURNING id
        
2025-05-12 16:57:07,651 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:58:07,661 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:58:07,661 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:28:07.656750+00:00'
        RETURNING id
        
2025-05-12 16:58:07,661 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 16:59:07,660 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 16:59:07,660 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:29:07.656825+00:00'
        RETURNING id
        
2025-05-12 16:59:07,660 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:00:07,663 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:00:07,664 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:30:07.659839+00:00'
        RETURNING id
        
2025-05-12 17:00:07,664 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:01:07,661 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:01:07,662 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:31:07.656763+00:00'
        RETURNING id
        
2025-05-12 17:01:07,662 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:02:07,663 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:02:07,663 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:32:07.658579+00:00'
        RETURNING id
        
2025-05-12 17:02:07,663 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:03:07,666 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:03:07,666 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:33:07.661936+00:00'
        RETURNING id
        
2025-05-12 17:03:07,667 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:04:07,661 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:04:07,662 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:34:07.658334+00:00'
        RETURNING id
        
2025-05-12 17:04:07,662 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:05:07,659 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:05:07,660 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:35:07.656129+00:00'
        RETURNING id
        
2025-05-12 17:05:07,660 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:06:07,654 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:06:07,654 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:36:07.650095+00:00'
        RETURNING id
        
2025-05-12 17:06:07,654 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:07:07,658 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:07:07,658 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:37:07.653623+00:00'
        RETURNING id
        
2025-05-12 17:07:07,658 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:08:07,657 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:08:07,658 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:38:07.653603+00:00'
        RETURNING id
        
2025-05-12 17:08:07,658 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:09:07,664 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:09:07,664 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:39:07.660753+00:00'
        RETURNING id
        
2025-05-12 17:09:07,665 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:10:07,649 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:10:07,650 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:40:07.645987+00:00'
        RETURNING id
        
2025-05-12 17:10:07,650 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:11:07,707 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:11:07,709 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:41:07.670454+00:00'
        RETURNING id
        
2025-05-12 17:11:07,710 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:12:07,661 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:12:07,661 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:42:07.657956+00:00'
        RETURNING id
        
2025-05-12 17:12:07,661 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:13:07,664 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:13:07,665 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:43:07.660453+00:00'
        RETURNING id
        
2025-05-12 17:13:07,665 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:14:07,656 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:14:07,656 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:44:07.652141+00:00'
        RETURNING id
        
2025-05-12 17:14:07,656 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:15:07,656 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:15:07,656 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:45:07.652854+00:00'
        RETURNING id
        
2025-05-12 17:15:07,656 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:16:07,667 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:16:07,667 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:46:07.660888+00:00'
        RETURNING id
        
2025-05-12 17:16:07,667 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:17:07,654 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:17:07,654 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:47:07.650420+00:00'
        RETURNING id
        
2025-05-12 17:17:07,654 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:18:07,653 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:18:07,653 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:48:07.648413+00:00'
        RETURNING id
        
2025-05-12 17:18:07,654 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:19:07,662 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:19:07,663 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:49:07.658893+00:00'
        RETURNING id
        
2025-05-12 17:19:07,663 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:20:07,653 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:20:07,653 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:50:07.649585+00:00'
        RETURNING id
        
2025-05-12 17:20:07,654 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:21:07,658 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:21:07,659 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:51:07.649786+00:00'
        RETURNING id
        
2025-05-12 17:21:07,659 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:22:07,667 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:22:07,667 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:52:07.660284+00:00'
        RETURNING id
        
2025-05-12 17:22:07,668 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:23:07,659 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:23:07,660 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:53:07.654832+00:00'
        RETURNING id
        
2025-05-12 17:23:07,660 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:23:30,236 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-12 17:23:30,242 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 17:23:30,243 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 17:23:30,262 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 17:24:07,680 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:24:07,685 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:54:07.674242+00:00'
        RETURNING id
        
2025-05-12 17:24:07,686 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:25:07,653 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:25:07,653 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:55:07.649050+00:00'
        RETURNING id
        
2025-05-12 17:25:07,654 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:26:07,657 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:26:07,658 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:56:07.652690+00:00'
        RETURNING id
        
2025-05-12 17:26:07,658 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:27:07,665 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:27:07,666 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:57:07.661141+00:00'
        RETURNING id
        
2025-05-12 17:27:07,666 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:28:07,664 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:28:07,664 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:58:07.659329+00:00'
        RETURNING id
        
2025-05-12 17:28:07,664 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:29:07,668 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:29:07,669 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 11:59:07.660750+00:00'
        RETURNING id
        
2025-05-12 17:29:07,670 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:30:07,652 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:30:07,653 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:00:07.647273+00:00'
        RETURNING id
        
2025-05-12 17:30:07,653 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:31:07,665 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:31:07,665 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:01:07.660944+00:00'
        RETURNING id
        
2025-05-12 17:31:07,665 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:32:07,657 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:32:07,657 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:02:07.652656+00:00'
        RETURNING id
        
2025-05-12 17:32:07,657 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:33:07,661 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:33:07,662 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:03:07.655456+00:00'
        RETURNING id
        
2025-05-12 17:33:07,663 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:34:07,729 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:34:07,740 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:04:07.671595+00:00'
        RETURNING id
        
2025-05-12 17:34:07,741 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:35:07,663 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:35:07,663 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:05:07.658676+00:00'
        RETURNING id
        
2025-05-12 17:35:07,664 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:36:07,666 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:36:07,666 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:06:07.661479+00:00'
        RETURNING id
        
2025-05-12 17:36:07,667 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:37:07,657 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:37:07,657 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:07:07.653417+00:00'
        RETURNING id
        
2025-05-12 17:37:07,658 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:38:07,656 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:38:07,657 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:08:07.652553+00:00'
        RETURNING id
        
2025-05-12 17:38:07,657 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:39:07,655 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:39:07,655 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:09:07.650084+00:00'
        RETURNING id
        
2025-05-12 17:39:07,656 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:40:07,651 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:40:07,651 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:10:07.647400+00:00'
        RETURNING id
        
2025-05-12 17:40:07,652 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:41:07,654 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:41:07,654 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:11:07.648661+00:00'
        RETURNING id
        
2025-05-12 17:41:07,654 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:42:07,664 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:42:07,665 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:12:07.659096+00:00'
        RETURNING id
        
2025-05-12 17:42:07,665 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:43:07,665 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:43:07,666 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:13:07.658159+00:00'
        RETURNING id
        
2025-05-12 17:43:07,666 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:44:07,661 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:44:07,661 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:14:07.657140+00:00'
        RETURNING id
        
2025-05-12 17:44:07,662 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:45:07,664 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:45:07,664 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:15:07.660855+00:00'
        RETURNING id
        
2025-05-12 17:45:07,665 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:46:07,657 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:46:07,657 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:16:07.651059+00:00'
        RETURNING id
        
2025-05-12 17:46:07,657 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:47:07,662 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:47:07,663 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:17:07.658737+00:00'
        RETURNING id
        
2025-05-12 17:47:07,663 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:48:07,660 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:48:07,660 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:18:07.655845+00:00'
        RETURNING id
        
2025-05-12 17:48:07,660 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:49:07,654 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:49:07,655 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:19:07.651352+00:00'
        RETURNING id
        
2025-05-12 17:49:07,655 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:50:07,664 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:50:07,665 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:20:07.660790+00:00'
        RETURNING id
        
2025-05-12 17:50:07,665 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:51:07,663 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:51:07,663 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:21:07.659954+00:00'
        RETURNING id
        
2025-05-12 17:51:07,664 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:52:07,672 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:52:07,673 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:22:07.668414+00:00'
        RETURNING id
        
2025-05-12 17:52:07,673 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:53:07,663 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:53:07,663 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:23:07.659404+00:00'
        RETURNING id
        
2025-05-12 17:53:07,664 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:54:07,660 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:54:07,661 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:24:07.657235+00:00'
        RETURNING id
        
2025-05-12 17:54:07,661 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:55:07,659 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:55:07,659 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:25:07.656236+00:00'
        RETURNING id
        
2025-05-12 17:55:07,659 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:56:07,657 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:56:07,658 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:26:07.653157+00:00'
        RETURNING id
        
2025-05-12 17:56:07,658 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:57:07,662 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:57:07,662 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:27:07.658891+00:00'
        RETURNING id
        
2025-05-12 17:57:07,663 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:58:07,760 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:58:07,772 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:28:07.693247+00:00'
        RETURNING id
        
2025-05-12 17:58:07,774 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 17:59:07,733 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 17:59:07,743 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:29:07.682768+00:00'
        RETURNING id
        
2025-05-12 17:59:07,745 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:00:07,669 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:00:07,670 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:30:07.656312+00:00'
        RETURNING id
        
2025-05-12 18:00:07,671 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:00:46,504 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:00:46,540 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-12 18:00:46,542 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:00:46,548 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:00:53,492 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:00:53,505 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-12 18:00:53,508 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:00:53,521 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:01:07,669 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:01:07,672 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:31:07.664195+00:00'
        RETURNING id
        
2025-05-12 18:01:07,672 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:02:07,715 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:02:07,721 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:32:07.676192+00:00'
        RETURNING id
        
2025-05-12 18:02:07,722 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:02:26,933 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:02:26,938 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-12 18:02:26,965 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:02:26,965 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:03:07,802 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:03:07,811 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:33:07.731163+00:00'
        RETURNING id
        
2025-05-12 18:03:07,812 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:08:01,111 - api.utils.logging - INFO - Logging system initialized
2025-05-12 18:08:01,627 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-12 18:08:01,646 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-12 18:08:12,067 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:08:12,074 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:08:12,080 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-12 18:08:12,084 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:08:15,352 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:08:15,358 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:08:15,382 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:09:01,308 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:09:01,309 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:39:01.296679+00:00'
        RETURNING id
        
2025-05-12 18:09:01,309 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:09:15,445 - api.utils.logging - INFO - Executing operation: SELECT id FROM organizations WHERE slug = 'agiletribers'
2025-05-12 18:09:15,451 - api.utils.logging - INFO - Executing operation: SELECT * FROM users WHERE id = 1
2025-05-12 18:09:15,457 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:09:15,457 - api.utils.logging - INFO - Executing operation: INSERT INTO organizations 
                (slug, name)
                VALUES ('agiletribers', 'AgileTribers')
2025-05-12 18:09:15,458 - api.utils.logging - INFO - Executing operation: INSERT INTO user_organizations
            (user_id, org_id, role)
            VALUES (1, 1, 'owner')
2025-05-12 18:09:15,458 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:09:21,674 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:09:21,683 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:09:21,706 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-12 18:09:21,707 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:09:21,719 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-12 18:09:21,728 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-12 18:09:21,736 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-12 18:09:21,743 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-12 18:09:21,752 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-12 18:09:21,758 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-12 18:09:21,767 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-12 18:09:21,785 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:09:44,052 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-12 18:09:44,057 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:09:44,057 - api.utils.logging - INFO - Executing operation: 
        INSERT INTO courses (name, org_id)
        VALUES ('HTML', 1)
        
2025-05-12 18:09:44,058 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:09:54,949 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-12 18:09:54,955 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:09:54,955 - api.utils.logging - INFO - Executing operation: 
        INSERT INTO courses (name, org_id)
        VALUES ('HTML', 1)
        
2025-05-12 18:09:54,956 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:09:56,940 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-12 18:09:56,952 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:09:56,968 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-12 18:09:56,975 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:09:56,981 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:09:56,988 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:09:56,997 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:09:57,005 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:09:57,010 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:10:01,299 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:10:01,299 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:40:01.295983+00:00'
        RETURNING id
        
2025-05-12 18:10:01,300 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:11:01,291 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:11:01,291 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:41:01.286893+00:00'
        RETURNING id
        
2025-05-12 18:11:01,291 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:12:01,293 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:12:01,294 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:42:01.290143+00:00'
        RETURNING id
        
2025-05-12 18:12:01,294 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:13:01,295 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:13:01,295 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:43:01.291008+00:00'
        RETURNING id
        
2025-05-12 18:13:01,295 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:14:01,288 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:14:01,289 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:44:01.284709+00:00'
        RETURNING id
        
2025-05-12 18:14:01,289 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:15:01,296 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:15:01,296 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:45:01.292334+00:00'
        RETURNING id
        
2025-05-12 18:15:01,296 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:16:01,294 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:16:01,294 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:46:01.290303+00:00'
        RETURNING id
        
2025-05-12 18:16:01,295 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:17:01,290 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:17:01,290 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:47:01.286460+00:00'
        RETURNING id
        
2025-05-12 18:17:01,291 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:18:01,303 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:18:01,304 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:48:01.299565+00:00'
        RETURNING id
        
2025-05-12 18:18:01,304 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:19:01,299 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:19:01,300 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:49:01.295855+00:00'
        RETURNING id
        
2025-05-12 18:19:01,300 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:19:58,702 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 2
2025-05-12 18:19:58,707 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:19:58,707 - api.utils.logging - INFO - Executing operation: INSERT INTO milestones (name, color, org_id) VALUES ('New Module', '#3c322d', 1)
2025-05-12 18:19:58,708 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_milestones WHERE course_id = 2
2025-05-12 18:19:58,709 - api.utils.logging - INFO - Executing operation: INSERT INTO course_milestones (course_id, milestone_id, ordering) VALUES (2, 1, 0)
2025-05-12 18:19:58,709 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:20:01,300 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:20:01,301 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:50:01.286140+00:00'
        RETURNING id
        
2025-05-12 18:20:01,301 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:20:02,485 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 2
2025-05-12 18:20:02,490 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:20:02,490 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'learning_material', 'New Learning Material', 'draft')
2025-05-12 18:20:02,490 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 2 AND milestone_id = 1
2025-05-12 18:20:02,491 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (2, 1, 1, 0)
2025-05-12 18:20:02,491 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:20:02,505 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 2 AND ct.milestone_id = 1 AND ct.ordering < 0 AND t.deleted_at IS NULL
            
2025-05-12 18:20:24,637 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:20:24,639 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:20:24,648 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:20:24,658 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:20:24,670 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:20:24,678 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:20:25,341 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:20:25,354 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:20:37,638 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 2
2025-05-12 18:20:37,643 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:20:37,643 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'quiz', 'New Quiz', 'draft')
2025-05-12 18:20:37,651 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 2 AND milestone_id = 1
2025-05-12 18:20:37,651 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (2, 2, 1, 1)
2025-05-12 18:20:37,652 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:20:37,688 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 2 AND ct.milestone_id = 1 AND ct.ordering < 1 AND t.deleted_at IS NULL
            
2025-05-12 18:20:41,846 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-12 18:20:41,854 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-12 18:20:41,868 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 2 AND deleted_at IS NULL
        
2025-05-12 18:20:41,875 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 2 ORDER BY position ASC
            
2025-05-12 18:20:41,888 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 2 AND deleted_at IS NULL
        
2025-05-12 18:20:41,894 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 2 ORDER BY position ASC
            
2025-05-12 18:21:01,300 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:21:01,300 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:51:01.296614+00:00'
        RETURNING id
        
2025-05-12 18:21:01,301 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:21:03,988 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 2 AND deleted_at IS NULL
        
2025-05-12 18:21:03,993 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 2 AND deleted_at IS NULL
        
2025-05-12 18:21:03,998 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:21:03,998 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 2)
2025-05-12 18:21:03,998 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 2
2025-05-12 18:21:04,007 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (2, 'objective', '[{"id": "105cb32d-ec9e-4b49-b55a-a6537fdeaa19", "type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Question Editor!", "type": "text", "styles": {}}], "children": [], "position": 0}, {"id": "9a86dc70-92f4-42a1-b8ea-b2e51ba433e7", "type": "paragraph", "props": {}, "content": [{"text": "This is where you will create your question. You can modify this template or remove it to start from scratch.", "type": "text", "styles": {}}], "children": [], "position": 1}, {"id": "038aa2f5-b590-4c0a-8068-8f760b65b59f", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 2}, {"id": "29857b2a-075a-4521-9696-5dd50d5aef3c", "type": "heading", "props": {"level": 3}, "content": [{"text": "Question Types", "type": "text", "styles": {}}], "children": [], "position": 3}, {"id": "171a58f4-25dd-4542-b8e9-4e97f7e6039c", "type": "paragraph", "props": {}, "content": [{"text": "You can select from these question types:", "type": "text", "styles": {}}], "children": [], "position": 4}, {"id": "377f372c-2eaa-451d-8308-63ded3ba2765", "type": "bulletListItem", "props": {}, "content": [{"text": "Objective", "type": "text", "styles": {"bold": true}}, {"text": ": For questions with specific correct answers (multiple choice, true/false, etc.)", "type": "text", "styles": {}}], "children": [], "position": 5}, {"id": "0c2d62d1-c009-424b-9210-0e4bfff6ac5c", "type": "bulletListItem", "props": {}, "content": [{"text": "Subjective", "type": "text", "styles": {"bold": true}}, {"text": ": For questions that don''t have a single correct answer.", "type": "text", "styles": {}}], "children": [], "position": 6}, {"id": "01eceb60-7f67-458b-95f8-6bb5bf5cc43c", "type": "bulletListItem", "props": {}, "content": [{"text": "Coding", "type": "text", "styles": {"bold": true}}, {"text": ": For questions that require learners to write code as their answer", "type": "text", "styles": {}}], "children": [], "position": 7}, {"id": "94d4a074-ce53-4643-b490-3f3e5806dba1", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 8}, {"id": "cf9b31a6-d15d-439a-a22b-67950bae0bf3", "type": "heading", "props": {"level": 3}, "content": [{"text": "Answer Types", "type": "text", "styles": {}}], "children": [], "position": 9}, {"id": "8f55eb47-40de-4e7a-b499-5dcae3f13ff6", "type": "paragraph", "props": {}, "content": [{"text": "You can select from these answer types:", "type": "text", "styles": {}}], "children": [], "position": 10}, {"id": "2709afc4-36ad-421c-81cb-008b2b2727ff", "type": "bulletListItem", "props": {}, "content": [{"text": "Text", "type": "text", "styles": {"bold": true}}, {"text": ": Learners need to type their answer", "type": "text", "styles": {}}], "children": [], "position": 11}, {"id": "3ea3e72c-730f-48c2-82df-4b8005586003", "type": "bulletListItem", "props": {}, "content": [{"text": "Audio", "type": "text", "styles": {"bold": true}}, {"text": ": Learners need to record their answer", "type": "text", "styles": {}}], "children": [], "position": 12}, {"id": "44605779-0937-4ed7-92c5-cd9dce3b46f7", "type": "bulletListItem", "props": {}, "content": [{"text": "Code", "type": "text", "styles": {"bold": true}}, {"text": ": Learners need to write code as their answer in a code editor. They can run their code and see the output without leaving the editor and submit when they are done.", "type": "text", "styles": {}}], "children": [], "position": 13}, {"id": "3b630bf4-6bc1-4e25-af28-4396cd071b9d", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 14}, {"id": "954409cd-a515-4897-a31c-9d42583a8847", "type": "heading", "props": {"level": 3}, "content": [{"text": "Editor Tabs", "type": "text", "styles": {}}], "children": [], "position": 15}, {"id": "984c2372-e5aa-4e1f-9966-f290de56a5af", "type": "paragraph", "props": {}, "content": [{"text": "The Question Editor has three tabs for this question type:", "type": "text", "styles": {}}], "children": [], "position": 16}, {"id": "c6f9bd4d-51af-46c6-bc1a-116ee0ffd4e0", "type": "bulletListItem", "props": {}, "content": [{"text": "Question", "type": "text", "styles": {"bold": true}}, {"text": ": (Current tab) Where you write the question text", "type": "text", "styles": {}}], "children": [], "position": 17}, {"id": "83a8f235-e488-4833-ab09-0419696f909b", "type": "bulletListItem", "props": {}, "content": [{"text": "Correct Answer", "type": "text", "styles": {"bold": true}}, {"text": ": Where you provide the expected answer for automatic evaluation", "type": "text", "styles": {}}], "children": [], "position": 18}, {"id": "2b6ca5c4-3b6f-46a8-a33b-a7d1daf41727", "type": "bulletListItem", "props": {}, "content": [{"text": "AI Training", "type": "text", "styles": {"bold": true}}, {"text": ": Where you can add knowledge base content to help AI evaluate learner responses", "type": "text", "styles": {}}], "children": [], "position": 19}, {"id": "5b173a9e-203a-4825-806c-24ae2b9f5e67", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 20}, {"id": "9e6c90f8-1c4c-4485-be93-48a57a40ce7a", "type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "children": [], "position": 21}, {"id": "39d51d22-af28-40aa-b02b-91b5ca4f9590", "type": "paragraph", "props": {}, "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "children": [], "position": 22}, {"id": "16bd2892-5216-4dd8-ba27-27f9b2d5402a", "type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "children": [], "position": 23}, {"id": "ee6aed6a-111c-40c6-98a7-092787909eb7", "type": "bulletListItem", "props": {}, "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 24}, {"id": "b8e1eb9f-923d-46e8-92d3-1b412feaa2c5", "type": "numberedListItem", "props": {}, "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 25}, {"id": "70d08abc-0be1-4eae-8acc-2e90c5fe3d6f", "type": "checkListItem", "props": {}, "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 26}, {"id": "228284dc-5637-4681-bf63-b76de9ee6bdc", "type": "paragraph", "props": {}, "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "children": [], "position": 27}, {"id": "2f78dd67-18a2-4830-a586-0e96b0f90313", "type": "paragraph", "props": {}, "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "children": [], "position": 28}, {"id": "2d4c2568-2c47-44a9-9a3c-566061359d87", "type": "paragraph", "props": {}, "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "children": [], "position": 29}, {"id": "c584df6f-d87a-40f4-94bc-0cc4fe32f0c8", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 30}, {"id": "179cc2b3-bcfa-4148-bc02-9fc316aeeb4b", "type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "children": [], "position": 31}, {"id": "4995d221-ac01-4d1a-815f-3dd1e0bc5fd3", "type": "paragraph", "props": {}, "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "children": [], "position": 32}, {"id": "a30e3898-0037-4cc4-b213-ccbe4df80bcd", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "children": [], "position": 33}, {"id": "1a346fb4-60d9-47a5-bdec-c38ee4f2682f", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "children": [], "position": 34}, {"id": "5288e71b-8eba-40ca-81cb-aab22cda3c05", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 35}, {"id": "1710e3ac-ced3-4aea-9cb7-2993fa5ce6f7", "type": "paragraph", "props": {}, "content": [{"text": "Here is an example of a nested list:", "type": "text", "styles": {"bold": true}}], "children": [], "position": 36}, {"id": "e1624fe1-5071-433d-acdf-db508f702d2c", "type": "bulletListItem", "props": {}, "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "position": 37}, {"id": "fb560361-b88e-4646-957c-897b64a5d322", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 38}, {"id": "67333987-6bdf-4173-b390-2c53886295d2", "type": "heading", "props": {"level": 3}, "content": [{"text": "Writing Effective Questions", "type": "text", "styles": {}}], "children": [], "position": 39}, {"id": "a6a5e2c9-15f0-4f06-b55f-b3250c196f1c", "type": "paragraph", "props": {}, "content": [{"text": "For best results:", "type": "text", "styles": {}}], "children": [], "position": 40}, {"id": "9c87cc01-840c-4fea-9533-efb9953ecca1", "type": "bulletListItem", "props": {}, "content": [{"text": "Be clear and specific in your question text", "type": "text", "styles": {}}], "children": [], "position": 41}, {"id": "e89e3a08-0dcd-4cbd-8290-72f8bec8f8fa", "type": "bulletListItem", "props": {}, "content": [{"text": "Make sure your correct answer is complete and matches the expected format", "type": "text", "styles": {}}], "children": [], "position": 42}, {"id": "702d1389-c812-4dc4-a0dd-ee87c0d2da0e", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 43}, {"id": "5a821a62-4490-4b5e-8fb4-63a81f5bb6ff", "type": "heading", "props": {"level": 3}, "content": [{"text": "Preview and Publishing", "type": "text", "styles": {}}], "children": [], "position": 44}, {"id": "51b9be5a-a7ba-4345-8bcc-49a72ee67cef", "type": "paragraph", "props": {}, "content": [{"text": "When you''re ready to test your quiz:", "type": "text", "styles": {}}], "children": [], "position": 45}, {"id": "73fac486-d01f-4368-902c-f1dfbb382077", "type": "bulletListItem", "props": {}, "content": [{"text": "Preview Button", "type": "text", "styles": {"bold": true}}, {"text": ": Lets you see and answer the question exactly as a learner will see it", "type": "text", "styles": {}}], "children": [], "position": 46}, {"id": "3753d7e8-0895-4567-8f4d-44303ca3901c", "type": "bulletListItem", "props": {}, "content": [{"text": "Publish Button", "type": "text", "styles": {"bold": true}}, {"text": ": Makes the quiz available to learners. You can always edit and publish again", "type": "text", "styles": {}}], "children": [], "position": 47}, {"id": "641fb3a0-2177-405a-b3a1-c67d0094eb8a", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 48}, {"id": "7bfb49af-d560-4eed-b1c0-c655883cc786", "type": "paragraph", "props": {}, "content": [{"text": "Delete this template when you are ready to create your own question!", "type": "text", "styles": {}}], "children": [], "position": 49}]', NULL, 'text', 'chat', NULL, NULL, NULL, 0, NULL, 1)
                
2025-05-12 18:21:04,009 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (2, 'objective', '[{"id": "4ab1fb72-913e-4a21-bd0b-b54b0d537097", "type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Question Editor!", "type": "text", "styles": {}}], "children": [], "position": 0}, {"id": "b0f997a2-a692-4a93-8e15-b4a0ff8f9418", "type": "paragraph", "props": {}, "content": [{"text": "This is where you will create your question. You can modify this template or remove it to start from scratch.", "type": "text", "styles": {}}], "children": [], "position": 1}, {"id": "b59ebf96-e717-4aa0-a3d6-825f6781d7ff", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 2}, {"id": "a1ea2d14-a64f-40c0-a2a2-b882a84fccd8", "type": "heading", "props": {"level": 3}, "content": [{"text": "Question Types", "type": "text", "styles": {}}], "children": [], "position": 3}, {"id": "746b5722-f519-4dde-9a00-1f380fc7bcf7", "type": "paragraph", "props": {}, "content": [{"text": "You can select from these question types:", "type": "text", "styles": {}}], "children": [], "position": 4}, {"id": "901c3952-293d-4155-b70d-8b01998fa379", "type": "bulletListItem", "props": {}, "content": [{"text": "Objective", "type": "text", "styles": {"bold": true}}, {"text": ": For questions with specific correct answers (multiple choice, true/false, etc.)", "type": "text", "styles": {}}], "children": [], "position": 5}, {"id": "162f30dc-0837-4c80-b913-572298759276", "type": "bulletListItem", "props": {}, "content": [{"text": "Subjective", "type": "text", "styles": {"bold": true}}, {"text": ": For questions that don''t have a single correct answer.", "type": "text", "styles": {}}], "children": [], "position": 6}, {"id": "a611ec52-fba8-4cf6-9da8-e5db1b47cc6f", "type": "bulletListItem", "props": {}, "content": [{"text": "Coding", "type": "text", "styles": {"bold": true}}, {"text": ": For questions that require learners to write code as their answer", "type": "text", "styles": {}}], "children": [], "position": 7}, {"id": "3c93b27f-af25-47f9-a096-565202aeb2b4", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 8}, {"id": "2435316d-c44c-47db-8105-0605ce74169f", "type": "heading", "props": {"level": 3}, "content": [{"text": "Answer Types", "type": "text", "styles": {}}], "children": [], "position": 9}, {"id": "872bd86b-a160-40d0-956d-42790c4f2042", "type": "paragraph", "props": {}, "content": [{"text": "You can select from these answer types:", "type": "text", "styles": {}}], "children": [], "position": 10}, {"id": "b8dd7f8c-c2e1-4b80-bcac-13286be32e08", "type": "bulletListItem", "props": {}, "content": [{"text": "Text", "type": "text", "styles": {"bold": true}}, {"text": ": Learners need to type their answer", "type": "text", "styles": {}}], "children": [], "position": 11}, {"id": "1c9b5448-4cf9-4126-acf1-53cbd82496e2", "type": "bulletListItem", "props": {}, "content": [{"text": "Audio", "type": "text", "styles": {"bold": true}}, {"text": ": Learners need to record their answer", "type": "text", "styles": {}}], "children": [], "position": 12}, {"id": "f71b50fc-c9fb-450a-bdd0-5902e8fccfaf", "type": "bulletListItem", "props": {}, "content": [{"text": "Code", "type": "text", "styles": {"bold": true}}, {"text": ": Learners need to write code as their answer in a code editor. They can run their code and see the output without leaving the editor and submit when they are done.", "type": "text", "styles": {}}], "children": [], "position": 13}, {"id": "5da0e4ff-448f-40de-bdab-61513daf9c97", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 14}, {"id": "f7120016-93d3-4007-8327-3365e1701692", "type": "heading", "props": {"level": 3}, "content": [{"text": "Editor Tabs", "type": "text", "styles": {}}], "children": [], "position": 15}, {"id": "6761d47f-94e1-4474-bdba-5050e66a5c53", "type": "paragraph", "props": {}, "content": [{"text": "The Question Editor has three tabs for this question type:", "type": "text", "styles": {}}], "children": [], "position": 16}, {"id": "e989d76f-6464-4de8-8349-e35f315d14b6", "type": "bulletListItem", "props": {}, "content": [{"text": "Question", "type": "text", "styles": {"bold": true}}, {"text": ": (Current tab) Where you write the question text", "type": "text", "styles": {}}], "children": [], "position": 17}, {"id": "63745ae2-8ed2-4d2c-9928-717d820880cb", "type": "bulletListItem", "props": {}, "content": [{"text": "Correct Answer", "type": "text", "styles": {"bold": true}}, {"text": ": Where you provide the expected answer for automatic evaluation", "type": "text", "styles": {}}], "children": [], "position": 18}, {"id": "53934d75-ecaa-4c80-a544-3d5c20d422e1", "type": "bulletListItem", "props": {}, "content": [{"text": "AI Training", "type": "text", "styles": {"bold": true}}, {"text": ": Where you can add knowledge base content to help AI evaluate learner responses", "type": "text", "styles": {}}], "children": [], "position": 19}, {"id": "91f72f04-85e0-4eb7-9b01-8198c29e2476", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 20}, {"id": "7fbd6f60-ee3e-4cae-917a-2c284dd7026a", "type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "children": [], "position": 21}, {"id": "415280de-0d29-4fbf-a722-aa2a1f4f045f", "type": "paragraph", "props": {}, "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "children": [], "position": 22}, {"id": "b6144d9c-2190-45ab-9b40-c9a7b72dc696", "type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "children": [], "position": 23}, {"id": "54a4ca0f-08ff-434e-9877-c69d0a5afa3f", "type": "bulletListItem", "props": {}, "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 24}, {"id": "131e56ce-a081-4b07-9b89-c31cf4a2609f", "type": "numberedListItem", "props": {}, "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 25}, {"id": "9828f7e4-4777-4220-a83e-a884ca1d1725", "type": "checkListItem", "props": {}, "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 26}, {"id": "7173c1fc-5af5-434c-883c-e145f45e0b29", "type": "paragraph", "props": {}, "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "children": [], "position": 27}, {"id": "2874322c-122f-4e40-8541-49c5b8d3534f", "type": "paragraph", "props": {}, "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "children": [], "position": 28}, {"id": "f6c10943-2b65-446d-8e71-f69e9eefbf62", "type": "paragraph", "props": {}, "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "children": [], "position": 29}, {"id": "4359adc0-a97b-4e90-99d6-85699c0df160", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 30}, {"id": "45257096-2905-4ee0-b3d5-145b1c78d731", "type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "children": [], "position": 31}, {"id": "d1754771-bb07-42be-bf56-da50977976f7", "type": "paragraph", "props": {}, "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "children": [], "position": 32}, {"id": "dad6ee0b-0a47-4e99-96ab-5944bc4aef22", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "children": [], "position": 33}, {"id": "596e1c22-dbaa-442c-909e-dca207ceaa79", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "children": [], "position": 34}, {"id": "2af4408f-3b85-458f-9198-eace1ca99132", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 35}, {"id": "58a3b823-15c8-4b9b-8108-f5d55ada3b86", "type": "paragraph", "props": {}, "content": [{"text": "Here is an example of a nested list:", "type": "text", "styles": {"bold": true}}], "children": [], "position": 36}, {"id": "131084ed-c3f8-44e5-a743-5d026244a0c5", "type": "bulletListItem", "props": {}, "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "position": 37}, {"id": "3edf3b92-2d5a-4621-939a-6632fc23c0ea", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 38}, {"id": "e308ae3c-3d10-41e9-b6cb-339e527037b6", "type": "heading", "props": {"level": 3}, "content": [{"text": "Writing Effective Questions", "type": "text", "styles": {}}], "children": [], "position": 39}, {"id": "36efbc63-a8da-40a9-b5d1-7e2fdc5b8441", "type": "paragraph", "props": {}, "content": [{"text": "For best results:", "type": "text", "styles": {}}], "children": [], "position": 40}, {"id": "40805d79-a44c-4f27-afc0-126a774ee766", "type": "bulletListItem", "props": {}, "content": [{"text": "Be clear and specific in your question text", "type": "text", "styles": {}}], "children": [], "position": 41}, {"id": "06f451c4-6a72-4d30-8c79-f18e402a7957", "type": "bulletListItem", "props": {}, "content": [{"text": "Make sure your correct answer is complete and matches the expected format", "type": "text", "styles": {}}], "children": [], "position": 42}, {"id": "4cb19de0-2b9e-489b-a9ab-d5d3bf520bc9", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 43}, {"id": "eb83227d-95e9-4372-b135-6ab1e9f4c1b1", "type": "heading", "props": {"level": 3}, "content": [{"text": "Preview and Publishing", "type": "text", "styles": {}}], "children": [], "position": 44}, {"id": "179e1769-1f4a-4a5c-8c97-ee9eb3c1d727", "type": "paragraph", "props": {}, "content": [{"text": "When you''re ready to test your quiz:", "type": "text", "styles": {}}], "children": [], "position": 45}, {"id": "38cdb5d4-fdbc-4aae-a39c-23ca76bc2503", "type": "bulletListItem", "props": {}, "content": [{"text": "Preview Button", "type": "text", "styles": {"bold": true}}, {"text": ": Lets you see and answer the question exactly as a learner will see it", "type": "text", "styles": {}}], "children": [], "position": 46}, {"id": "de8ec7b7-a026-408f-9dab-75c13c0e080f", "type": "bulletListItem", "props": {}, "content": [{"text": "Publish Button", "type": "text", "styles": {"bold": true}}, {"text": ": Makes the quiz available to learners. You can always edit and publish again", "type": "text", "styles": {}}], "children": [], "position": 47}, {"id": "aa1e7584-523d-4f0f-a1f4-28adaab50f3e", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 48}, {"id": "7775be82-c7ef-40c6-9c80-f637e51d731e", "type": "paragraph", "props": {}, "content": [{"text": "Delete this template when you are ready to create your own question!", "type": "text", "styles": {}}], "children": [], "position": 49}]', NULL, 'text', 'chat', NULL, NULL, NULL, 1, NULL, 1)
                
2025-05-12 18:21:04,009 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'draft', title = 'New Quiz', scheduled_publish_at = NULL WHERE id = 2
2025-05-12 18:21:04,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:21:04,036 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 2 AND deleted_at IS NULL
        
2025-05-12 18:21:04,039 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 2 ORDER BY position ASC
            
2025-05-12 18:21:14,638 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-12 18:21:14,646 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:21:14,652 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-12 18:21:14,659 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-12 18:21:14,679 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-12 18:21:14,680 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-12 18:21:14,689 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-12 18:21:14,689 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-12 18:21:14,700 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-12 18:21:14,716 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:21:17,714 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 1
2025-05-12 18:21:17,716 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 1 ORDER BY cm.ordering
2025-05-12 18:21:17,720 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 1 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:21:17,725 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 1
        
2025-05-12 18:21:17,725 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:21:17,753 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 1
2025-05-12 18:21:17,757 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 1 ORDER BY cm.ordering
2025-05-12 18:21:17,761 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 1 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:21:17,775 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 1
        
2025-05-12 18:21:19,886 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-12 18:21:19,895 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:21:19,895 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-12 18:21:19,896 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-12 18:21:19,903 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-12 18:21:19,903 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-12 18:21:19,913 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-12 18:21:19,923 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-12 18:21:19,930 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-12 18:21:19,940 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:21:25,888 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:21:25,891 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:21:25,894 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:21:25,900 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-12 18:21:25,902 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:21:25,902 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:21:25,917 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:21:25,921 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:21:25,947 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-12 18:22:01,290 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:22:01,290 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:52:01.286701+00:00'
        RETURNING id
        
2025-05-12 18:22:01,290 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:22:09,314 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-12 18:22:09,320 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-12 18:22:12,412 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-12 18:22:12,420 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:22:12,421 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Learning Material Editor!", "type": "text", "styles": {}}], "id": "32f314c2-77ea-4f7f-af54-5fda0019ea16", "position": 0}, {"type": "paragraph", "content": [{"text": "This is where you will create your learning material. You can either modify this template or remove it entirely to start from scratch.", "type": "text", "styles": {}}], "id": "bc682c40-b0b2-4ca9-a743-32c9c0c3b6a5", "position": 1}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "6bc60118-8a8d-4c1a-90f3-ddd8a91683a7", "position": 2}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Key Features", "type": "text", "styles": {}}], "id": "05260fc0-4a53-470b-bd48-5bef8c448bae", "position": 3}, {"type": "bulletListItem", "content": [{"text": "Add new blocks by clicking the + icon that appears between blocks", "type": "text", "styles": {}}], "id": "f90129ad-4058-4981-8322-2fc69711a631", "position": 4}, {"type": "bulletListItem", "content": [{"text": "Reorder blocks using the side menu (hover near the left edge of any block and drag the button with 6 dots to reorder)", "type": "text", "styles": {}}], "id": "ccfcbdb7-e222-49f0-bdde-1a6f49ed9485", "position": 5}, {"type": "bulletListItem", "content": [{"text": "Format text using the toolbar that appears when you select text", "type": "text", "styles": {}}], "id": "72290eb8-e4c5-40c2-8b92-37c15185773f", "position": 6}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "a2400984-a63f-4bfc-8f07-e2c3ed1d7296", "position": 7}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "id": "385fd424-ed44-48f2-b8b2-017a3f6a7d07", "position": 8}, {"type": "paragraph", "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "id": "9712f638-9034-4494-b8c0-aeac747aba2a", "position": 9}, {"type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "id": "9ac20c9d-c63b-4104-98ad-3d70016af074", "position": 10}, {"type": "bulletListItem", "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "id": "c2363a02-d347-4ce3-80cc-030468a745a9", "position": 11}, {"type": "numberedListItem", "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "id": "af6e676f-d182-4874-b249-100bf9bb1aa1", "position": 12}, {"type": "checkListItem", "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "id": "9e558263-ce9a-4528-b128-9ceb96567978", "position": 13}, {"type": "paragraph", "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "id": "7b670081-9047-4eb0-b32b-32b26e74a9c7", "position": 14}, {"type": "paragraph", "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "id": "4c075dce-dd29-48ca-b383-da54a32ede68", "position": 15}, {"type": "paragraph", "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "id": "1afbf6b2-9a3f-4dd8-9ad0-57cc2880c8a6", "position": 16}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "4190ac4a-cdb9-43b4-bc4e-2c5a4841b9f7", "position": 17}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "id": "26525fbe-19f4-4a34-8abb-d2cb90db0928", "position": 18}, {"type": "paragraph", "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "id": "c2b4a83f-e8e4-4400-a693-f44cc8044a90", "position": 19}, {"type": "bulletListItem", "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "id": "e7128b98-300b-4312-b1c4-599d384b2ba8", "position": 20}, {"type": "bulletListItem", "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "id": "44fa26c3-f735-43e6-a6cf-58803258d7e3", "position": 21}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "8b41c9da-9b74-4b2c-8805-a6f3c1fa3af5", "position": 22}, {"type": "paragraph", "content": [{"text": "Here are examples of nested content:", "type": "text", "styles": {}}], "id": "78e78645-6387-4fcf-afc7-d48361d3cab8", "position": 23}, {"type": "paragraph", "content": [{"text": "Nested Lists Example", "type": "text", "styles": {"bold": true}}], "id": "a6f575b2-a47b-42b2-afb9-e4a76677f645", "position": 24}, {"type": "bulletListItem", "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "id": "e8396a9e-56de-4509-9ec2-4cc7f789abed", "position": 25}, {"type": "bulletListItem", "content": [{"text": "Main topic 2", "type": "text", "styles": {}}], "id": "1f6b28b2-ffe1-483d-8d96-6333b9b1dd3f", "position": 26}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "11192b28-2dc7-42a7-8daf-2c075f195530", "position": 27}, {"type": "paragraph", "content": [{"text": "Nested Numbered Lists", "type": "text", "styles": {"bold": true}}], "id": "3c06d88e-cb0a-4f81-9c32-2263c808f872", "position": 28}, {"type": "numberedListItem", "content": [{"text": "First step", "type": "text", "styles": {}}], "children": [{"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.1 (indented with Tab)", "type": "text", "styles": {}}]}, {"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.2", "type": "text", "styles": {}}]}], "id": "5678806b-1fa1-4da1-a853-50c7053f4d82", "position": 29}, {"type": "numberedListItem", "content": [{"text": "Second step", "type": "text", "styles": {}}], "id": "c7e4ada2-89c5-4c91-81ae-679321fee4c6", "position": 30}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "6bedf17b-3388-4032-a585-5af407e916e3", "position": 31}, {"type": "paragraph", "content": [{"text": "Tips for working with nested content:", "type": "text", "styles": {"bold": true}}], "id": "a0ada26c-9cf2-4721-9b66-af8b03e24312", "position": 32}, {"type": "bulletListItem", "content": [{"text": "To unnest/outdent an item, press Shift+Tab", "type": "text", "styles": {}}], "id": "04aee107-8601-40b4-9f19-45c908be18bd", "position": 33}, {"type": "bulletListItem", "content": [{"text": "You can mix bullet and numbered lists in your nesting hierarchy", "type": "text", "styles": {}}], "id": "c0046819-b936-49fa-87f0-2a7b722c7521", "position": 34}, {"type": "bulletListItem", "content": [{"text": "Nesting helps create a clear organizational structure for complex topics", "type": "text", "styles": {}}], "id": "6d22a46c-466b-442e-9fc0-d03d61ecf6d8", "position": 35}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "581f99f8-4f1d-4b68-bc9a-fd8611f22501", "position": 36}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Publishing Your Content", "type": "text", "styles": {}}], "id": "16a7c28f-9c3e-4f1e-9b1e-3a3e763ef56d", "position": 37}, {"type": "paragraph", "content": [{"text": "When you are ready to make your content available to learners, click the Publish button. You can always edit and republish your content later.", "type": "text", "styles": {}}], "id": "d8e4d5b5-2760-43a6-a735-d7277edd22d2", "position": 38}, {"type": "paragraph", "content": [{"text": "Feel free to delete or modify this template to create your own learning material!", "type": "text", "styles": {}}], "id": "47fd06ba-8668-449c-87bc-c701ef1246d3", "position": 39}]', status = 'published', title = 'New Learning Material', scheduled_publish_at = NULL WHERE id = 1
2025-05-12 18:22:12,422 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:22:12,442 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-12 18:22:12,445 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-12 18:22:18,616 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-12 18:22:18,624 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-12 18:22:34,845 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:22:34,845 - api.utils.logging - INFO - Executing operation: 
        INSERT INTO cohorts (name, org_id)
        VALUES ('team 1', 1)
        
2025-05-12 18:22:34,846 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:22:34,863 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:22:34,863 - api.utils.logging - INFO - Executing operation: INSERT INTO course_cohorts (course_id, cohort_id) VALUES (2, 1)
2025-05-12 18:22:34,864 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:22:34,881 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-12 18:22:39,176 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:22:39,198 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:22:39,202 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:22:39,213 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:22:39,223 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:22:39,232 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:22:39,835 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:22:39,846 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:22:42,992 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-12 18:22:42,998 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-12 18:22:43,324 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-12 18:22:43,327 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-12 18:22:43,337 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-12 18:22:43,344 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-12 18:23:01,290 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:23:01,290 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:53:01.285778+00:00'
        RETURNING id
        
2025-05-12 18:23:01,291 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:24:01,287 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:24:01,288 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:54:01.284137+00:00'
        RETURNING id
        
2025-05-12 18:24:01,288 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:25:01,298 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:25:01,298 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:55:01.293371+00:00'
        RETURNING id
        
2025-05-12 18:25:01,298 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:26:01,296 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:26:01,296 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:56:01.292248+00:00'
        RETURNING id
        
2025-05-12 18:26:01,296 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:27:01,297 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:27:01,298 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:57:01.294109+00:00'
        RETURNING id
        
2025-05-12 18:27:01,298 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:28:01,290 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:28:01,290 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:58:01.286119+00:00'
        RETURNING id
        
2025-05-12 18:28:01,291 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:28:27,705 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:28:27,721 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:28:27,762 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:28:27,771 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:28:27,790 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:28:27,804 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-12 18:28:27,815 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-12 18:28:27,826 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-12 18:28:27,833 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-12 18:28:27,840 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-12 18:28:27,853 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-12 18:29:01,288 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:29:01,288 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 12:59:01.284304+00:00'
        RETURNING id
        
2025-05-12 18:29:01,288 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:30:01,293 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:30:01,293 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:00:01.289396+00:00'
        RETURNING id
        
2025-05-12 18:30:01,294 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:31:01,300 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:31:01,300 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:01:01.297041+00:00'
        RETURNING id
        
2025-05-12 18:31:01,300 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:32:01,309 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:32:01,309 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:02:01.305254+00:00'
        RETURNING id
        
2025-05-12 18:32:01,310 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:33:01,290 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:33:01,291 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:03:01.286928+00:00'
        RETURNING id
        
2025-05-12 18:33:01,291 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:34:01,295 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:34:01,295 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:04:01.291893+00:00'
        RETURNING id
        
2025-05-12 18:34:01,296 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:35:01,301 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:35:01,301 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:05:01.297907+00:00'
        RETURNING id
        
2025-05-12 18:35:01,302 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:36:01,294 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:36:01,295 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:06:01.291086+00:00'
        RETURNING id
        
2025-05-12 18:36:01,295 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:37:01,298 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:37:01,298 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:07:01.294603+00:00'
        RETURNING id
        
2025-05-12 18:37:01,298 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:38:01,299 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:38:01,299 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:08:01.295628+00:00'
        RETURNING id
        
2025-05-12 18:38:01,300 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:39:01,292 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:39:01,292 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:09:01.288738+00:00'
        RETURNING id
        
2025-05-12 18:39:01,293 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-12 18:40:01,290 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-12 18:40:01,290 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-12 13:10:01.286995+00:00'
        RETURNING id
        
2025-05-12 18:40:01,291 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:09:21,710 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='organizations'
2025-05-15 11:09:21,710 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='org_api_keys'
2025-05-15 11:09:21,710 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='users'
2025-05-15 11:09:21,711 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='user_organizations'
2025-05-15 11:09:21,711 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='cohorts'
2025-05-15 11:09:21,711 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='courses'
2025-05-15 11:09:21,711 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='course_cohorts'
2025-05-15 11:09:21,712 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='milestones'
2025-05-15 11:09:21,712 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='tags'
2025-05-15 11:09:21,712 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='badges'
2025-05-15 11:09:21,712 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='tasks'
2025-05-15 11:09:21,712 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='questions'
2025-05-15 11:09:21,713 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='scorecards'
2025-05-15 11:09:21,713 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='question_scorecards'
2025-05-15 11:09:21,713 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='task_scoring_criteria'
2025-05-15 11:09:21,713 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='tests'
2025-05-15 11:09:21,714 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='chat_history'
2025-05-15 11:09:21,714 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='task_completions'
2025-05-15 11:09:21,714 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='course_tasks'
2025-05-15 11:09:21,715 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='course_milestones'
2025-05-15 11:09:21,715 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='cv_review_usage'
2025-05-15 11:09:21,716 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='course_generation_jobs'
2025-05-15 11:09:21,716 - api.utils.logging - INFO - Executing operation: SELECT name FROM sqlite_master WHERE type='table' AND name='task_generation_jobs'
2025-05-15 11:10:50,067 - api.utils.logging - INFO - Logging system initialized
2025-05-15 11:10:51,126 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-15 11:10:51,141 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-15 11:11:17,333 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:11:17,340 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:11:17,346 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 11:11:17,351 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:11:17,354 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:11:17,355 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 11:11:17,356 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 11:11:33,417 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:11:33,425 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:11:33,481 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 1
2025-05-15 11:11:33,495 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 1 ORDER BY cm.ordering
2025-05-15 11:11:33,511 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 1 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 11:11:33,526 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 1
        
2025-05-15 11:11:33,538 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:11:33,549 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 1
2025-05-15 11:11:33,557 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 1 ORDER BY cm.ordering
2025-05-15 11:11:33,565 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 1 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 11:11:33,574 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 1
        
2025-05-15 11:11:38,128 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 1
2025-05-15 11:11:38,134 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:11:38,135 - api.utils.logging - INFO - Executing operation: INSERT INTO milestones (name, color, org_id) VALUES ('New Module', '#4a5568', 1)
2025-05-15 11:11:38,135 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_milestones WHERE course_id = 1
2025-05-15 11:11:38,136 - api.utils.logging - INFO - Executing operation: INSERT INTO course_milestones (course_id, milestone_id, ordering) VALUES (1, 2, 0)
2025-05-15 11:11:38,137 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:11:40,638 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 1
2025-05-15 11:11:40,643 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:11:40,643 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'learning_material', 'New Learning Material', 'draft')
2025-05-15 11:11:40,643 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 1 AND milestone_id = 2
2025-05-15 11:11:40,644 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (1, 3, 2, 0)
2025-05-15 11:11:40,645 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:11:40,661 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 1 AND ct.milestone_id = 2 AND ct.ordering < 0 AND t.deleted_at IS NULL
            
2025-05-15 11:11:45,265 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 3 AND deleted_at IS NULL
        
2025-05-15 11:11:45,271 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 3
2025-05-15 11:11:48,986 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 3 AND deleted_at IS NULL
        
2025-05-15 11:11:48,992 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:11:48,992 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Learning Material Editor!", "type": "text", "styles": {}}], "id": "b8b83b7c-4455-4015-b37f-01fa9db8bafb", "position": 0}, {"type": "paragraph", "content": [{"text": "This is where you will create your learning material. You can either modify this template or remove it entirely to start from scratch.", "type": "text", "styles": {}}], "id": "f1fc2005-ba1e-494a-8759-22cde951793e", "position": 1}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "5f300818-c27b-4cf6-bdda-d5c5bdc5fab7", "position": 2}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Key Features", "type": "text", "styles": {}}], "id": "9dfc07e2-2d48-4f81-bdd4-8602ab2007a3", "position": 3}, {"type": "bulletListItem", "content": [{"text": "Add new blocks by clicking the + icon that appears between blocks", "type": "text", "styles": {}}], "id": "d9755f22-3603-4547-9d17-3778489ea32b", "position": 4}, {"type": "bulletListItem", "content": [{"text": "Reorder blocks using the side menu (hover near the left edge of any block and drag the button with 6 dots to reorder)", "type": "text", "styles": {}}], "id": "08fcfc0e-1210-4a8b-a7cc-8d352afa79db", "position": 5}, {"type": "bulletListItem", "content": [{"text": "Format text using the toolbar that appears when you select text", "type": "text", "styles": {}}], "id": "709f1c00-358e-44c5-bcc9-77d1e584923b", "position": 6}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "f6311bbf-95f6-4b25-99cb-ac1dc80c09cf", "position": 7}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "id": "5ac8de3c-85ac-4b41-badf-c6305c3b76c7", "position": 8}, {"type": "paragraph", "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "id": "a996f6e1-1e26-4046-a65d-d557d87a72e5", "position": 9}, {"type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "id": "af4d4912-4e13-42d0-b638-6ceeefbf4bd6", "position": 10}, {"type": "bulletListItem", "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "id": "e124a3c5-9582-4d10-92eb-0153ba92f3db", "position": 11}, {"type": "numberedListItem", "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "id": "968f11e0-d53b-4972-b47d-b5744c936111", "position": 12}, {"type": "checkListItem", "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "id": "8d9d9f04-268e-455f-bc3c-83d96436073f", "position": 13}, {"type": "paragraph", "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "id": "a0758852-2a25-4fa1-ae40-31a5ad57efcd", "position": 14}, {"type": "paragraph", "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "id": "3d539094-5b7e-4683-acf3-a8609d79fe7d", "position": 15}, {"type": "paragraph", "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "id": "c3be87ae-3801-4b17-8dff-97edaab55015", "position": 16}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "8d63f219-3e91-47b6-9cee-ff05b463e9b5", "position": 17}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "id": "dec4d343-5404-48c3-aa13-36fcca646356", "position": 18}, {"type": "paragraph", "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "id": "2dcf62b9-966e-472e-afb9-a9021a9ae0a7", "position": 19}, {"type": "bulletListItem", "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "id": "ae1a6e1a-36dc-4bd1-9f22-a29e00f695d1", "position": 20}, {"type": "bulletListItem", "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "id": "21004c33-ba6c-4597-8fdc-ca111d4fcfa6", "position": 21}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "84f8157a-1d6f-47c2-a3dd-03908137eea0", "position": 22}, {"type": "paragraph", "content": [{"text": "Here are examples of nested content:", "type": "text", "styles": {}}], "id": "e7f2a29b-db54-4563-ae3d-d35a732531a9", "position": 23}, {"type": "paragraph", "content": [{"text": "Nested Lists Example", "type": "text", "styles": {"bold": true}}], "id": "ffcd5d44-26fc-40d9-a490-c2f5566f20e9", "position": 24}, {"type": "bulletListItem", "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "id": "022a7838-de64-4444-adf8-c60c49f41d1b", "position": 25}, {"type": "bulletListItem", "content": [{"text": "Main topic 2", "type": "text", "styles": {}}], "id": "4ff2f2ed-7e61-49a3-b1cb-615f1887c5ec", "position": 26}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "422caf9b-74ec-4355-9118-98847a1e9536", "position": 27}, {"type": "paragraph", "content": [{"text": "Nested Numbered Lists", "type": "text", "styles": {"bold": true}}], "id": "ce23d5ad-921a-4792-945a-d5e7e830e39d", "position": 28}, {"type": "numberedListItem", "content": [{"text": "First step", "type": "text", "styles": {}}], "children": [{"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.1 (indented with Tab)", "type": "text", "styles": {}}]}, {"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.2", "type": "text", "styles": {}}]}], "id": "00fc01d3-52f5-4d7e-9bcf-24b5857252df", "position": 29}, {"type": "numberedListItem", "content": [{"text": "Second step", "type": "text", "styles": {}}], "id": "07842ddb-eb0d-4be8-8269-198f634b7bc3", "position": 30}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "3d59eba4-86b4-48ef-b36f-ab160ea025b0", "position": 31}, {"type": "paragraph", "content": [{"text": "Tips for working with nested content:", "type": "text", "styles": {"bold": true}}], "id": "2301bdb0-6805-481a-9f63-e6ebbe071939", "position": 32}, {"type": "bulletListItem", "content": [{"text": "To unnest/outdent an item, press Shift+Tab", "type": "text", "styles": {}}], "id": "736321f5-104d-48a6-bce1-1ff2e7aad56d", "position": 33}, {"type": "bulletListItem", "content": [{"text": "You can mix bullet and numbered lists in your nesting hierarchy", "type": "text", "styles": {}}], "id": "b50f5d15-af9e-4df7-9ab5-5a98ddcfaeb7", "position": 34}, {"type": "bulletListItem", "content": [{"text": "Nesting helps create a clear organizational structure for complex topics", "type": "text", "styles": {}}], "id": "dad1fb1a-295a-4f88-884a-6e76f31a51ac", "position": 35}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "fbf79598-5f4c-432d-866e-ed7e6c72b5df", "position": 36}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Publishing Your Content", "type": "text", "styles": {}}], "id": "9d0d0b65-1136-4fa4-81b0-7bb7cf9597a1", "position": 37}, {"type": "paragraph", "content": [{"text": "When you are ready to make your content available to learners, click the Publish button. You can always edit and republish your content later.", "type": "text", "styles": {}}], "id": "b2f3fe3f-f21f-4bff-8d9b-1a33da7bce5e", "position": 38}, {"type": "paragraph", "content": [{"text": "Feel free to delete or modify this template to create your own learning material!", "type": "text", "styles": {}}], "id": "38baf67a-8caf-40c6-9b5c-acc10907a9cb", "position": 39}]', status = 'draft', title = 'New Learning Material', scheduled_publish_at = NULL WHERE id = 3
2025-05-15 11:11:48,993 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:11:49,018 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 3 AND deleted_at IS NULL
        
2025-05-15 11:11:49,020 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 3
2025-05-15 11:11:50,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:11:50,259 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 05:41:50.252920+00:00'
        RETURNING id
        
2025-05-15 11:11:50,261 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:11:53,693 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 3 AND deleted_at IS NULL
        
2025-05-15 11:11:53,698 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 3
2025-05-15 11:11:53,706 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 3 AND deleted_at IS NULL
        
2025-05-15 11:11:53,712 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 3
2025-05-15 11:11:57,380 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 3 AND deleted_at IS NULL
        
2025-05-15 11:11:57,385 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:11:57,386 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "b8b83b7c-4455-4015-b37f-01fa9db8bafb", "type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Learning Material Editor!", "type": "text", "styles": {}}], "children": [], "position": 0}, {"id": "f1fc2005-ba1e-494a-8759-22cde951793e", "type": "paragraph", "props": {}, "content": [{"text": "This is where you will create your learning material. You can either modify this template or remove it entirely to start from scratch.", "type": "text", "styles": {}}], "children": [], "position": 1}, {"id": "5f300818-c27b-4cf6-bdda-d5c5bdc5fab7", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 2}, {"id": "9dfc07e2-2d48-4f81-bdd4-8602ab2007a3", "type": "heading", "props": {"level": 3}, "content": [{"text": "Key Features", "type": "text", "styles": {}}], "children": [], "position": 3}, {"id": "d9755f22-3603-4547-9d17-3778489ea32b", "type": "bulletListItem", "props": {}, "content": [{"text": "Add new blocks by clicking the + icon that appears between blocks", "type": "text", "styles": {}}], "children": [], "position": 4}, {"id": "08fcfc0e-1210-4a8b-a7cc-8d352afa79db", "type": "bulletListItem", "props": {}, "content": [{"text": "Reorder blocks using the side menu (hover near the left edge of any block and drag the button with 6 dots to reorder)", "type": "text", "styles": {}}], "children": [], "position": 5}, {"id": "709f1c00-358e-44c5-bcc9-77d1e584923b", "type": "bulletListItem", "props": {}, "content": [{"text": "Format text using the toolbar that appears when you select text", "type": "text", "styles": {}}], "children": [], "position": 6}, {"id": "f6311bbf-95f6-4b25-99cb-ac1dc80c09cf", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 7}, {"id": "5ac8de3c-85ac-4b41-badf-c6305c3b76c7", "type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "children": [], "position": 8}, {"id": "a996f6e1-1e26-4046-a65d-d557d87a72e5", "type": "paragraph", "props": {}, "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "children": [], "position": 9}, {"id": "af4d4912-4e13-42d0-b638-6ceeefbf4bd6", "type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "children": [], "position": 10}, {"id": "e124a3c5-9582-4d10-92eb-0153ba92f3db", "type": "bulletListItem", "props": {}, "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 11}, {"id": "968f11e0-d53b-4972-b47d-b5744c936111", "type": "numberedListItem", "props": {}, "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 12}, {"id": "8d9d9f04-268e-455f-bc3c-83d96436073f", "type": "checkListItem", "props": {}, "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 13}, {"id": "a0758852-2a25-4fa1-ae40-31a5ad57efcd", "type": "paragraph", "props": {}, "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "children": [], "position": 14}, {"id": "3d539094-5b7e-4683-acf3-a8609d79fe7d", "type": "paragraph", "props": {}, "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "children": [], "position": 15}, {"id": "c3be87ae-3801-4b17-8dff-97edaab55015", "type": "paragraph", "props": {}, "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "children": [], "position": 16}, {"id": "8d63f219-3e91-47b6-9cee-ff05b463e9b5", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 17}, {"id": "dec4d343-5404-48c3-aa13-36fcca646356", "type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "children": [], "position": 18}, {"id": "2dcf62b9-966e-472e-afb9-a9021a9ae0a7", "type": "paragraph", "props": {}, "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "children": [], "position": 19}, {"id": "ae1a6e1a-36dc-4bd1-9f22-a29e00f695d1", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "children": [], "position": 20}, {"id": "21004c33-ba6c-4597-8fdc-ca111d4fcfa6", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "children": [], "position": 21}, {"id": "84f8157a-1d6f-47c2-a3dd-03908137eea0", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 22}, {"id": "e7f2a29b-db54-4563-ae3d-d35a732531a9", "type": "paragraph", "props": {}, "content": [{"text": "Here are examples of nested content:", "type": "text", "styles": {}}], "children": [], "position": 23}, {"id": "ffcd5d44-26fc-40d9-a490-c2f5566f20e9", "type": "paragraph", "props": {}, "content": [{"text": "Nested Lists Example", "type": "text", "styles": {"bold": true}}], "children": [], "position": 24}, {"id": "022a7838-de64-4444-adf8-c60c49f41d1b", "type": "bulletListItem", "props": {}, "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "position": 25}, {"id": "4ff2f2ed-7e61-49a3-b1cb-615f1887c5ec", "type": "bulletListItem", "props": {}, "content": [{"text": "Main topic 2", "type": "text", "styles": {}}], "children": [], "position": 26}, {"id": "422caf9b-74ec-4355-9118-98847a1e9536", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 27}, {"id": "ce23d5ad-921a-4792-945a-d5e7e830e39d", "type": "paragraph", "props": {}, "content": [{"text": "Nested Numbered Lists", "type": "text", "styles": {"bold": true}}], "children": [], "position": 28}, {"id": "00fc01d3-52f5-4d7e-9bcf-24b5857252df", "type": "numberedListItem", "props": {}, "content": [{"text": "First step", "type": "text", "styles": {}}], "children": [{"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.1 (indented with Tab)", "type": "text", "styles": {}}]}, {"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.2", "type": "text", "styles": {}}]}], "position": 29}, {"id": "07842ddb-eb0d-4be8-8269-198f634b7bc3", "type": "numberedListItem", "props": {}, "content": [{"text": "Second step", "type": "text", "styles": {}}], "children": [], "position": 30}, {"id": "3d59eba4-86b4-48ef-b36f-ab160ea025b0", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 31}, {"id": "2301bdb0-6805-481a-9f63-e6ebbe071939", "type": "paragraph", "props": {}, "content": [{"text": "Tips for working with nested content:", "type": "text", "styles": {"bold": true}}], "children": [], "position": 32}, {"id": "736321f5-104d-48a6-bce1-1ff2e7aad56d", "type": "bulletListItem", "props": {}, "content": [{"text": "To unnest/outdent an item, press Shift+Tab", "type": "text", "styles": {}}], "children": [], "position": 33}, {"id": "b50f5d15-af9e-4df7-9ab5-5a98ddcfaeb7", "type": "bulletListItem", "props": {}, "content": [{"text": "You can mix bullet and numbered lists in your nesting hierarchy", "type": "text", "styles": {}}], "children": [], "position": 34}, {"id": "dad1fb1a-295a-4f88-884a-6e76f31a51ac", "type": "bulletListItem", "props": {}, "content": [{"text": "Nesting helps create a clear organizational structure for complex topics", "type": "text", "styles": {}}], "children": [], "position": 35}, {"id": "fbf79598-5f4c-432d-866e-ed7e6c72b5df", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 36}, {"id": "9d0d0b65-1136-4fa4-81b0-7bb7cf9597a1", "type": "heading", "props": {"level": 3}, "content": [{"text": "Publishing Your Content", "type": "text", "styles": {}}], "children": [], "position": 37}, {"id": "b2f3fe3f-f21f-4bff-8d9b-1a33da7bce5e", "type": "paragraph", "props": {}, "content": [{"text": "When you are ready to make your content available to learners, click the Publish button. You can always edit and republish your content later.", "type": "text", "styles": {}}], "children": [], "position": 38}, {"id": "38baf67a-8caf-40c6-9b5c-acc10907a9cb", "type": "paragraph", "props": {}, "content": [{"text": "Feel free to delete or modify this template to create your own learning material!", "type": "text", "styles": {}}], "children": [], "position": 39}]', status = 'published', title = 'New Learning Material', scheduled_publish_at = NULL WHERE id = 3
2025-05-15 11:11:57,386 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:11:57,401 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 3 AND deleted_at IS NULL
        
2025-05-15 11:11:57,404 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 3
2025-05-15 11:12:06,023 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:12:06,030 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:12:06,046 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:12:06,046 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:12:06,056 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:12:06,056 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:12:06,068 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:12:06,080 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:12:06,092 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:12:06,108 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:20:50,949 - api.utils.logging - INFO - Logging system initialized
2025-05-15 11:20:51,480 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-15 11:20:51,481 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-15 11:20:54,867 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:20:54,875 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:20:54,898 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:20:56,981 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:20:56,994 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:20:57,000 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:20:57,008 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:20:57,008 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:20:57,015 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:20:57,022 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:20:57,030 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:20:57,041 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:20:57,066 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:21:10,910 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:21:10,915 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:21:10,915 - api.utils.logging - INFO - Executing operation: 
        INSERT INTO courses (name, org_id)
        VALUES ('CSS', 1)
        
2025-05-15 11:21:10,917 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:21:23,141 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:21:23,150 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 11:21:23,159 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 11:21:23,167 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 11:21:23,174 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 11:21:23,181 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 11:21:23,193 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 11:21:23,201 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 11:21:23,210 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 11:21:25,445 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-15 11:21:25,451 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:21:25,451 - api.utils.logging - INFO - Executing operation: INSERT INTO milestones (name, color, org_id) VALUES ('New Module', '#312e51', 1)
2025-05-15 11:21:25,452 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_milestones WHERE course_id = 3
2025-05-15 11:21:25,452 - api.utils.logging - INFO - Executing operation: INSERT INTO course_milestones (course_id, milestone_id, ordering) VALUES (3, 3, 0)
2025-05-15 11:21:25,453 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:21:27,046 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-15 11:21:27,051 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:21:27,051 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'learning_material', 'New Learning Material', 'draft')
2025-05-15 11:21:27,052 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-15 11:21:27,052 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 4, 3, 0)
2025-05-15 11:21:27,053 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:21:27,069 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 0 AND t.deleted_at IS NULL
            
2025-05-15 11:21:28,969 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 11:21:28,975 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 11:21:28,995 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 11:21:29,000 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 11:21:33,321 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 11:21:33,328 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:21:33,328 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Learning Material Editor!", "type": "text", "styles": {}}], "id": "df3c55ba-ad2a-4cc7-a9b3-b07ac4f369a6", "position": 0}, {"type": "paragraph", "content": [{"text": "This is where you will create your learning material. You can either modify this template or remove it entirely to start from scratch.", "type": "text", "styles": {}}], "id": "6575548f-368c-4c41-80c2-220bb8b810c6", "position": 1}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "d4a862aa-ba0e-4e9a-a268-b0f134901907", "position": 2}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Key Features", "type": "text", "styles": {}}], "id": "6f32b51a-ff07-4f2d-ac4d-7def0657ddf0", "position": 3}, {"type": "bulletListItem", "content": [{"text": "Add new blocks by clicking the + icon that appears between blocks", "type": "text", "styles": {}}], "id": "ee768287-66ed-4283-9e02-348b358b022f", "position": 4}, {"type": "bulletListItem", "content": [{"text": "Reorder blocks using the side menu (hover near the left edge of any block and drag the button with 6 dots to reorder)", "type": "text", "styles": {}}], "id": "8eda9354-3ae4-4711-905a-a6d4cd9c4e15", "position": 5}, {"type": "bulletListItem", "content": [{"text": "Format text using the toolbar that appears when you select text", "type": "text", "styles": {}}], "id": "e2e4ea6e-46b1-47d4-a162-76d34f1086be", "position": 6}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "2793a9b8-4a52-46c7-bdaa-b849b89501f5", "position": 7}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "id": "98b78aa1-a1dd-4106-8060-091d21334608", "position": 8}, {"type": "paragraph", "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "id": "3ee47d94-e19c-4930-ac2e-1c414909bbdb", "position": 9}, {"type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "id": "6d2e0087-3fe1-4f96-abb4-e2ec0b688880", "position": 10}, {"type": "bulletListItem", "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "id": "470a7411-1478-49f5-9f24-e2fccd7d25a5", "position": 11}, {"type": "numberedListItem", "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "id": "fd0d8ae6-4687-43cf-80b5-a136e3bca9fc", "position": 12}, {"type": "checkListItem", "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "id": "c630f2bc-f04e-4dce-8b2a-c06c32372606", "position": 13}, {"type": "paragraph", "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "id": "a6c1a121-a6e9-4617-bc1d-de7797dc064f", "position": 14}, {"type": "paragraph", "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "id": "83ba2c4c-b0df-4056-ab99-97b47e2d0b41", "position": 15}, {"type": "paragraph", "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "id": "fde5a92a-35ce-4712-a104-e98c0c7946d1", "position": 16}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "f8d49a61-e202-4078-9b5a-1d05eda1090f", "position": 17}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "id": "53a9a923-e772-4326-8065-3da4f92cb2bd", "position": 18}, {"type": "paragraph", "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "id": "dca030ea-b791-4dce-a094-8568aab91e33", "position": 19}, {"type": "bulletListItem", "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "id": "6e250c94-468c-426b-8c3a-bac0a98e794d", "position": 20}, {"type": "bulletListItem", "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "id": "be1cf161-ce57-402d-b9a1-d5f5e0aaf9f3", "position": 21}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "56eb0917-e8ff-45cb-b289-19611682f09a", "position": 22}, {"type": "paragraph", "content": [{"text": "Here are examples of nested content:", "type": "text", "styles": {}}], "id": "e1c6778e-4768-4661-af0c-80c4f12b6286", "position": 23}, {"type": "paragraph", "content": [{"text": "Nested Lists Example", "type": "text", "styles": {"bold": true}}], "id": "38a5f0b9-f50a-4188-8c3a-fbfec61fb1ab", "position": 24}, {"type": "bulletListItem", "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "id": "70d94207-e3d0-40da-b14e-6f13913b0044", "position": 25}, {"type": "bulletListItem", "content": [{"text": "Main topic 2", "type": "text", "styles": {}}], "id": "2e3a0cb5-d757-42ac-8ed4-d7db015ce05d", "position": 26}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "1cfd87f9-3091-40c9-82f9-f4b0ea15d657", "position": 27}, {"type": "paragraph", "content": [{"text": "Nested Numbered Lists", "type": "text", "styles": {"bold": true}}], "id": "42d28b52-c74d-45d0-9967-2c625b342951", "position": 28}, {"type": "numberedListItem", "content": [{"text": "First step", "type": "text", "styles": {}}], "children": [{"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.1 (indented with Tab)", "type": "text", "styles": {}}]}, {"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.2", "type": "text", "styles": {}}]}], "id": "fd5f92da-9e47-406a-ba25-57bb0058e05a", "position": 29}, {"type": "numberedListItem", "content": [{"text": "Second step", "type": "text", "styles": {}}], "id": "0b163967-b5fa-476e-94d2-0a62f320bebd", "position": 30}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "89101837-fe43-4b75-8a81-bff338aaa7c3", "position": 31}, {"type": "paragraph", "content": [{"text": "Tips for working with nested content:", "type": "text", "styles": {"bold": true}}], "id": "e3fd4618-0266-4558-ab59-5243c0ed246b", "position": 32}, {"type": "bulletListItem", "content": [{"text": "To unnest/outdent an item, press Shift+Tab", "type": "text", "styles": {}}], "id": "4b99a822-8431-4aeb-af6e-eb3e8c7c4ee3", "position": 33}, {"type": "bulletListItem", "content": [{"text": "You can mix bullet and numbered lists in your nesting hierarchy", "type": "text", "styles": {}}], "id": "48d05b41-c7f0-4c6a-ba4e-2be72be71baa", "position": 34}, {"type": "bulletListItem", "content": [{"text": "Nesting helps create a clear organizational structure for complex topics", "type": "text", "styles": {}}], "id": "5e37e62e-939b-48ca-bfa7-6f552abf673a", "position": 35}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "6ea590f1-c3d3-47ec-be9d-12d86285b368", "position": 36}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Publishing Your Content", "type": "text", "styles": {}}], "id": "ce716174-829d-4aec-a0ad-d5486eaa9da5", "position": 37}, {"type": "paragraph", "content": [{"text": "When you are ready to make your content available to learners, click the Publish button. You can always edit and republish your content later.", "type": "text", "styles": {}}], "id": "1ff396f9-120d-4a47-acdc-f64b95c2795d", "position": 38}, {"type": "paragraph", "content": [{"text": "Feel free to delete or modify this template to create your own learning material!", "type": "text", "styles": {}}], "id": "09ec3e4c-2975-496d-8eb5-3c668eb38a80", "position": 39}]', status = 'published', title = 'New Learning Material', scheduled_publish_at = NULL WHERE id = 4
2025-05-15 11:21:33,330 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:21:33,354 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 11:21:33,358 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 11:21:43,340 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:21:43,351 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:21:43,358 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:21:43,364 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:21:43,374 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:21:43,380 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:21:43,382 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:21:43,388 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:21:43,409 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:21:43,411 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:21:51,124 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:21:51,124 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 05:51:51.118375+00:00'
        RETURNING id
        
2025-05-15 11:21:51,125 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:22:51,129 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:22:51,129 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 05:52:51.126132+00:00'
        RETURNING id
        
2025-05-15 11:22:51,130 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:25:46,329 - api.utils.logging - INFO - Logging system initialized
2025-05-15 11:25:46,983 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-15 11:25:46,995 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-15 11:25:47,120 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:25:47,128 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:25:47,148 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:25:47,369 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:25:47,379 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:25:47,391 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:25:47,392 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:25:47,401 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:25:47,403 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:25:47,411 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:25:47,432 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:25:47,455 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:25:47,455 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:26:46,502 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:26:46,502 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 05:56:46.498884+00:00'
        RETURNING id
        
2025-05-15 11:26:46,504 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:27:46,516 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:27:46,516 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 05:57:46.510742+00:00'
        RETURNING id
        
2025-05-15 11:27:46,517 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:28:46,502 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:28:46,502 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 05:58:46.497094+00:00'
        RETURNING id
        
2025-05-15 11:28:46,503 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:29:46,503 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:29:46,503 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 05:59:46.499222+00:00'
        RETURNING id
        
2025-05-15 11:29:46,504 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:30:30,911 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:30:30,922 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:30:30,952 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:30:30,963 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:30:30,975 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:30:30,988 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:30:31,004 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:30:31,020 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:30:31,035 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:30:31,049 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:30:31,061 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:30:31,093 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:30:46,509 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:30:46,509 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:00:46.505825+00:00'
        RETURNING id
        
2025-05-15 11:30:46,509 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:31:46,504 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:31:46,504 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:01:46.500519+00:00'
        RETURNING id
        
2025-05-15 11:31:46,504 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:31:56,220 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:31:56,227 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:31:56,253 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:31:56,265 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:31:56,275 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:31:56,286 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:31:56,298 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:31:56,311 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:31:56,322 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:31:56,333 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:31:56,344 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:31:56,375 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:32:46,512 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:32:46,512 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:02:46.508811+00:00'
        RETURNING id
        
2025-05-15 11:32:46,513 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:33:46,505 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:33:46,505 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:03:46.501180+00:00'
        RETURNING id
        
2025-05-15 11:33:46,506 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:34:46,505 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:34:46,505 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:04:46.501767+00:00'
        RETURNING id
        
2025-05-15 11:34:46,506 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:35:43,172 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:35:43,179 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:35:43,207 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:35:43,221 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:35:43,233 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:35:43,244 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:35:43,259 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:35:43,271 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:35:43,283 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:35:43,298 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:35:43,310 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:35:43,335 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:35:46,518 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:35:46,518 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:05:46.514722+00:00'
        RETURNING id
        
2025-05-15 11:35:46,519 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:36:16,554 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:36:16,562 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:36:16,590 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:36:16,607 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:36:16,616 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:36:16,629 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:36:16,641 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:36:16,652 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:36:16,663 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:36:16,673 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:36:16,685 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:36:16,712 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:36:40,659 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:36:40,668 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:36:40,717 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:36:40,744 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:36:40,755 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:36:40,755 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:36:40,806 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:36:40,806 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:36:40,825 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:36:40,826 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:36:40,876 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:36:40,876 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:36:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:36:46,514 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:06:46.503369+00:00'
        RETURNING id
        
2025-05-15 11:36:46,515 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:37:14,796 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:37:14,805 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:37:14,829 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:37:14,841 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:37:14,851 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:37:14,864 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:37:14,875 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:37:14,887 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:37:14,899 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:37:14,911 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:37:14,922 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:37:14,949 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:37:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:37:46,514 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:07:46.510876+00:00'
        RETURNING id
        
2025-05-15 11:37:46,514 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:38:46,512 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:38:46,512 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:08:46.508529+00:00'
        RETURNING id
        
2025-05-15 11:38:46,513 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:39:46,504 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:39:46,504 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:09:46.500939+00:00'
        RETURNING id
        
2025-05-15 11:39:46,505 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:39:53,790 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:39:53,798 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:39:53,825 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:39:53,838 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:39:53,850 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:39:53,861 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:39:53,874 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:39:53,887 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:39:53,898 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:39:53,910 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:39:53,922 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:39:53,944 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:40:46,512 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:40:46,512 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:10:46.508992+00:00'
        RETURNING id
        
2025-05-15 11:40:46,513 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:41:46,505 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:41:46,505 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:11:46.502281+00:00'
        RETURNING id
        
2025-05-15 11:41:46,506 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:42:04,070 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:42:04,079 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:42:04,116 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:42:04,130 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:42:04,142 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:42:04,153 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:42:04,168 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:42:04,179 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:42:04,191 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:42:04,205 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:42:04,217 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:42:04,247 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:42:46,512 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:42:46,512 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:12:46.508350+00:00'
        RETURNING id
        
2025-05-15 11:42:46,512 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:43:46,513 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:43:46,513 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:13:46.509825+00:00'
        RETURNING id
        
2025-05-15 11:43:46,514 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:44:46,505 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:44:46,505 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:14:46.501590+00:00'
        RETURNING id
        
2025-05-15 11:44:46,505 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:45:46,505 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:45:46,505 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:15:46.502023+00:00'
        RETURNING id
        
2025-05-15 11:45:46,506 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:46:46,507 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:46:46,507 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:16:46.503234+00:00'
        RETURNING id
        
2025-05-15 11:46:46,507 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:47:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:47:46,514 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:17:46.510280+00:00'
        RETURNING id
        
2025-05-15 11:47:46,514 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:48:46,513 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:48:46,513 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:18:46.509392+00:00'
        RETURNING id
        
2025-05-15 11:48:46,513 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:49:33,564 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:49:33,579 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:49:33,632 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:49:33,649 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:49:33,662 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:49:33,683 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:49:33,721 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:49:33,733 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:49:33,745 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:49:33,760 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:49:33,772 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:49:33,809 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:49:46,506 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:49:46,506 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:19:46.502841+00:00'
        RETURNING id
        
2025-05-15 11:49:46,508 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:50:46,503 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:50:46,503 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:20:46.500104+00:00'
        RETURNING id
        
2025-05-15 11:50:46,504 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:51:46,516 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:51:46,516 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:21:46.511680+00:00'
        RETURNING id
        
2025-05-15 11:51:46,516 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:52:28,282 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:52:28,292 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:52:28,324 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:52:28,337 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:52:28,349 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:52:28,360 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:52:28,373 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:52:28,386 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:52:28,398 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:52:28,413 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:52:28,425 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:52:28,455 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:52:46,510 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:52:46,510 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:22:46.506281+00:00'
        RETURNING id
        
2025-05-15 11:52:46,511 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:53:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:53:46,514 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:23:46.509232+00:00'
        RETURNING id
        
2025-05-15 11:53:46,514 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:53:49,682 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:53:49,692 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:53:49,721 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:53:49,734 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:53:49,744 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:53:49,756 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:53:49,767 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:53:49,778 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:53:49,789 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:53:49,803 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:53:49,817 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:53:49,841 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:54:46,516 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:54:46,516 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:24:46.512684+00:00'
        RETURNING id
        
2025-05-15 11:54:46,517 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:55:46,537 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:55:46,538 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:25:46.518706+00:00'
        RETURNING id
        
2025-05-15 11:55:46,540 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:56:46,510 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:56:46,511 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:26:46.506380+00:00'
        RETURNING id
        
2025-05-15 11:56:46,511 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:57:46,510 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:57:46,510 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:27:46.506077+00:00'
        RETURNING id
        
2025-05-15 11:57:46,510 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:58:46,515 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:58:46,515 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:28:46.511462+00:00'
        RETURNING id
        
2025-05-15 11:58:46,515 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 11:59:23,148 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:59:23,166 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:59:23,194 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:59:23,208 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:59:23,221 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 11:59:23,234 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:59:23,244 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 11:59:23,255 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:59:23,268 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 11:59:23,280 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:59:23,290 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 11:59:23,331 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 11:59:46,513 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 11:59:46,513 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:29:46.509153+00:00'
        RETURNING id
        
2025-05-15 11:59:46,514 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:00:46,524 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:00:46,525 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:30:46.510895+00:00'
        RETURNING id
        
2025-05-15 12:00:46,525 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:01:46,505 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:01:46,505 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:31:46.501403+00:00'
        RETURNING id
        
2025-05-15 12:01:46,505 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:02:46,518 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:02:46,518 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:32:46.514252+00:00'
        RETURNING id
        
2025-05-15 12:02:46,519 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:03:46,522 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:03:46,522 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:33:46.518522+00:00'
        RETURNING id
        
2025-05-15 12:03:46,523 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:04:46,521 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:04:46,521 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:34:46.516875+00:00'
        RETURNING id
        
2025-05-15 12:04:46,521 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:05:46,511 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:05:46,511 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:35:46.506321+00:00'
        RETURNING id
        
2025-05-15 12:05:46,512 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:06:46,506 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:06:46,506 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:36:46.503149+00:00'
        RETURNING id
        
2025-05-15 12:06:46,506 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:07:46,509 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:07:46,509 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:37:46.505421+00:00'
        RETURNING id
        
2025-05-15 12:07:46,509 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:08:46,517 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:08:46,517 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:38:46.512796+00:00'
        RETURNING id
        
2025-05-15 12:08:46,517 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:09:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:09:46,514 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:39:46.510207+00:00'
        RETURNING id
        
2025-05-15 12:09:46,514 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:10:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:10:46,514 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:40:46.510506+00:00'
        RETURNING id
        
2025-05-15 12:10:46,515 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:11:46,502 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:11:46,502 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:41:46.498576+00:00'
        RETURNING id
        
2025-05-15 12:11:46,503 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:12:46,505 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:12:46,505 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:42:46.501032+00:00'
        RETURNING id
        
2025-05-15 12:12:46,505 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:13:18,038 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 12:13:18,046 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 12:13:18,051 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:13:18,085 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 12:13:18,089 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 12:13:18,127 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 12:13:18,178 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 12:13:18,189 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 12:13:18,203 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 12:13:38,062 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:13:38,078 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:13:38,186 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 12:13:38,197 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 12:13:38,211 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 12:13:38,235 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 12:13:38,259 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:13:38,278 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 12:13:38,289 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 12:13:38,303 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 12:13:38,320 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 12:13:46,523 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:13:46,523 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:43:46.519098+00:00'
        RETURNING id
        
2025-05-15 12:13:46,523 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:14:46,511 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:14:46,511 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:44:46.507628+00:00'
        RETURNING id
        
2025-05-15 12:14:46,511 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:15:46,508 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:15:46,508 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:45:46.503983+00:00'
        RETURNING id
        
2025-05-15 12:15:46,511 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:16:46,509 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:16:46,509 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:46:46.505716+00:00'
        RETURNING id
        
2025-05-15 12:16:46,510 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:17:46,503 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:17:46,503 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:47:46.499610+00:00'
        RETURNING id
        
2025-05-15 12:17:46,503 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:18:46,512 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:18:46,512 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:48:46.507868+00:00'
        RETURNING id
        
2025-05-15 12:18:46,513 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:19:46,508 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:19:46,508 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:49:46.504342+00:00'
        RETURNING id
        
2025-05-15 12:19:46,508 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:20:46,511 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:20:46,511 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:50:46.507041+00:00'
        RETURNING id
        
2025-05-15 12:20:46,511 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:21:46,506 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:21:46,506 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:51:46.501827+00:00'
        RETURNING id
        
2025-05-15 12:21:46,506 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:22:46,510 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:22:46,510 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:52:46.504915+00:00'
        RETURNING id
        
2025-05-15 12:22:46,510 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:23:46,503 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:23:46,503 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:53:46.500046+00:00'
        RETURNING id
        
2025-05-15 12:23:46,504 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:24:46,517 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:24:46,517 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:54:46.510988+00:00'
        RETURNING id
        
2025-05-15 12:24:46,518 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:25:46,502 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:25:46,503 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:55:46.497581+00:00'
        RETURNING id
        
2025-05-15 12:25:46,503 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:26:46,517 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:26:46,517 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:56:46.508597+00:00'
        RETURNING id
        
2025-05-15 12:26:46,519 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:27:46,508 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:27:46,508 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:57:46.503752+00:00'
        RETURNING id
        
2025-05-15 12:27:46,509 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:28:46,511 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:28:46,511 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:58:46.507511+00:00'
        RETURNING id
        
2025-05-15 12:28:46,511 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:29:46,503 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:29:46,504 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 06:59:46.497374+00:00'
        RETURNING id
        
2025-05-15 12:29:46,505 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:30:24,165 - api.utils.logging - INFO - Executing operation: SELECT * FROM users WHERE email = 'saranz1593@gmail.com'
2025-05-15 12:30:24,918 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:30:24,919 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 12:30:24,925 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:30:24,928 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:30:24,937 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 12:30:24,940 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 12:30:24,941 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 12:30:24,942 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 12:30:46,509 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:30:46,509 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:00:46.505077+00:00'
        RETURNING id
        
2025-05-15 12:30:46,510 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:30:47,362 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:30:47,371 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:30:47,399 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 12:30:47,413 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:30:47,424 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 12:30:47,434 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 12:30:47,446 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 12:30:47,458 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 12:30:47,468 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 12:30:47,478 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 12:30:47,487 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 12:30:47,519 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:31:46,504 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:31:46,504 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:01:46.500200+00:00'
        RETURNING id
        
2025-05-15 12:31:46,505 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:32:46,506 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:32:46,506 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:02:46.502901+00:00'
        RETURNING id
        
2025-05-15 12:32:46,507 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:33:46,507 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:33:46,508 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:03:46.503957+00:00'
        RETURNING id
        
2025-05-15 12:33:46,508 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:34:34,594 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:34:34,605 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:34:34,637 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 12:34:34,649 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:34:34,663 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 12:34:34,675 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 12:34:34,688 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 12:34:34,701 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 12:34:34,712 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 12:34:34,726 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 12:34:34,744 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 12:34:34,771 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:34:46,512 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:34:46,512 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:04:46.508667+00:00'
        RETURNING id
        
2025-05-15 12:34:46,513 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:35:41,209 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:35:41,216 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:35:41,239 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 12:35:41,250 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:35:41,261 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 12:35:41,275 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 12:35:41,286 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 12:35:41,295 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 12:35:41,306 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 12:35:41,316 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 12:35:41,326 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 12:35:41,348 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:35:46,515 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:35:46,515 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:05:46.511380+00:00'
        RETURNING id
        
2025-05-15 12:35:46,516 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:36:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:36:46,514 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:06:46.510825+00:00'
        RETURNING id
        
2025-05-15 12:36:46,514 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:37:46,501 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:37:46,501 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:07:46.498598+00:00'
        RETURNING id
        
2025-05-15 12:37:46,501 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:38:46,507 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:38:46,507 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:08:46.504252+00:00'
        RETURNING id
        
2025-05-15 12:38:46,507 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:39:46,508 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:39:46,508 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:09:46.504533+00:00'
        RETURNING id
        
2025-05-15 12:39:46,508 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:40:46,501 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:40:46,502 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:10:46.498238+00:00'
        RETURNING id
        
2025-05-15 12:40:46,502 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:41:46,501 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:41:46,501 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:11:46.497656+00:00'
        RETURNING id
        
2025-05-15 12:41:46,501 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:42:46,512 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:42:46,512 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:12:46.508111+00:00'
        RETURNING id
        
2025-05-15 12:42:46,513 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:43:46,516 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:43:46,516 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:13:46.513054+00:00'
        RETURNING id
        
2025-05-15 12:43:46,517 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:44:46,501 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:44:46,501 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:14:46.496576+00:00'
        RETURNING id
        
2025-05-15 12:44:46,503 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:44:59,351 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:44:59,362 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-15 12:44:59,375 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:44:59,415 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-15 12:44:59,418 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-15 12:44:59,448 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 12:44:59,459 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 12:44:59,487 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-15 12:44:59,491 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-15 12:44:59,507 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 12:44:59,510 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-15 12:44:59,523 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 12:44:59,526 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-15 12:44:59,535 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-15 12:44:59,540 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 12:44:59,635 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-15 12:44:59,639 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-15 12:44:59,648 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-15 12:45:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:45:46,515 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:15:46.509452+00:00'
        RETURNING id
        
2025-05-15 12:45:46,516 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:46:46,512 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:46:46,512 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:16:46.508673+00:00'
        RETURNING id
        
2025-05-15 12:46:46,512 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:47:46,502 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:47:46,503 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:17:46.499189+00:00'
        RETURNING id
        
2025-05-15 12:47:46,503 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:48:46,507 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:48:46,507 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:18:46.502718+00:00'
        RETURNING id
        
2025-05-15 12:48:46,507 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:49:46,503 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:49:46,503 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:19:46.497361+00:00'
        RETURNING id
        
2025-05-15 12:49:46,503 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:50:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:50:46,514 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:20:46.510636+00:00'
        RETURNING id
        
2025-05-15 12:50:46,514 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:51:46,521 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:51:46,521 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:21:46.509378+00:00'
        RETURNING id
        
2025-05-15 12:51:46,522 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:52:46,507 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:52:46,507 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:22:46.503839+00:00'
        RETURNING id
        
2025-05-15 12:52:46,508 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:53:46,510 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:53:46,510 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:23:46.506763+00:00'
        RETURNING id
        
2025-05-15 12:53:46,511 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:54:46,514 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:54:46,514 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:24:46.510940+00:00'
        RETURNING id
        
2025-05-15 12:54:46,515 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:55:46,512 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:55:46,512 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:25:46.500321+00:00'
        RETURNING id
        
2025-05-15 12:55:46,513 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:56:46,516 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:56:46,516 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:26:46.504563+00:00'
        RETURNING id
        
2025-05-15 12:56:46,517 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:57:46,520 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:57:46,520 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:27:46.508452+00:00'
        RETURNING id
        
2025-05-15 12:57:46,520 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:58:46,511 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:58:46,511 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:28:46.507501+00:00'
        RETURNING id
        
2025-05-15 12:58:46,511 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 12:59:46,501 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 12:59:46,501 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:29:46.497675+00:00'
        RETURNING id
        
2025-05-15 12:59:46,502 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 13:00:46,500 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 13:00:46,500 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 07:30:46.496139+00:00'
        RETURNING id
        
2025-05-15 13:00:46,501 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:31:20,775 - api.utils.logging - INFO - Logging system initialized
2025-05-15 14:31:21,773 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-15 14:31:21,784 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-15 14:31:30,141 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:31:30,147 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 14:31:30,150 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:31:30,152 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:31:30,158 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 14:31:30,160 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 14:31:30,160 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 14:31:30,161 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 14:32:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:32:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:02:20.998105+00:00'
        RETURNING id
        
2025-05-15 14:32:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:33:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:33:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:03:20.998495+00:00'
        RETURNING id
        
2025-05-15 14:33:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:33:50,744 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:33:50,753 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:33:50,762 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 14:33:50,768 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:33:50,772 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 14:33:50,773 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 14:33:50,774 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 14:33:50,774 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 14:34:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:34:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:04:21.002145+00:00'
        RETURNING id
        
2025-05-15 14:34:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:35:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:35:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:05:21.005648+00:00'
        RETURNING id
        
2025-05-15 14:35:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:35:23,303 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:35:23,307 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:35:23,319 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 14:35:23,323 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:35:23,326 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 14:35:23,327 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 14:35:23,327 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 14:35:23,327 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 14:36:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:36:21,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:06:20.998292+00:00'
        RETURNING id
        
2025-05-15 14:36:21,001 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:37:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:37:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:07:21.010206+00:00'
        RETURNING id
        
2025-05-15 14:37:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:38:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:38:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:08:20.999881+00:00'
        RETURNING id
        
2025-05-15 14:38:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:38:43,349 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:38:43,355 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:38:43,362 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 14:38:43,367 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:38:43,372 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 14:38:43,373 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 14:38:43,374 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 14:38:43,374 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 14:39:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:39:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:09:21.009507+00:00'
        RETURNING id
        
2025-05-15 14:39:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:40:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:40:21,007 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:10:21.003652+00:00'
        RETURNING id
        
2025-05-15 14:40:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:41:21,016 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:41:21,016 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:11:21.004834+00:00'
        RETURNING id
        
2025-05-15 14:41:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:42:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:42:21,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:12:20.997954+00:00'
        RETURNING id
        
2025-05-15 14:42:21,001 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:43:00,166 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:43:00,181 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:43:00,241 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 14:43:00,273 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 14:43:00,286 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 14:43:00,295 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 14:43:00,313 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:43:00,321 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 14:43:00,331 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 14:43:00,339 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 14:43:00,348 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 14:43:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:43:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:13:21.010127+00:00'
        RETURNING id
        
2025-05-15 14:43:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:44:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:44:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:14:21.005982+00:00'
        RETURNING id
        
2025-05-15 14:44:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:45:09,354 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:45:09,364 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:45:09,402 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 14:45:09,413 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 14:45:09,424 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 14:45:09,437 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 14:45:09,449 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 14:45:09,461 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 14:45:09,468 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 14:45:09,475 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 14:45:09,487 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 14:45:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:45:21,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:15:20.997792+00:00'
        RETURNING id
        
2025-05-15 14:45:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:46:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:46:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:16:20.997836+00:00'
        RETURNING id
        
2025-05-15 14:46:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:47:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:47:21,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:17:21.004039+00:00'
        RETURNING id
        
2025-05-15 14:47:21,008 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:48:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:48:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:18:21.005671+00:00'
        RETURNING id
        
2025-05-15 14:48:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:49:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:49:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:19:21.000319+00:00'
        RETURNING id
        
2025-05-15 14:49:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:50:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:50:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:20:21.007880+00:00'
        RETURNING id
        
2025-05-15 14:50:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:51:21,020 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:51:21,021 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:21:21.016818+00:00'
        RETURNING id
        
2025-05-15 14:51:21,021 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:52:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:52:21,019 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:22:21.007061+00:00'
        RETURNING id
        
2025-05-15 14:52:21,020 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:53:21,018 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:53:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:23:21.015331+00:00'
        RETURNING id
        
2025-05-15 14:53:21,019 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:54:21,016 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:54:21,017 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:24:21.013222+00:00'
        RETURNING id
        
2025-05-15 14:54:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:55:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:55:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:25:21.007105+00:00'
        RETURNING id
        
2025-05-15 14:55:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:56:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:56:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:26:21.011311+00:00'
        RETURNING id
        
2025-05-15 14:56:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:57:21,024 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:57:21,024 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:27:21.019529+00:00'
        RETURNING id
        
2025-05-15 14:57:21,024 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:58:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:58:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:28:21.011115+00:00'
        RETURNING id
        
2025-05-15 14:58:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 14:59:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 14:59:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:29:21.009472+00:00'
        RETURNING id
        
2025-05-15 14:59:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:00:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:00:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:30:20.998163+00:00'
        RETURNING id
        
2025-05-15 15:00:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:01:21,023 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:01:21,023 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:31:21.019179+00:00'
        RETURNING id
        
2025-05-15 15:01:21,024 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:02:21,017 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:02:21,017 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:32:21.011152+00:00'
        RETURNING id
        
2025-05-15 15:02:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:03:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:03:21,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:33:21.003923+00:00'
        RETURNING id
        
2025-05-15 15:03:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:04:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:04:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:34:21.011336+00:00'
        RETURNING id
        
2025-05-15 15:04:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:05:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:05:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:35:21.008406+00:00'
        RETURNING id
        
2025-05-15 15:05:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:06:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:06:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:36:21.009261+00:00'
        RETURNING id
        
2025-05-15 15:06:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:07:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:07:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:37:21.002351+00:00'
        RETURNING id
        
2025-05-15 15:07:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:08:21,000 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:08:21,000 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:38:20.997030+00:00'
        RETURNING id
        
2025-05-15 15:08:21,001 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:09:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:09:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:39:20.998122+00:00'
        RETURNING id
        
2025-05-15 15:09:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:10:21,016 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:10:21,017 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:40:21.012675+00:00'
        RETURNING id
        
2025-05-15 15:10:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:11:21,016 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:11:21,016 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:41:21.012375+00:00'
        RETURNING id
        
2025-05-15 15:11:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:12:21,022 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:12:21,023 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:42:21.018934+00:00'
        RETURNING id
        
2025-05-15 15:12:21,023 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:13:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:13:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:43:21.006549+00:00'
        RETURNING id
        
2025-05-15 15:13:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:14:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:14:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:44:21.006542+00:00'
        RETURNING id
        
2025-05-15 15:14:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:15:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:15:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:45:21.004152+00:00'
        RETURNING id
        
2025-05-15 15:15:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:16:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:16:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:46:21.011413+00:00'
        RETURNING id
        
2025-05-15 15:16:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:17:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:17:21,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:47:20.997963+00:00'
        RETURNING id
        
2025-05-15 15:17:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:18:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:18:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:48:21.008545+00:00'
        RETURNING id
        
2025-05-15 15:18:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:19:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:19:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:49:21.005709+00:00'
        RETURNING id
        
2025-05-15 15:19:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:20:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:20:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:50:20.999420+00:00'
        RETURNING id
        
2025-05-15 15:20:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:21:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:21:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:51:21.010014+00:00'
        RETURNING id
        
2025-05-15 15:21:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:22:21,020 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:22:21,021 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:52:21.016919+00:00'
        RETURNING id
        
2025-05-15 15:22:21,021 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:23:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:23:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:53:21.006860+00:00'
        RETURNING id
        
2025-05-15 15:23:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:24:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:24:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:54:21.006937+00:00'
        RETURNING id
        
2025-05-15 15:24:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:25:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:25:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:55:21.002391+00:00'
        RETURNING id
        
2025-05-15 15:25:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:26:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:26:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:56:21.003042+00:00'
        RETURNING id
        
2025-05-15 15:26:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:27:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:27:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:57:21.004690+00:00'
        RETURNING id
        
2025-05-15 15:27:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:28:21,016 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:28:21,016 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:58:21.012525+00:00'
        RETURNING id
        
2025-05-15 15:28:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:29:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:29:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 09:59:21.004858+00:00'
        RETURNING id
        
2025-05-15 15:29:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:30:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:30:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:00:21.007763+00:00'
        RETURNING id
        
2025-05-15 15:30:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:31:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:31:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:01:21.000489+00:00'
        RETURNING id
        
2025-05-15 15:31:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:32:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:32:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:02:21.007032+00:00'
        RETURNING id
        
2025-05-15 15:32:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:33:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:33:21,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:03:21.004866+00:00'
        RETURNING id
        
2025-05-15 15:33:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:34:21,016 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:34:21,016 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:04:21.011228+00:00'
        RETURNING id
        
2025-05-15 15:34:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:35:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:35:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:05:20.997153+00:00'
        RETURNING id
        
2025-05-15 15:35:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:36:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:36:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:06:21.005793+00:00'
        RETURNING id
        
2025-05-15 15:36:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:36:36,915 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:36:36,940 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:36:36,990 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:36:37,000 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:36:37,011 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:36:37,030 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:36:37,041 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:36:37,051 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:36:37,058 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:36:37,065 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:36:37,074 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:37:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:37:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:07:21.006255+00:00'
        RETURNING id
        
2025-05-15 15:37:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:38:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:38:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:08:21.011998+00:00'
        RETURNING id
        
2025-05-15 15:38:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:39:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:39:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:09:21.008292+00:00'
        RETURNING id
        
2025-05-15 15:39:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:40:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:40:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:10:21.011520+00:00'
        RETURNING id
        
2025-05-15 15:40:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:41:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:41:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:11:21.009373+00:00'
        RETURNING id
        
2025-05-15 15:41:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:42:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:42:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:12:21.000435+00:00'
        RETURNING id
        
2025-05-15 15:42:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:43:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:43:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:13:20.998086+00:00'
        RETURNING id
        
2025-05-15 15:43:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:44:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:44:21,005 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:14:21.000708+00:00'
        RETURNING id
        
2025-05-15 15:44:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:45:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:45:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:15:21.011601+00:00'
        RETURNING id
        
2025-05-15 15:45:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:46:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:46:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:16:21.011252+00:00'
        RETURNING id
        
2025-05-15 15:46:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:47:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:47:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:17:21.000042+00:00'
        RETURNING id
        
2025-05-15 15:47:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:48:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:48:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:18:21.008006+00:00'
        RETURNING id
        
2025-05-15 15:48:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:49:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:49:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:19:21.010348+00:00'
        RETURNING id
        
2025-05-15 15:49:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:50:18,965 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 15:50:18,972 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 15:50:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:50:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:20:21.000221+00:00'
        RETURNING id
        
2025-05-15 15:50:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:50:24,050 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:24,055 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 15:50:24,058 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:24,060 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:24,064 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:50:24,066 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 15:50:24,067 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 15:50:24,067 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 15:50:26,439 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:26,452 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:26,483 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 15:50:26,496 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 15:50:26,497 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:26,513 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 15:50:26,514 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 15:50:26,529 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:50:26,546 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 15:50:26,556 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 15:50:26,564 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:50:35,705 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:35,710 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:35,719 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 15:50:35,723 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:35,726 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:50:35,727 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 15:50:35,728 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 15:50:35,728 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 15:50:37,621 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:37,629 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:37,654 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:50:37,660 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:37,665 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:50:37,666 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:50:37,674 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:50:37,683 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:50:37,694 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:50:37,701 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:50:37,707 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:50:50,078 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 15:50:50,088 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:50,096 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 15:50:50,102 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 15:50:50,110 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 15:50:50,119 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 15:50:50,121 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:50:50,130 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 15:50:50,152 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:50,162 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:50:56,330 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 15:50:56,335 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 15:50:56,338 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:50:56,342 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 15:50:56,342 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:56,344 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 15:50:56,370 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 15:50:56,371 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 15:50:56,389 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:50:59,438 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 15:50:59,446 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:50:59,451 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 15:50:59,451 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 15:50:59,469 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 15:50:59,492 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 15:50:59,501 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 15:50:59,505 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:50:59,515 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:50:59,532 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:09,421 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:51:09,424 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:51:09,427 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:09,432 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:51:09,435 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:51:09,435 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:09,439 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:51:09,441 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:51:09,456 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:11,411 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 15:51:11,416 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 15:51:11,424 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 15:51:11,429 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 15:51:13,405 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 15:51:13,428 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 15:51:13,428 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:13,428 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 15:51:13,435 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 15:51:13,435 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 15:51:13,441 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:51:13,456 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:13,468 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 15:51:13,479 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:51:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:51:21,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:21:20.997052+00:00'
        RETURNING id
        
2025-05-15 15:51:21,001 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:51:26,179 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 15:51:26,182 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 15:51:26,186 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:26,190 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 15:51:26,192 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:26,194 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 15:51:26,209 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 15:51:26,214 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:26,221 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 15:51:27,449 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 15:51:27,459 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 15:51:27,462 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 15:51:27,462 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:27,467 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 15:51:27,468 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 15:51:27,477 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 15:51:27,477 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:51:27,499 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:51:27,508 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:28,247 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:51:28,250 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:51:28,254 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:28,256 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:51:28,267 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:28,270 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:51:28,270 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:51:28,291 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:51:28,299 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:29,297 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:29,297 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 15:51:29,302 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:29,302 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:29,306 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:51:29,307 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 15:51:29,307 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 15:51:29,307 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 15:51:40,181 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:40,190 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:40,218 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:51:40,228 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:51:40,235 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:40,245 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:51:40,256 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:40,267 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:51:40,274 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:51:40,282 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:40,292 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:51:43,825 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:43,832 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:43,839 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 15:51:43,842 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:43,845 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:51:43,846 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 15:51:43,846 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 15:51:43,847 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 15:51:45,718 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:45,726 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:45,750 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 15:51:45,757 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 15:51:45,763 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:45,771 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 15:51:45,779 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:45,791 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 15:51:45,798 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 15:51:45,805 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:45,813 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 15:51:52,614 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:52,617 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 15:51:52,620 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:52,621 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:52,625 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 15:51:52,626 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 15:51:52,626 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 15:51:52,627 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 15:51:57,537 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:57,544 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:57,563 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:51:57,570 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:51:57,576 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:57,584 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:51:57,592 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 15:51:57,603 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 15:51:57,610 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 15:51:57,619 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 15:51:57,632 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 15:52:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:52:21,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:22:21.005218+00:00'
        RETURNING id
        
2025-05-15 15:52:21,008 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:53:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:53:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:23:21.002538+00:00'
        RETURNING id
        
2025-05-15 15:53:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:54:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:54:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:24:21.010461+00:00'
        RETURNING id
        
2025-05-15 15:54:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:55:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:55:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:25:21.000073+00:00'
        RETURNING id
        
2025-05-15 15:55:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:56:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:56:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:26:21.006021+00:00'
        RETURNING id
        
2025-05-15 15:56:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:57:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:57:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:27:20.998877+00:00'
        RETURNING id
        
2025-05-15 15:57:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:58:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:58:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:28:21.006802+00:00'
        RETURNING id
        
2025-05-15 15:58:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 15:59:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 15:59:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:29:21.006787+00:00'
        RETURNING id
        
2025-05-15 15:59:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:00:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:00:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:30:20.998505+00:00'
        RETURNING id
        
2025-05-15 16:00:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:01:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:01:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:31:21.006573+00:00'
        RETURNING id
        
2025-05-15 16:01:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:01:40,014 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 16:01:40,019 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 16:02:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:02:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:32:21.009795+00:00'
        RETURNING id
        
2025-05-15 16:02:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:03:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:03:21,007 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:33:21.004222+00:00'
        RETURNING id
        
2025-05-15 16:03:21,008 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:03:41,795 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 16:03:41,802 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 16:03:41,810 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 2 AND deleted_at IS NULL
        
2025-05-15 16:03:41,817 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 2 ORDER BY position ASC
            
2025-05-15 16:03:41,891 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 2 AND deleted_at IS NULL
        
2025-05-15 16:03:41,896 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 2 ORDER BY position ASC
            
2025-05-15 16:04:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:04:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:34:21.008621+00:00'
        RETURNING id
        
2025-05-15 16:04:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:05:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:05:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:35:20.999679+00:00'
        RETURNING id
        
2025-05-15 16:05:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:06:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:06:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:36:21.010576+00:00'
        RETURNING id
        
2025-05-15 16:06:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:07:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:07:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:37:21.005294+00:00'
        RETURNING id
        
2025-05-15 16:07:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:08:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:08:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:38:20.998364+00:00'
        RETURNING id
        
2025-05-15 16:08:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:09:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:09:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:39:21.010465+00:00'
        RETURNING id
        
2025-05-15 16:09:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:10:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:10:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:40:20.997444+00:00'
        RETURNING id
        
2025-05-15 16:10:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:11:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:11:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:41:21.007152+00:00'
        RETURNING id
        
2025-05-15 16:11:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:12:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:12:21,007 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:42:21.003858+00:00'
        RETURNING id
        
2025-05-15 16:12:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:12:52,423 - api.utils.logging - INFO - Executing operation: SELECT task_id, milestone_id, ordering FROM course_tasks WHERE course_id = 2 AND task_id IN (1, 2)
2025-05-15 16:12:52,431 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:12:52,431 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 1 WHERE id = 1
2025-05-15 16:12:52,431 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 0 WHERE id = 2
2025-05-15 16:12:52,431 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:12:53,833 - api.utils.logging - INFO - Executing operation: SELECT task_id, milestone_id, ordering FROM course_tasks WHERE course_id = 2 AND task_id IN (2, 1)
2025-05-15 16:12:53,839 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:12:53,839 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 0 WHERE id = 1
2025-05-15 16:12:53,839 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 1 WHERE id = 2
2025-05-15 16:12:53,839 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:13:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:13:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:43:21.007467+00:00'
        RETURNING id
        
2025-05-15 16:13:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:14:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:14:21,007 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:44:21.003899+00:00'
        RETURNING id
        
2025-05-15 16:14:21,008 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:15:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:15:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:45:20.998707+00:00'
        RETURNING id
        
2025-05-15 16:15:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:16:21,019 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:16:21,019 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:46:21.014913+00:00'
        RETURNING id
        
2025-05-15 16:16:21,019 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:17:21,018 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:17:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:47:21.012017+00:00'
        RETURNING id
        
2025-05-15 16:17:21,018 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:18:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:18:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:48:21.009490+00:00'
        RETURNING id
        
2025-05-15 16:18:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:19:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:19:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:49:21.000639+00:00'
        RETURNING id
        
2025-05-15 16:19:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:20:21,017 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:20:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:50:21.005059+00:00'
        RETURNING id
        
2025-05-15 16:20:21,018 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:21:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:21:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:51:21.000048+00:00'
        RETURNING id
        
2025-05-15 16:21:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:22:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:22:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:52:21.007670+00:00'
        RETURNING id
        
2025-05-15 16:22:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:23:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:23:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:53:21.000706+00:00'
        RETURNING id
        
2025-05-15 16:23:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:24:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:24:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:54:21.000993+00:00'
        RETURNING id
        
2025-05-15 16:24:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:25:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:25:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:55:21.002807+00:00'
        RETURNING id
        
2025-05-15 16:25:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:26:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:26:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:56:21.000064+00:00'
        RETURNING id
        
2025-05-15 16:26:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:27:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:27:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:57:20.999071+00:00'
        RETURNING id
        
2025-05-15 16:27:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:28:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:28:21,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:58:20.997532+00:00'
        RETURNING id
        
2025-05-15 16:28:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:29:21,019 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:29:21,019 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 10:59:21.007741+00:00'
        RETURNING id
        
2025-05-15 16:29:21,020 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:30:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:30:21,005 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:00:21.000482+00:00'
        RETURNING id
        
2025-05-15 16:30:21,006 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:31:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:31:21,005 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:01:21.000359+00:00'
        RETURNING id
        
2025-05-15 16:31:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:32:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:32:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:02:21.002139+00:00'
        RETURNING id
        
2025-05-15 16:32:21,006 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:33:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:33:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:03:21.000351+00:00'
        RETURNING id
        
2025-05-15 16:33:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:34:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:34:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:04:21.006413+00:00'
        RETURNING id
        
2025-05-15 16:34:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:35:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:35:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:05:21.008490+00:00'
        RETURNING id
        
2025-05-15 16:35:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:36:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:36:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:06:20.999659+00:00'
        RETURNING id
        
2025-05-15 16:36:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:37:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:37:21,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:07:20.997568+00:00'
        RETURNING id
        
2025-05-15 16:37:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:38:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:38:21,007 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:08:21.002870+00:00'
        RETURNING id
        
2025-05-15 16:38:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:39:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:39:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:09:20.999777+00:00'
        RETURNING id
        
2025-05-15 16:39:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:40:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:40:21,021 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:10:21.011086+00:00'
        RETURNING id
        
2025-05-15 16:40:21,022 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:41:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:41:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:11:21.006298+00:00'
        RETURNING id
        
2025-05-15 16:41:21,019 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:42:21,023 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:42:21,023 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:12:21.009063+00:00'
        RETURNING id
        
2025-05-15 16:42:21,023 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:43:21,018 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:43:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:13:21.014280+00:00'
        RETURNING id
        
2025-05-15 16:43:21,018 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:44:21,021 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:44:21,021 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:14:21.017063+00:00'
        RETURNING id
        
2025-05-15 16:44:21,022 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:44:39,314 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:44:39,314 - api.utils.logging - INFO - Executing operation: UPDATE courses SET name = 'HTML' WHERE id = 2
2025-05-15 16:44:39,315 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:44:59,944 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 16:44:59,949 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 16:44:59,956 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 16:44:59,957 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 16:44:59,972 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 16:44:59,977 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 16:45:00,970 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 16:45:00,983 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 16:45:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:45:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:15:21.001737+00:00'
        RETURNING id
        
2025-05-15 16:45:21,008 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:46:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:46:21,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:16:21.003512+00:00'
        RETURNING id
        
2025-05-15 16:46:21,008 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:47:21,019 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:47:21,019 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:17:21.006191+00:00'
        RETURNING id
        
2025-05-15 16:47:21,024 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:48:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:48:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:18:21.000689+00:00'
        RETURNING id
        
2025-05-15 16:48:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:49:21,025 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:49:21,025 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:19:21.010700+00:00'
        RETURNING id
        
2025-05-15 16:49:21,025 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:50:17,533 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 16:50:17,558 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 16:50:17,571 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 16:50:17,585 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 16:50:17,618 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 16:50:17,634 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 16:50:17,647 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 16:50:17,673 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 16:50:17,692 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 16:50:17,710 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 16:50:17,721 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 16:50:17,732 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 16:50:17,744 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 16:50:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:50:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:20:21.010758+00:00'
        RETURNING id
        
2025-05-15 16:50:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:51:11,389 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 16:51:11,395 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 16:51:11,731 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 16:51:11,733 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 16:51:11,750 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 16:51:11,752 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 16:51:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:51:21,005 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:21:21.000709+00:00'
        RETURNING id
        
2025-05-15 16:51:21,006 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:51:29,936 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 16:51:29,950 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 16:51:29,966 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 16:51:29,974 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 16:51:30,197 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 16:51:30,202 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 16:52:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:52:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:22:21.009314+00:00'
        RETURNING id
        
2025-05-15 16:52:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:53:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:53:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:23:21.010989+00:00'
        RETURNING id
        
2025-05-15 16:53:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:54:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:54:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:24:21.011122+00:00'
        RETURNING id
        
2025-05-15 16:54:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:55:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:55:21,016 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:25:21.010461+00:00'
        RETURNING id
        
2025-05-15 16:55:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:56:21,000 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:56:21,000 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:26:20.997621+00:00'
        RETURNING id
        
2025-05-15 16:56:21,001 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:57:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:57:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:27:21.002040+00:00'
        RETURNING id
        
2025-05-15 16:57:21,006 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:58:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:58:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:28:21.010584+00:00'
        RETURNING id
        
2025-05-15 16:58:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 16:59:21,018 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 16:59:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:29:21.004799+00:00'
        RETURNING id
        
2025-05-15 16:59:21,019 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:00:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:00:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:30:20.997294+00:00'
        RETURNING id
        
2025-05-15 17:00:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:01:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:01:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:31:21.006478+00:00'
        RETURNING id
        
2025-05-15 17:01:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:02:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:02:21,016 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:32:21.010834+00:00'
        RETURNING id
        
2025-05-15 17:02:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:03:21,023 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:03:21,024 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:33:21.013300+00:00'
        RETURNING id
        
2025-05-15 17:03:21,025 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:04:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:04:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:34:21.006058+00:00'
        RETURNING id
        
2025-05-15 17:04:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:05:21,021 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:05:21,021 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:35:21.009500+00:00'
        RETURNING id
        
2025-05-15 17:05:21,021 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:06:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:06:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:36:21.007043+00:00'
        RETURNING id
        
2025-05-15 17:06:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:07:18,605 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 17:07:18,610 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 17:07:18,613 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 17:07:18,632 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 17:07:18,637 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 17:07:18,639 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 17:07:20,793 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 17:07:20,817 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 17:07:21,020 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:07:21,020 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:37:21.011791+00:00'
        RETURNING id
        
2025-05-15 17:07:21,023 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:07:33,848 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 17:07:33,853 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 17:07:33,866 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 17:07:33,872 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 17:07:34,184 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 17:07:34,188 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 17:07:34,193 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 17:07:34,197 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 17:08:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:08:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:38:20.999547+00:00'
        RETURNING id
        
2025-05-15 17:08:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:09:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:09:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:39:21.002749+00:00'
        RETURNING id
        
2025-05-15 17:09:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:10:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:10:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:40:20.998990+00:00'
        RETURNING id
        
2025-05-15 17:10:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:11:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:11:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:41:21.007069+00:00'
        RETURNING id
        
2025-05-15 17:11:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:12:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:12:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:42:20.998515+00:00'
        RETURNING id
        
2025-05-15 17:12:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:13:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:13:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:43:21.005516+00:00'
        RETURNING id
        
2025-05-15 17:13:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:14:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:14:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:44:21.007837+00:00'
        RETURNING id
        
2025-05-15 17:14:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:15:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:15:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:45:21.006529+00:00'
        RETURNING id
        
2025-05-15 17:15:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:16:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:16:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:46:21.009159+00:00'
        RETURNING id
        
2025-05-15 17:16:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:17:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:17:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:47:21.007811+00:00'
        RETURNING id
        
2025-05-15 17:17:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:18:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:18:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:48:21.006479+00:00'
        RETURNING id
        
2025-05-15 17:18:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:19:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:19:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:49:21.008492+00:00'
        RETURNING id
        
2025-05-15 17:19:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:20:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:20:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:50:21.008286+00:00'
        RETURNING id
        
2025-05-15 17:20:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:20:57,815 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 17:20:57,833 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 17:20:57,839 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 17:20:57,841 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 17:20:57,849 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 17:20:57,861 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 17:20:58,607 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 17:20:58,619 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 17:21:00,578 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 17:21:00,583 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 17:21:00,910 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 17:21:00,914 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 17:21:00,924 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 17:21:00,930 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 17:21:21,017 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:21:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:51:21.005886+00:00'
        RETURNING id
        
2025-05-15 17:21:21,018 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:22:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:22:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:52:21.008447+00:00'
        RETURNING id
        
2025-05-15 17:22:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:23:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:23:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:53:21.008941+00:00'
        RETURNING id
        
2025-05-15 17:23:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:24:21,023 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:24:21,023 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:54:21.019082+00:00'
        RETURNING id
        
2025-05-15 17:24:21,024 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:25:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:25:21,005 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:55:21.000647+00:00'
        RETURNING id
        
2025-05-15 17:25:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:26:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:26:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:56:20.998964+00:00'
        RETURNING id
        
2025-05-15 17:26:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:27:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:27:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:57:21.009465+00:00'
        RETURNING id
        
2025-05-15 17:27:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:28:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:28:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:58:21.011014+00:00'
        RETURNING id
        
2025-05-15 17:28:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:29:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:29:21,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 11:59:21.004334+00:00'
        RETURNING id
        
2025-05-15 17:29:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:30:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:30:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:00:21.011488+00:00'
        RETURNING id
        
2025-05-15 17:30:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:31:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:31:21,007 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:01:21.003817+00:00'
        RETURNING id
        
2025-05-15 17:31:21,008 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:32:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:32:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:02:21.000776+00:00'
        RETURNING id
        
2025-05-15 17:32:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:33:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:33:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:03:21.007932+00:00'
        RETURNING id
        
2025-05-15 17:33:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:34:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:34:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:04:21.002689+00:00'
        RETURNING id
        
2025-05-15 17:34:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:35:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:35:21,005 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:05:21.001838+00:00'
        RETURNING id
        
2025-05-15 17:35:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:36:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:36:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:06:20.999299+00:00'
        RETURNING id
        
2025-05-15 17:36:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:37:21,019 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:37:21,019 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:07:21.016014+00:00'
        RETURNING id
        
2025-05-15 17:37:21,020 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:38:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:38:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:08:20.999531+00:00'
        RETURNING id
        
2025-05-15 17:38:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:39:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:39:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:09:21.005487+00:00'
        RETURNING id
        
2025-05-15 17:39:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:40:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:40:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:10:20.999960+00:00'
        RETURNING id
        
2025-05-15 17:40:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:41:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:41:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:11:20.998769+00:00'
        RETURNING id
        
2025-05-15 17:41:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:42:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:42:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:12:21.002369+00:00'
        RETURNING id
        
2025-05-15 17:42:21,006 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:43:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:43:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:13:21.006142+00:00'
        RETURNING id
        
2025-05-15 17:43:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:44:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:44:21,005 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:14:21.001941+00:00'
        RETURNING id
        
2025-05-15 17:44:21,006 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:45:21,022 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:45:21,022 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:15:21.009720+00:00'
        RETURNING id
        
2025-05-15 17:45:21,022 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:46:21,016 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:46:21,016 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:16:21.003730+00:00'
        RETURNING id
        
2025-05-15 17:46:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:47:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:47:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:17:21.008644+00:00'
        RETURNING id
        
2025-05-15 17:47:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:48:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:48:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:18:21.005127+00:00'
        RETURNING id
        
2025-05-15 17:48:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:49:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:49:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:19:21.009260+00:00'
        RETURNING id
        
2025-05-15 17:49:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:50:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:50:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:20:20.999881+00:00'
        RETURNING id
        
2025-05-15 17:50:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:51:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:51:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:21:20.998876+00:00'
        RETURNING id
        
2025-05-15 17:51:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:52:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:52:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:22:20.999638+00:00'
        RETURNING id
        
2025-05-15 17:52:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:53:21,020 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:53:21,020 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:23:21.006464+00:00'
        RETURNING id
        
2025-05-15 17:53:21,021 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:54:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:54:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:24:21.004883+00:00'
        RETURNING id
        
2025-05-15 17:54:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:55:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:55:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:25:20.997576+00:00'
        RETURNING id
        
2025-05-15 17:55:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:55:50,370 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 17:55:50,468 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 17:55:50,599 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 17:55:50,604 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 17:55:50,617 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 17:55:50,629 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-15 17:55:50,631 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 17:55:50,654 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 17:55:50,677 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 17:55:50,687 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 17:55:50,697 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 17:56:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:56:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:26:21.009008+00:00'
        RETURNING id
        
2025-05-15 17:56:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:57:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:57:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:27:20.997656+00:00'
        RETURNING id
        
2025-05-15 17:57:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:58:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:58:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:28:21.007088+00:00'
        RETURNING id
        
2025-05-15 17:58:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 17:59:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 17:59:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:29:21.007599+00:00'
        RETURNING id
        
2025-05-15 17:59:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:00:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:00:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:30:21.000007+00:00'
        RETURNING id
        
2025-05-15 18:00:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:01:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:01:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:31:21.000502+00:00'
        RETURNING id
        
2025-05-15 18:01:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:02:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:02:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:32:20.998571+00:00'
        RETURNING id
        
2025-05-15 18:02:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:03:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:03:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:33:20.998236+00:00'
        RETURNING id
        
2025-05-15 18:03:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:04:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:04:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:34:21.006125+00:00'
        RETURNING id
        
2025-05-15 18:04:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:05:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:05:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:35:21.001257+00:00'
        RETURNING id
        
2025-05-15 18:05:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:06:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:06:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:36:21.009355+00:00'
        RETURNING id
        
2025-05-15 18:06:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:07:21,022 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:07:21,022 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:37:21.008778+00:00'
        RETURNING id
        
2025-05-15 18:07:21,023 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:08:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:08:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:38:21.008455+00:00'
        RETURNING id
        
2025-05-15 18:08:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:09:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:09:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:39:21.007495+00:00'
        RETURNING id
        
2025-05-15 18:09:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:09:30,699 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 18:09:30,699 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-15 18:09:30,707 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 18:09:30,709 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-15 18:09:30,720 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 18:09:30,748 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 18:09:31,641 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:09:31,655 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:09:33,251 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 18:09:33,262 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 18:09:33,611 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 18:09:33,616 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 18:09:33,617 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 18:09:33,633 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 18:10:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:10:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:40:21.009094+00:00'
        RETURNING id
        
2025-05-15 18:10:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:10:22,052 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 18:10:22,060 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 18:10:22,087 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-15 18:10:22,096 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-15 18:10:32,151 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:32,166 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:32,207 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 18:10:32,225 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:32,238 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 18:10:32,253 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 18:10:32,269 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 18:10:32,290 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 18:10:32,304 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 18:10:32,317 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 18:10:32,333 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 18:10:32,366 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:39,753 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:39,767 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:39,799 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 18:10:39,805 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:39,817 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 18:10:39,827 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 18:10:39,851 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 18:10:39,853 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 18:10:39,867 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 18:10:39,870 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 18:10:39,903 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 18:10:39,918 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:43,857 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:43,871 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:43,901 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 18:10:43,916 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:43,931 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-15 18:10:43,948 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 18:10:43,963 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-15 18:10:43,976 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 18:10:43,989 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-15 18:10:44,001 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 18:10:44,015 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 18:10:44,052 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:48,902 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:48,910 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-15 18:10:48,915 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:48,919 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:48,924 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-15 18:10:48,927 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-15 18:10:48,929 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-15 18:10:48,929 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-15 18:10:52,174 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:52,194 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:52,316 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 18:10:52,317 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 18:10:52,341 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:10:52,351 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 18:10:52,370 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 18:10:52,385 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 18:10:52,399 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 18:10:52,407 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 18:10:52,417 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 18:11:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:11:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:41:20.997186+00:00'
        RETURNING id
        
2025-05-15 18:11:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:12:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:12:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:42:21.000839+00:00'
        RETURNING id
        
2025-05-15 18:12:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:13:21,019 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:13:21,020 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:43:21.009662+00:00'
        RETURNING id
        
2025-05-15 18:13:21,022 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:14:21,019 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:14:21,019 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:44:21.011635+00:00'
        RETURNING id
        
2025-05-15 18:14:21,020 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:14:28,930 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-15 18:14:28,939 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:14:28,939 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'quiz', 'New Quiz', 'draft')
2025-05-15 18:14:28,940 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-15 18:14:28,942 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 5, 3, 1)
2025-05-15 18:14:28,943 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:14:28,964 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 1 AND t.deleted_at IS NULL
            
2025-05-15 18:14:33,380 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:14:33,399 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:14:33,399 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:14:33,418 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:14:33,434 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:14:33,444 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:15:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:45:20.998482+00:00'
        RETURNING id
        
2025-05-15 18:15:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:15:26,057 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:26,151 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:26,166 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:26,180 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:26,193 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:26,201 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:32,498 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:32,511 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:32,526 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:32,537 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:32,549 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:32,558 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:34,182 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:34,198 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:34,202 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:34,245 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:34,259 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:34,268 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:36,074 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:36,086 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:36,089 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:36,098 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:36,110 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:36,119 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:37,180 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:37,190 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:37,199 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:37,205 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:37,213 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:37,219 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:39,478 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:39,490 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:15:39,502 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:39,511 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:15:39,521 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:15:39,527 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:00,500 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:00,512 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:00,526 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:00,535 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:00,547 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:00,558 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:04,195 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:04,210 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:04,210 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:04,221 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:04,235 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:04,244 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:07,189 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:07,201 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:07,213 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:07,221 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:07,235 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:07,241 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:20,506 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:20,527 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:20,543 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:20,555 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:20,571 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:20,582 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:21,017 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:16:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:46:21.011853+00:00'
        RETURNING id
        
2025-05-15 18:16:21,021 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:16:21,527 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:21,548 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:21,549 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:21,577 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:21,598 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:21,611 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:35,505 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:35,518 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:35,531 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:35,539 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:35,553 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:35,562 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:38,500 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:38,510 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:16:38,521 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:38,528 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:16:38,539 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:16:38,547 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:17:07,483 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:17:07,497 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:17:07,508 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:17:07,515 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:17:07,526 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:17:07,534 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:17:09,486 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:17:09,503 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:17:09,517 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:17:09,528 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:17:09,541 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:17:09,550 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:17:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:17:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:47:20.998815+00:00'
        RETURNING id
        
2025-05-15 18:17:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:18:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:18:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:48:20.997720+00:00'
        RETURNING id
        
2025-05-15 18:18:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:19:00,508 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:00,517 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:00,526 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:00,532 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:00,540 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:00,547 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:20,503 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:20,510 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:20,519 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:20,523 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:20,531 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:20,537 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:19:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:49:21.001401+00:00'
        RETURNING id
        
2025-05-15 18:19:21,006 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:19:23,188 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:23,197 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:23,197 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:23,203 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:23,210 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:23,215 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:27,482 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:27,488 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:27,496 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:27,500 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:27,508 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:27,512 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:31,111 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:31,137 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:31,161 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:31,194 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:31,223 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:31,238 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:53,593 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:53,603 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:19:53,612 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:53,618 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:19:53,627 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:19:53,634 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:08,475 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:08,482 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:08,489 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:08,493 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:08,499 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:08,506 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:11,363 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:11,377 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:11,377 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:11,404 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:11,415 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:11,422 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:21,023 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:20:21,023 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:50:21.019883+00:00'
        RETURNING id
        
2025-05-15 18:20:21,024 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:20:34,665 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:34,678 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:34,690 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:34,698 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:34,708 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:34,715 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:58,164 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:58,181 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:58,202 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:58,212 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:58,229 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:58,237 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:59,192 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:59,201 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:20:59,201 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:59,207 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:20:59,214 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:20:59,219 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:00,448 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:00,463 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:00,489 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:00,504 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:00,516 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:00,522 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:02,187 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:02,194 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:02,211 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:02,215 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:02,222 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:02,227 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:04,013 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:04,031 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:04,047 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:04,055 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:04,066 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:04,078 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:04,836 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:04,851 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:04,861 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:04,872 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:04,891 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:04,899 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:15,490 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:15,508 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:15,522 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:15,532 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:15,548 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:15,557 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:16,188 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:16,198 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:16,210 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:16,216 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:16,224 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:16,231 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:20,264 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:20,294 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:20,295 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:20,304 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:20,336 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:20,346 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:21:21,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:51:20.998296+00:00'
        RETURNING id
        
2025-05-15 18:21:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:21:22,178 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:22,184 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:22,187 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:22,192 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:22,198 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:22,203 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:24,893 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:24,912 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:21:24,934 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:24,944 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:21:24,959 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:21:24,972 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:22:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:22:21,007 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:52:21.003319+00:00'
        RETURNING id
        
2025-05-15 18:22:21,007 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:23:05,505 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:23:08,299 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:23:08,320 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:23:08,333 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:23:19,501 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:23:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:23:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:53:21.007167+00:00'
        RETURNING id
        
2025-05-15 18:23:21,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:23:24,787 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:23:24,816 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:23:24,824 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:23:25,538 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:23:32,509 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:23:32,520 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:23:32,525 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:23:36,113 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:23:50,478 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:23:50,485 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:23:50,490 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:23:56,854 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:24:17,482 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:24:17,489 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:24:17,494 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:24:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:24:21,015 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:54:21.011422+00:00'
        RETURNING id
        
2025-05-15 18:24:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:25:01,049 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:25:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:25:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:55:21.010735+00:00'
        RETURNING id
        
2025-05-15 18:25:21,015 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:25:42,486 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:25:42,493 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:25:42,497 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:26:21,018 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:26:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:56:21.015393+00:00'
        RETURNING id
        
2025-05-15 18:26:21,018 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:27:03,488 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:07,487 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:07,495 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:27:07,500 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:27:09,174 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:13,185 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:13,193 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:27:13,197 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:27:16,479 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:20,571 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:20,582 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:27:20,588 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:27:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:27:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:57:21.007231+00:00'
        RETURNING id
        
2025-05-15 18:27:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:27:29,486 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:37,480 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:37,487 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:27:37,492 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:27:41,177 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:57,481 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:27:57,490 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:27:57,496 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:28:01,186 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:28:10,182 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:28:10,189 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:28:10,194 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:28:15,571 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:28:21,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:28:21,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:58:20.998427+00:00'
        RETURNING id
        
2025-05-15 18:28:21,006 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:28:21,492 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:28:21,499 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:28:21,504 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:28:23,175 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:28:26,240 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:28:26,257 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:28:26,267 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:29:00,486 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:29:06,186 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:29:06,196 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:29:06,201 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:29:15,490 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:29:16,171 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:29:16,179 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:29:16,183 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:29:18,184 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:29:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:29:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 12:59:21.011019+00:00'
        RETURNING id
        
2025-05-15 18:29:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:29:25,476 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-15 18:29:25,487 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-15 18:29:25,494 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-15 18:30:21,020 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:30:21,020 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:00:21.015602+00:00'
        RETURNING id
        
2025-05-15 18:30:21,020 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:31:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:31:21,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:01:21.000531+00:00'
        RETURNING id
        
2025-05-15 18:31:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:32:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:32:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:02:21.007957+00:00'
        RETURNING id
        
2025-05-15 18:32:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:33:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:33:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:03:21.005473+00:00'
        RETURNING id
        
2025-05-15 18:33:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:34:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:34:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:04:21.007363+00:00'
        RETURNING id
        
2025-05-15 18:34:21,014 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:35:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:35:21,016 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:05:21.001479+00:00'
        RETURNING id
        
2025-05-15 18:35:21,018 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:36:21,015 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:36:21,016 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:06:21.011681+00:00'
        RETURNING id
        
2025-05-15 18:36:21,016 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:37:21,011 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:37:21,011 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:07:21.007512+00:00'
        RETURNING id
        
2025-05-15 18:37:21,012 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:38:21,013 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:38:21,013 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:08:21.008905+00:00'
        RETURNING id
        
2025-05-15 18:38:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:38:38,922 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:38:38,927 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:39:21,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:39:21,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:09:21.004845+00:00'
        RETURNING id
        
2025-05-15 18:39:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:39:29,224 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:39:29,229 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:39:32,541 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:39:32,546 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:39:36,208 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:39:36,213 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:39:38,209 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:39:38,214 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:39:41,512 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:39:41,517 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:39:43,050 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:39:43,057 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:39:43,916 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:39:43,927 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:39:56,518 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:39:56,523 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:40:11,390 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:40:11,397 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:40:21,007 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:40:21,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:10:21.005042+00:00'
        RETURNING id
        
2025-05-15 18:40:21,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:40:27,525 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:40:27,533 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:40:29,211 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:40:29,217 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:40:31,509 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:40:31,513 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:40:35,199 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:40:35,205 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:40:41,525 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:40:41,533 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:40:42,208 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:40:42,215 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:41:13,475 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:41:13,482 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:41:21,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:41:21,005 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:11:21.001586+00:00'
        RETURNING id
        
2025-05-15 18:41:21,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:41:23,529 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:41:23,539 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:41:29,932 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:41:29,938 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:41:31,503 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:41:31,508 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:41:53,519 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:41:53,525 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:41:55,235 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:41:55,239 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:41:57,044 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:41:57,049 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:41:58,211 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:41:58,215 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:42:00,204 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:42:00,209 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:42:16,537 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:42:16,541 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:42:19,206 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:42:19,213 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:42:21,009 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:42:21,009 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:12:21.005370+00:00'
        RETURNING id
        
2025-05-15 18:42:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:42:22,455 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:42:22,471 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:43:21,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:43:21,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:13:21.006134+00:00'
        RETURNING id
        
2025-05-15 18:43:21,010 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:43:28,508 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:43:28,513 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:43:32,207 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:43:32,212 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:43:33,197 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:43:33,201 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:43:38,493 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:43:38,497 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:43:46,517 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:43:46,521 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:43:49,190 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:43:49,195 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:43:55,208 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:43:55,214 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:44:11,513 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:44:11,517 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:44:14,190 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:44:14,195 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:44:16,506 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:44:16,514 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:44:20,202 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:44:20,209 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:44:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:44:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:14:20.998742+00:00'
        RETURNING id
        
2025-05-15 18:44:21,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:44:26,516 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:44:26,521 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:44:27,200 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:44:27,206 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:44:37,538 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:44:37,544 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:44:39,204 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:44:39,208 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:45:21,016 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:45:21,017 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:15:21.008156+00:00'
        RETURNING id
        
2025-05-15 18:45:21,019 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:46:21,021 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:46:21,021 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:16:21.008407+00:00'
        RETURNING id
        
2025-05-15 18:46:21,022 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:47:19,266 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:47:19,304 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:47:19,446 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 18:47:19,458 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 18:47:19,464 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 18:47:19,517 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-15 18:47:19,521 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 18:47:19,546 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-15 18:47:19,569 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-15 18:47:19,582 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-15 18:47:19,601 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-15 18:47:21,014 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:47:21,014 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:17:21.007222+00:00'
        RETURNING id
        
2025-05-15 18:47:21,017 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:47:22,464 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:47:22,477 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-15 18:47:22,479 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:47:22,491 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-15 18:48:21,020 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:48:21,021 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:18:21.016601+00:00'
        RETURNING id
        
2025-05-15 18:48:21,021 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:49:21,012 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:49:21,012 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:19:21.007004+00:00'
        RETURNING id
        
2025-05-15 18:49:21,013 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:50:21,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:50:21,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:20:20.999750+00:00'
        RETURNING id
        
2025-05-15 18:50:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:51:21,001 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:51:21,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:21:20.997903+00:00'
        RETURNING id
        
2025-05-15 18:51:21,001 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:52:21,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:52:21,002 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:22:20.998426+00:00'
        RETURNING id
        
2025-05-15 18:52:21,003 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:53:21,018 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:53:21,018 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:23:21.013726+00:00'
        RETURNING id
        
2025-05-15 18:53:21,018 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-15 18:54:21,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-15 18:54:21,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-15 13:24:20.998986+00:00'
        RETURNING id
        
2025-05-15 18:54:21,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:17:03,567 - api.utils.logging - INFO - Logging system initialized
2025-05-16 09:17:04,833 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 09:17:04,833 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 09:17:30,102 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:17:30,109 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 09:17:30,114 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:17:30,115 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:17:30,120 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:17:30,122 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 09:17:30,123 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 09:17:30,123 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 09:17:46,463 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:17:46,474 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:17:46,709 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:17:46,733 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:17:46,734 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-16 09:17:46,753 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:17:46,755 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:17:46,784 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-16 09:17:46,789 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:17:46,805 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:17:46,818 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:18:03,907 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:18:03,920 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:48:03.898205+00:00'
        RETURNING id
        
2025-05-16 09:18:03,923 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:18:05,931 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:18:05,939 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:18:05,976 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:18:05,984 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:18:05,992 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:18:06,002 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:18:06,012 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:18:06,023 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:18:06,033 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:18:06,052 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:18:06,068 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:18:06,088 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:18:06,101 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:18:06,116 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:18:06,128 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:18:06,140 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:18:06,148 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:18:06,153 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:18:06,160 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:18:06,173 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:18:06,185 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:18:06,185 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:18:06,190 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:18:06,194 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:18:06,197 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:18:06,221 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:18:06,222 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:18:06,233 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:18:06,243 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:18:06,250 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:18:06,257 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:18:06,266 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:18:06,275 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:18:06,281 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:18:11,344 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:18:11,393 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:18:11,418 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:18:11,418 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:18:47,380 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:18:47,391 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:18:56,289 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:18:56,297 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:18:56,297 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "32f314c2-77ea-4f7f-af54-5fda0019ea16", "type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Learning Material Editor!", "type": "text", "styles": {}}], "children": [], "position": 0}, {"id": "bc682c40-b0b2-4ca9-a743-32c9c0c3b6a5", "type": "paragraph", "props": {}, "content": [{"text": "This is where you will create your learning material. You can either modify this template or remove it entirely to start from scratch.", "type": "text", "styles": {}}], "children": [], "position": 1}, {"id": "6bc60118-8a8d-4c1a-90f3-ddd8a91683a7", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 2}, {"id": "05260fc0-4a53-470b-bd48-5bef8c448bae", "type": "heading", "props": {"level": 3}, "content": [{"text": "Key Features", "type": "text", "styles": {}}], "children": [], "position": 3}, {"id": "f90129ad-4058-4981-8322-2fc69711a631", "type": "bulletListItem", "props": {}, "content": [{"text": "Add new blocks by clicking the + icon that appears between blocks", "type": "text", "styles": {}}], "children": [], "position": 4}, {"id": "ccfcbdb7-e222-49f0-bdde-1a6f49ed9485", "type": "bulletListItem", "props": {}, "content": [{"text": "Reorder blocks using the side menu (hover near the left edge of any block and drag the button with 6 dots to reorder)", "type": "text", "styles": {}}], "children": [], "position": 5}, {"id": "72290eb8-e4c5-40c2-8b92-37c15185773f", "type": "bulletListItem", "props": {}, "content": [{"text": "Format text using the toolbar that appears when you select text", "type": "text", "styles": {}}], "children": [], "position": 6}, {"id": "a2400984-a63f-4bfc-8f07-e2c3ed1d7296", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 7}, {"id": "385fd424-ed44-48f2-b8b2-017a3f6a7d07", "type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "children": [], "position": 8}, {"id": "9712f638-9034-4494-b8c0-aeac747aba2a", "type": "paragraph", "props": {}, "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "children": [], "position": 9}, {"id": "9ac20c9d-c63b-4104-98ad-3d70016af074", "type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "children": [], "position": 10}, {"id": "c2363a02-d347-4ce3-80cc-030468a745a9", "type": "bulletListItem", "props": {}, "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 11}, {"id": "af6e676f-d182-4874-b249-100bf9bb1aa1", "type": "numberedListItem", "props": {}, "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 12}, {"id": "9e558263-ce9a-4528-b128-9ceb96567978", "type": "checkListItem", "props": {}, "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 13}, {"id": "7b670081-9047-4eb0-b32b-32b26e74a9c7", "type": "paragraph", "props": {}, "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "children": [], "position": 14}, {"id": "4c075dce-dd29-48ca-b383-da54a32ede68", "type": "paragraph", "props": {}, "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "children": [], "position": 15}, {"id": "1afbf6b2-9a3f-4dd8-9ad0-57cc2880c8a6", "type": "paragraph", "props": {}, "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "children": [], "position": 16}, {"id": "4190ac4a-cdb9-43b4-bc4e-2c5a4841b9f7", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 17}, {"id": "26525fbe-19f4-4a34-8abb-d2cb90db0928", "type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "children": [], "position": 18}, {"id": "c2b4a83f-e8e4-4400-a693-f44cc8044a90", "type": "paragraph", "props": {}, "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "children": [], "position": 19}, {"id": "e7128b98-300b-4312-b1c4-599d384b2ba8", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "children": [], "position": 20}, {"id": "44fa26c3-f735-43e6-a6cf-58803258d7e3", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "children": [], "position": 21}, {"id": "8b41c9da-9b74-4b2c-8805-a6f3c1fa3af5", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 22}, {"id": "78e78645-6387-4fcf-afc7-d48361d3cab8", "type": "paragraph", "props": {}, "content": [{"text": "Here are examples of nested content:", "type": "text", "styles": {}}], "children": [], "position": 23}, {"id": "a6f575b2-a47b-42b2-afb9-e4a76677f645", "type": "paragraph", "props": {}, "content": [{"text": "Nested Lists Example", "type": "text", "styles": {"bold": true}}], "children": [], "position": 24}, {"id": "e8396a9e-56de-4509-9ec2-4cc7f789abed", "type": "bulletListItem", "props": {}, "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "position": 25}, {"id": "1f6b28b2-ffe1-483d-8d96-6333b9b1dd3f", "type": "bulletListItem", "props": {}, "content": [{"text": "Main topic 2", "type": "text", "styles": {}}], "children": [], "position": 26}, {"id": "11192b28-2dc7-42a7-8daf-2c075f195530", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 27}, {"id": "3c06d88e-cb0a-4f81-9c32-2263c808f872", "type": "paragraph", "props": {}, "content": [{"text": "Nested Numbered Lists", "type": "text", "styles": {"bold": true}}], "children": [], "position": 28}, {"id": "5678806b-1fa1-4da1-a853-50c7053f4d82", "type": "numberedListItem", "props": {}, "content": [{"text": "First step", "type": "text", "styles": {}}], "children": [{"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.1 (indented with Tab)", "type": "text", "styles": {}}]}, {"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.2", "type": "text", "styles": {}}]}], "position": 29}, {"id": "c7e4ada2-89c5-4c91-81ae-679321fee4c6", "type": "numberedListItem", "props": {}, "content": [{"text": "Second step", "type": "text", "styles": {}}], "children": [], "position": 30}, {"id": "6bedf17b-3388-4032-a585-5af407e916e3", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 31}, {"id": "a0ada26c-9cf2-4721-9b66-af8b03e24312", "type": "paragraph", "props": {}, "content": [{"text": "Tips for working with nested content:", "type": "text", "styles": {"bold": true}}], "children": [], "position": 32}, {"id": "04aee107-8601-40b4-9f19-45c908be18bd", "type": "bulletListItem", "props": {}, "content": [{"text": "To unnest/outdent an item, press Shift+Tab", "type": "text", "styles": {}}], "children": [], "position": 33}, {"id": "c0046819-b936-49fa-87f0-2a7b722c7521", "type": "bulletListItem", "props": {}, "content": [{"text": "You can mix bullet and numbered lists in your nesting hierarchy", "type": "text", "styles": {}}], "children": [], "position": 34}, {"id": "6d22a46c-466b-442e-9fc0-d03d61ecf6d8", "type": "bulletListItem", "props": {}, "content": [{"text": "Nesting helps create a clear organizational structure for complex topics", "type": "text", "styles": {}}], "children": [], "position": 35}, {"id": "581f99f8-4f1d-4b68-bc9a-fd8611f22501", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 36}, {"id": "16a7c28f-9c3e-4f1e-9b1e-3a3e763ef56d", "type": "heading", "props": {"level": 3}, "content": [{"text": "Publishing Your Content", "type": "text", "styles": {}}], "children": [], "position": 37}, {"id": "d8e4d5b5-2760-43a6-a735-d7277edd22d2", "type": "paragraph", "props": {}, "content": [{"text": "When you are ready to make your content available to learners, click the Publish button. You can always edit and republish your content later.", "type": "text", "styles": {}}], "children": [], "position": 38}, {"id": "47fd06ba-8668-449c-87bc-c701ef1246d3", "type": "paragraph", "props": {}, "content": [{"text": "Feel free to delete or modify this template to create your own learning material!", "type": "text", "styles": {}}], "children": [], "position": 39}]', status = 'published', title = 'New Learning Material', scheduled_publish_at = NULL WHERE id = 1
2025-05-16 09:18:56,298 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:18:56,315 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:18:56,318 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:18:56,352 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:18:56,358 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:18:56,366 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:18:56,372 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:18:58,649 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:18:58,657 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:18:58,667 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:18:58,676 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:19:03,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:19:03,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:49:03.880729+00:00'
        RETURNING id
        
2025-05-16 09:19:03,889 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:19:09,348 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:19:09,353 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:20:03,880 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:20:03,880 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:50:03.875206+00:00'
        RETURNING id
        
2025-05-16 09:20:03,882 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:21:03,890 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:21:03,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:51:03.875763+00:00'
        RETURNING id
        
2025-05-16 09:21:03,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:22:03,881 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:22:03,881 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:52:03.875127+00:00'
        RETURNING id
        
2025-05-16 09:22:03,882 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:23:03,888 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:23:03,890 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:53:03.879077+00:00'
        RETURNING id
        
2025-05-16 09:23:03,891 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:24:03,887 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:24:03,888 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:54:03.880396+00:00'
        RETURNING id
        
2025-05-16 09:24:03,889 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:24:06,943 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:24:06,952 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:24:08,277 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:24:08,283 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:24:14,585 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:24:14,591 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:24:26,577 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:24:26,582 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:25:03,881 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:25:03,881 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:55:03.877023+00:00'
        RETURNING id
        
2025-05-16 09:25:03,883 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:26:03,879 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:26:03,879 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:56:03.875305+00:00'
        RETURNING id
        
2025-05-16 09:26:03,880 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:26:25,618 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:26:25,624 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:26:28,272 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:26:28,278 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:26:50,581 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:26:50,585 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:26:54,261 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:26:54,265 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:27:03,885 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:27:03,885 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:57:03.881262+00:00'
        RETURNING id
        
2025-05-16 09:27:03,886 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:27:11,571 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:27:11,576 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:27:13,264 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:27:13,270 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:27:53,603 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:27:53,607 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:28:03,877 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:28:03,877 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:58:03.873592+00:00'
        RETURNING id
        
2025-05-16 09:28:03,877 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:28:04,384 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:28:04,389 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:28:26,579 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:28:26,583 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:28:31,266 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:28:31,270 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:28:33,258 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:28:33,263 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:28:34,255 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:28:34,259 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:28:42,561 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:28:42,565 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:28:47,559 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:28:47,563 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:28:52,265 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:28:52,269 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:28:56,570 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:28:56,575 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:29:01,264 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:29:01,269 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:29:03,877 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:29:03,877 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 03:59:03.874435+00:00'
        RETURNING id
        
2025-05-16 09:29:03,878 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:29:05,838 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:29:05,842 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:29:07,066 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:29:07,071 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:29:07,078 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:29:07,083 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:29:20,579 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:29:20,584 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:29:22,571 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:29:22,578 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:29:52,521 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 09:29:52,526 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 09:30:03,880 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:30:03,880 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:00:03.876959+00:00'
        RETURNING id
        
2025-05-16 09:30:03,881 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:31:03,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:31:03,886 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:01:03.880361+00:00'
        RETURNING id
        
2025-05-16 09:31:03,887 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:32:03,878 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:32:03,879 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:02:03.874875+00:00'
        RETURNING id
        
2025-05-16 09:32:03,879 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:33:03,885 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:33:03,885 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:03:03.881448+00:00'
        RETURNING id
        
2025-05-16 09:33:03,886 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:34:03,874 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:34:03,874 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:04:03.870370+00:00'
        RETURNING id
        
2025-05-16 09:34:03,875 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:34:41,870 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:41,877 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:41,892 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 09:34:41,896 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:41,899 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:34:41,900 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 09:34:41,901 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 09:34:41,901 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 09:34:49,781 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:49,788 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:49,817 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-16 09:34:49,833 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:49,845 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-16 09:34:49,856 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-16 09:34:49,869 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-16 09:34:49,885 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 09:34:49,896 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 09:34:49,908 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:34:49,920 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:34:49,946 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:53,919 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:53,927 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:53,939 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 09:34:53,944 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:34:53,948 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:34:53,949 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 09:34:53,950 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 09:34:53,950 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 09:35:03,875 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:35:03,875 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:05:03.871879+00:00'
        RETURNING id
        
2025-05-16 09:35:03,876 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:36:03,876 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:36:03,876 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:06:03.873323+00:00'
        RETURNING id
        
2025-05-16 09:36:03,877 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:37:03,884 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:37:03,885 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:07:03.881219+00:00'
        RETURNING id
        
2025-05-16 09:37:03,885 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:37:37,975 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:37:37,983 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:37:38,014 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:37:38,022 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:37:38,032 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:37:38,045 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:37:38,056 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:37:38,066 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:37:38,074 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:37:38,081 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:37:38,092 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:38:03,874 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:38:03,874 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:08:03.869718+00:00'
        RETURNING id
        
2025-05-16 09:38:03,875 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:39:03,871 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:39:03,871 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:09:03.868309+00:00'
        RETURNING id
        
2025-05-16 09:39:03,872 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:40:03,876 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:40:03,876 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:10:03.872245+00:00'
        RETURNING id
        
2025-05-16 09:40:03,877 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:41:03,878 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:41:03,878 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:11:03.874496+00:00'
        RETURNING id
        
2025-05-16 09:41:03,878 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:42:03,881 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:42:03,882 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:12:03.877938+00:00'
        RETURNING id
        
2025-05-16 09:42:03,882 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:43:03,885 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:43:03,885 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:13:03.879926+00:00'
        RETURNING id
        
2025-05-16 09:43:03,887 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:44:03,873 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:44:03,873 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:14:03.869825+00:00'
        RETURNING id
        
2025-05-16 09:44:03,874 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:45:03,879 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:45:03,879 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:15:03.875031+00:00'
        RETURNING id
        
2025-05-16 09:45:03,880 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:46:03,875 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:46:03,875 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:16:03.870622+00:00'
        RETURNING id
        
2025-05-16 09:46:03,875 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:47:03,878 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:47:03,878 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:17:03.873588+00:00'
        RETURNING id
        
2025-05-16 09:47:03,879 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:48:03,874 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:48:03,875 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:18:03.868952+00:00'
        RETURNING id
        
2025-05-16 09:48:03,875 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:49:03,875 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:49:03,875 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:19:03.871029+00:00'
        RETURNING id
        
2025-05-16 09:49:03,876 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:50:03,885 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:50:03,885 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:20:03.881475+00:00'
        RETURNING id
        
2025-05-16 09:50:03,885 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:51:03,881 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:51:03,881 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:21:03.877868+00:00'
        RETURNING id
        
2025-05-16 09:51:03,882 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:52:03,874 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:52:03,874 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:22:03.870157+00:00'
        RETURNING id
        
2025-05-16 09:52:03,874 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:52:34,448 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:52:34,469 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:52:34,520 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:52:34,537 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:52:34,545 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:52:34,554 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:52:34,573 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:52:34,583 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:52:34,594 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:52:34,604 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:52:34,617 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:53:03,884 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:53:03,884 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:23:03.879446+00:00'
        RETURNING id
        
2025-05-16 09:53:03,885 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:53:05,112 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:53:05,123 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:53:05,173 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:53:05,192 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:53:05,206 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:53:05,222 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:53:05,235 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:53:05,252 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:53:05,276 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:53:05,285 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:53:05,297 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:53:36,675 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:53:36,684 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:53:36,723 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:53:36,738 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:53:36,750 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:53:36,763 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:53:36,781 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:53:36,799 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:53:36,812 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:53:36,822 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:53:36,835 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:54:03,880 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:54:03,881 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:24:03.876721+00:00'
        RETURNING id
        
2025-05-16 09:54:03,881 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:54:06,164 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:54:06,173 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:54:06,211 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:54:06,235 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:54:06,245 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:54:06,259 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:54:06,272 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:54:06,289 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:54:06,299 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:54:06,309 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:54:06,320 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:54:10,010 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:54:10,021 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:54:10,063 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:54:10,077 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:54:10,089 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:54:10,108 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:54:10,122 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:54:10,133 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:54:10,150 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:54:10,171 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:54:10,190 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:54:10,202 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:54:10,218 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:54:10,235 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:54:10,254 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:54:10,262 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:54:10,268 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:54:10,280 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:54:10,289 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:54:10,295 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:54:10,305 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:54:10,311 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:54:10,326 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:54:10,333 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:54:10,341 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:54:10,348 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:54:10,356 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:54:10,364 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:54:10,374 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:54:10,383 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:54:10,391 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:54:10,397 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:54:10,403 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:54:10,409 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:55:03,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:55:03,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:25:03.881948+00:00'
        RETURNING id
        
2025-05-16 09:55:03,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:55:27,211 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:27,219 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:27,259 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:55:27,281 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:55:27,293 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:55:27,309 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:55:27,322 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:27,334 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:55:27,347 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:55:27,360 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:55:27,370 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:55:31,503 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:31,520 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:31,588 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:55:31,605 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:31,623 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:55:31,633 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:55:31,652 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:55:31,652 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:55:31,684 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:55:31,703 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:31,712 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:55:31,726 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:55:31,728 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:55:31,738 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:55:31,749 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:55:31,750 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:55:31,780 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:55:31,790 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:55:31,799 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:55:31,811 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:55:31,813 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:55:31,824 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:55:31,834 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:55:31,842 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:55:31,843 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:55:31,852 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:55:31,868 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:55:31,873 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:55:31,887 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:55:31,895 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:55:31,905 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:55:31,912 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:55:31,919 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:55:31,924 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:55:58,092 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:58,104 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:58,170 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:55:58,199 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:55:58,205 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:55:58,222 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:55:58,233 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:55:58,242 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:55:58,243 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:55:58,252 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:55:58,262 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:56:03,883 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:56:03,883 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:26:03.880624+00:00'
        RETURNING id
        
2025-05-16 09:56:03,884 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:56:13,465 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:56:13,478 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:56:13,557 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:56:13,561 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:56:13,591 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:56:13,594 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:56:13,626 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:56:13,626 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:56:13,639 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:56:13,648 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:56:13,656 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:56:58,313 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:56:58,323 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:56:58,367 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:56:58,377 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:56:58,386 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:56:58,398 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:56:58,412 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:56:58,425 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:56:58,434 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:56:58,440 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:56:58,452 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:56:59,910 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:56:59,921 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:56:59,980 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:56:59,980 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:57:00,027 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:57:00,037 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:57:00,051 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:57:00,061 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:57:00,066 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:57:00,079 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:57:00,082 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:57:00,082 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:57:00,104 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:57:00,117 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:57:00,137 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:57:00,138 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:57:00,161 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 09:57:00,166 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:57:00,177 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:57:00,189 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:57:00,199 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:57:00,213 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 09:57:00,241 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:57:00,241 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:57:00,260 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:57:00,265 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:57:00,284 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:57:00,289 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:57:00,305 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:57:00,364 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:57:00,365 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:57:00,368 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:57:00,370 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:57:00,438 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:57:00,454 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 09:57:00,455 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:57:00,512 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 09:57:00,512 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:57:00,537 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:57:00,559 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:57:00,564 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 09:57:00,582 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:57:00,587 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 09:57:00,624 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:57:00,628 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 09:57:03,874 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:57:03,874 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:27:03.870927+00:00'
        RETURNING id
        
2025-05-16 09:57:03,874 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:57:06,519 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:57:06,528 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:57:06,561 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:57:06,571 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:57:06,581 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:57:06,596 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:57:06,610 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 09:57:06,624 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 09:57:06,634 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 09:57:06,643 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 09:57:06,660 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 09:58:03,884 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:58:03,885 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:28:03.881168+00:00'
        RETURNING id
        
2025-05-16 09:58:03,885 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 09:59:03,876 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 09:59:03,876 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:29:03.873162+00:00'
        RETURNING id
        
2025-05-16 09:59:03,876 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:00:03,885 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:00:03,886 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:30:03.881218+00:00'
        RETURNING id
        
2025-05-16 10:00:03,886 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:01:03,878 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:01:03,878 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:31:03.874920+00:00'
        RETURNING id
        
2025-05-16 10:01:03,879 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:02:03,880 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:02:03,880 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:32:03.876913+00:00'
        RETURNING id
        
2025-05-16 10:02:03,880 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:03:03,877 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:03:03,878 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:33:03.874988+00:00'
        RETURNING id
        
2025-05-16 10:03:03,878 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:04:03,879 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:04:03,879 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:34:03.875520+00:00'
        RETURNING id
        
2025-05-16 10:04:03,879 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:05:03,882 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:05:03,882 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:35:03.878572+00:00'
        RETURNING id
        
2025-05-16 10:05:03,882 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:06:03,884 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:06:03,885 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:36:03.881455+00:00'
        RETURNING id
        
2025-05-16 10:06:03,885 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:07:03,879 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:07:03,880 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:37:03.876176+00:00'
        RETURNING id
        
2025-05-16 10:07:03,880 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:08:03,879 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:08:03,879 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:38:03.876235+00:00'
        RETURNING id
        
2025-05-16 10:08:03,880 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:09:03,889 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:09:03,889 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:39:03.880100+00:00'
        RETURNING id
        
2025-05-16 10:09:03,889 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:09:16,475 - api.utils.logging - INFO - Logging system initialized
2025-05-16 10:09:17,337 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 10:09:17,356 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 10:10:16,662 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:10:16,662 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:40:16.657709+00:00'
        RETURNING id
        
2025-05-16 10:10:16,662 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:10:22,370 - api.utils.logging - INFO - Logging system initialized
2025-05-16 10:10:28,594 - api.utils.logging - INFO - Logging system initialized
2025-05-16 10:10:34,727 - api.utils.logging - INFO - Logging system initialized
2025-05-16 10:10:41,096 - api.utils.logging - INFO - Logging system initialized
2025-05-16 10:10:41,513 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 10:10:41,520 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 10:11:41,237 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:11:41,237 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:41:41.233844+00:00'
        RETURNING id
        
2025-05-16 10:11:41,237 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:12:41,241 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:12:41,241 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:42:41.237068+00:00'
        RETURNING id
        
2025-05-16 10:12:41,242 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:13:41,239 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:13:41,239 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:43:41.235999+00:00'
        RETURNING id
        
2025-05-16 10:13:41,240 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:14:41,240 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:14:41,240 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:44:41.236706+00:00'
        RETURNING id
        
2025-05-16 10:14:41,241 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:15:41,240 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:15:41,240 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:45:41.236496+00:00'
        RETURNING id
        
2025-05-16 10:15:41,240 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:16:41,240 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:16:41,240 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:46:41.237102+00:00'
        RETURNING id
        
2025-05-16 10:16:41,240 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:17:41,229 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:17:41,229 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:47:41.225496+00:00'
        RETURNING id
        
2025-05-16 10:17:41,229 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:18:41,242 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:18:41,242 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:48:41.238276+00:00'
        RETURNING id
        
2025-05-16 10:18:41,242 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:19:41,236 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:19:41,236 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:49:41.232181+00:00'
        RETURNING id
        
2025-05-16 10:19:41,236 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:20:41,228 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:20:41,228 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:50:41.224927+00:00'
        RETURNING id
        
2025-05-16 10:20:41,229 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:21:41,233 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:21:41,233 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:51:41.228361+00:00'
        RETURNING id
        
2025-05-16 10:21:41,234 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:22:41,235 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:22:41,235 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:52:41.230182+00:00'
        RETURNING id
        
2025-05-16 10:22:41,236 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:23:41,240 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:23:41,240 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:53:41.235903+00:00'
        RETURNING id
        
2025-05-16 10:23:41,241 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:24:41,242 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:24:41,243 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:54:41.238244+00:00'
        RETURNING id
        
2025-05-16 10:24:41,244 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:25:41,232 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:25:41,232 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:55:41.228460+00:00'
        RETURNING id
        
2025-05-16 10:25:41,233 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:26:41,228 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:26:41,228 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:56:41.224350+00:00'
        RETURNING id
        
2025-05-16 10:26:41,228 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:27:41,239 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:27:41,239 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:57:41.235890+00:00'
        RETURNING id
        
2025-05-16 10:27:41,240 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:28:41,241 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:28:41,241 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:58:41.237467+00:00'
        RETURNING id
        
2025-05-16 10:28:41,241 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:29:41,241 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:29:41,241 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 04:59:41.228897+00:00'
        RETURNING id
        
2025-05-16 10:29:41,242 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:30:41,237 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:30:41,243 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:00:41.233111+00:00'
        RETURNING id
        
2025-05-16 10:30:41,244 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:31:41,247 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:31:41,248 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:01:41.243425+00:00'
        RETURNING id
        
2025-05-16 10:31:41,248 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:32:41,237 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:32:41,237 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:02:41.234073+00:00'
        RETURNING id
        
2025-05-16 10:32:41,238 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:33:41,250 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:33:41,253 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:03:41.236062+00:00'
        RETURNING id
        
2025-05-16 10:33:41,255 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:33:44,709 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:44,737 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:44,772 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:44,785 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:44,798 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:33:44,815 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:44,828 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:44,840 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:44,852 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:33:44,888 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:44,889 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:33:44,938 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:33:44,977 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:33:44,982 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:33:44,997 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:33:45,007 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:33:45,013 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:33:45,027 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:45,033 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:45,038 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:33:45,038 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:33:45,047 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:33:45,066 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:33:45,075 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:33:45,087 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:33:45,096 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:45,104 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:45,112 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:33:45,125 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:33:45,135 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:33:45,143 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:33:45,153 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:45,166 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:45,177 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:33:48,450 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:48,459 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:48,517 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:33:48,535 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:33:48,548 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:33:48,561 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:33:48,586 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:48,598 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:33:48,613 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:33:48,623 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:33:48,635 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:33:52,817 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:52,829 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:52,911 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:52,912 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:52,923 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:52,935 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:33:52,955 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:52,985 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:33:52,990 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:53,013 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:33:53,085 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:33:53,086 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:33:53,111 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:33:53,129 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:33:53,133 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:33:53,181 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:33:53,188 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:33:53,229 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:53,254 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:33:53,255 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:53,271 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:33:53,294 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:33:53,297 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:33:53,307 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:33:53,316 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:33:53,324 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:53,332 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:53,340 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:33:53,351 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:33:53,359 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:33:53,368 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:33:53,380 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:33:53,387 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:33:53,394 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:34:41,237 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:34:41,237 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:04:41.233726+00:00'
        RETURNING id
        
2025-05-16 10:34:41,238 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:35:41,243 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:35:41,243 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:05:41.238817+00:00'
        RETURNING id
        
2025-05-16 10:35:41,244 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:36:41,229 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:36:41,229 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:06:41.225686+00:00'
        RETURNING id
        
2025-05-16 10:36:41,230 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:37:41,233 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:37:41,233 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:07:41.227282+00:00'
        RETURNING id
        
2025-05-16 10:37:41,233 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:38:19,031 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:19,060 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:19,094 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:19,104 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:19,117 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:19,128 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:19,136 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:19,142 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:19,160 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:19,175 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:19,191 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:19,203 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:19,216 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:19,233 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:19,241 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:19,245 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:19,276 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:19,279 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:19,304 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:19,313 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:19,324 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:19,333 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:19,347 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:19,355 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:19,364 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:19,373 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:19,381 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:19,392 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:19,408 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:19,418 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:19,427 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:19,435 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:19,444 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:19,450 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:25,894 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:25,903 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:25,939 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:38:25,950 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:38:25,958 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:25,977 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:38:25,989 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:26,001 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:38:26,011 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:38:26,022 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:26,040 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:38:37,489 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:37,496 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:37,525 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:37,534 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:37,542 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:37,554 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:37,565 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:37,573 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:37,582 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:37,594 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:37,605 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:37,616 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:37,630 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:37,641 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:37,650 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:37,658 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:37,667 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:37,673 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:37,679 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:37,688 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:37,699 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:37,711 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:37,719 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:37,728 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:37,736 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:37,743 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:37,760 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:37,762 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:37,771 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:37,781 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:37,793 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:37,800 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:37,807 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:37,812 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:40,730 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:40,742 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:40,770 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:40,773 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:40,779 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:40,789 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:40,805 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:40,807 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:40,825 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:40,844 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:40,854 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:40,854 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:40,863 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:40,883 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:40,883 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:40,907 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:40,910 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:40,933 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:40,955 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:40,956 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:40,987 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:41,006 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:41,008 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:41,018 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:41,028 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:41,044 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:41,055 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:41,063 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:41,074 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:41,087 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:41,096 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:41,110 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:41,119 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:41,126 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:41,241 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:38:41,244 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:08:41.235884+00:00'
        RETURNING id
        
2025-05-16 10:38:41,246 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:38:42,304 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:42,319 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:42,362 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:42,392 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:42,396 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:42,418 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:42,438 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:42,485 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:42,490 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:42,526 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:42,528 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:42,533 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:42,555 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:42,575 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:42,587 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:42,631 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:42,631 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:42,679 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:42,679 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:42,709 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:42,711 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:42,742 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:42,767 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:42,788 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:42,799 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:42,812 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:42,820 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:42,829 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:42,843 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:42,856 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:42,877 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:42,896 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:42,907 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:42,917 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:43,593 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:43,605 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:43,640 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:43,642 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:43,659 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:43,666 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:43,677 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:43,682 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:43,684 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:43,695 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:43,719 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:43,720 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:43,722 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:43,743 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:43,762 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:43,764 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:43,779 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:43,784 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:43,788 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:43,790 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:43,800 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:43,821 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:43,832 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:43,839 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:43,845 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:43,851 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:43,857 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:43,863 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:43,870 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:43,876 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:43,881 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:43,888 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:43,895 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:43,901 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:45,430 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:45,445 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:45,487 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:45,490 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:45,516 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:45,529 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:45,545 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:45,556 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:45,568 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:45,583 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:45,583 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:45,594 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:45,618 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:45,633 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:45,642 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:45,645 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:45,645 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:38:45,649 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:45,656 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:45,667 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:45,678 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:45,680 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:38:45,693 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:45,702 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:45,711 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:45,720 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:45,730 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:45,741 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:45,758 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:38:45,772 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:38:45,785 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:45,792 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:38:45,803 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:38:45,809 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:38:49,446 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:49,454 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:49,484 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:38:49,495 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:38:49,505 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:49,519 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:38:49,531 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:38:49,542 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:38:49,551 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:38:49,564 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:38:49,584 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:39:41,235 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:39:41,236 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:09:41.231731+00:00'
        RETURNING id
        
2025-05-16 10:39:41,237 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:40:41,232 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:40:41,232 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:10:41.227509+00:00'
        RETURNING id
        
2025-05-16 10:40:41,234 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:41:31,041 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:41:31,059 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:41:31,097 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:41:31,106 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:41:31,117 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:41:31,131 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:41:31,143 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:41:31,154 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:41:31,161 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:41:31,171 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:41:31,186 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:41:35,806 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:41:35,819 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:41:35,857 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:41:35,869 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:41:35,871 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:41:35,887 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:41:35,911 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:41:35,911 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:41:35,932 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:41:35,936 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:41:35,939 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:41:35,955 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:41:35,987 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:41:35,988 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:41:36,000 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:41:36,000 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:41:36,012 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:41:36,029 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:41:36,043 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:41:36,057 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:41:36,067 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:41:36,082 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:41:36,099 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:41:36,110 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:41:36,123 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:41:36,134 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:41:36,144 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:41:36,152 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:41:36,165 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:41:36,174 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:41:36,182 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:41:36,193 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:41:36,201 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:41:36,208 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:41:41,235 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:41:41,236 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:11:41.231788+00:00'
        RETURNING id
        
2025-05-16 10:41:41,237 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:42:41,233 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:42:41,233 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:12:41.229228+00:00'
        RETURNING id
        
2025-05-16 10:42:41,234 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:42:50,336 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 10:42:50,346 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 10:43:11,923 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:43:11,934 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:43:15,538 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:43:15,553 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:43:18,658 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:43:18,659 - api.utils.logging - INFO - Executing operation: INSERT INTO course_cohorts (course_id, cohort_id) VALUES (3, 1)
2025-05-16 10:43:18,659 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:43:18,672 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 10:43:40,934 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:43:40,942 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-16 10:43:40,953 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-16 10:43:40,957 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-16 10:43:40,967 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-16 10:43:40,973 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:43:40,984 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:43:40,987 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:43:40,998 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:43:41,016 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:43:41,234 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:43:41,234 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:13:41.229634+00:00'
        RETURNING id
        
2025-05-16 10:43:41,234 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:43:42,778 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:43:42,786 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:43:42,787 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:43:42,804 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:43:42,813 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:43:42,816 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:43:42,818 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:43:42,827 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:43:42,831 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:43:42,831 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:43:42,841 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:43:42,844 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:43:42,847 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:43:42,852 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:43:42,857 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:43:42,875 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:43:42,878 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:43:42,878 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:43:42,882 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:43:42,888 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:43:42,897 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:43:42,904 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:43:42,908 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:43:42,910 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:43:42,916 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:43:42,923 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:43:42,931 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:43:42,938 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:43:42,944 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:43:42,950 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:43:42,958 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:43:42,965 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:43:45,926 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-16 10:43:45,936 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:43:45,938 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-16 10:43:45,953 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-16 10:43:45,962 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-16 10:43:45,977 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:43:45,986 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:43:45,993 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:43:46,002 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:43:46,018 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:04,363 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:04,374 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:04,434 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:44:04,442 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:44:04,454 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:44:04,465 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:04,476 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:44:04,486 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:44:04,494 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:44:04,517 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:44:04,531 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:04,543 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:44:04,555 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:44:04,566 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:44:04,575 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:44:04,583 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:44:04,593 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:44:04,602 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:44:04,610 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:44:04,620 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:44:04,629 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:44:04,633 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:44:04,635 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:44:04,643 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:44:04,648 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:44:04,657 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:44:04,665 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:44:04,672 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:44:04,682 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:44:04,688 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:44:04,695 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:44:04,702 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-16 10:44:04,709 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-16 10:44:04,716 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-16 10:44:15,027 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-16 10:44:15,036 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:15,040 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-16 10:44:15,054 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-16 10:44:15,063 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-16 10:44:15,069 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:44:15,078 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:44:15,084 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:44:15,092 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 10:44:15,108 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:41,236 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:44:41,237 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:14:41.227286+00:00'
        RETURNING id
        
2025-05-16 10:44:41,238 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:44:54,504 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 10:44:54,535 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:54,536 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 10:44:54,549 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:54,587 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:54,620 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 10:44:54,621 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:54,638 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:44:54,668 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:44:54,673 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 10:44:54,676 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:44:54,701 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 10:44:54,701 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:44:54,711 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:44:54,722 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:44:54,722 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 10:44:54,736 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 10:44:54,737 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:44:54,762 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:44:54,763 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:44:54,873 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 10:44:54,897 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 10:44:54,913 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 10:44:59,342 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:44:59,347 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:44:59,674 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:44:59,678 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:44:59,680 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:44:59,685 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:45:08,409 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:45:08,415 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:45:10,824 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:45:10,832 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:45:11,661 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:45:11,668 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:45:41,232 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:45:41,232 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:15:41.227655+00:00'
        RETURNING id
        
2025-05-16 10:45:41,233 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:46:41,231 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:46:41,231 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:16:41.227127+00:00'
        RETURNING id
        
2025-05-16 10:46:41,232 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:46:44,752 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:46:44,758 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:47:41,231 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:47:41,231 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:17:41.227774+00:00'
        RETURNING id
        
2025-05-16 10:47:41,231 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:48:41,240 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:48:41,240 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:18:41.236513+00:00'
        RETURNING id
        
2025-05-16 10:48:41,241 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:49:41,239 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:49:41,239 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:19:41.236006+00:00'
        RETURNING id
        
2025-05-16 10:49:41,239 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:50:41,233 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:50:41,233 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:20:41.228528+00:00'
        RETURNING id
        
2025-05-16 10:50:41,233 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:51:41,232 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:51:41,232 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:21:41.227289+00:00'
        RETURNING id
        
2025-05-16 10:51:41,233 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:52:41,242 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:52:41,242 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:22:41.238696+00:00'
        RETURNING id
        
2025-05-16 10:52:41,242 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:53:41,249 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:53:41,249 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:23:41.238824+00:00'
        RETURNING id
        
2025-05-16 10:53:41,249 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:53:51,274 - api.utils.logging - INFO - Logging system initialized
2025-05-16 10:53:51,825 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 10:53:51,841 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:53:51,844 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:53:52,490 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 10:54:51,457 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:54:51,458 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:24:51.453915+00:00'
        RETURNING id
        
2025-05-16 10:54:51,458 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:57:45,360 - api.utils.logging - INFO - Logging system initialized
2025-05-16 10:57:45,885 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 10:57:45,893 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 10:58:00,482 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:58:00,488 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:58:45,548 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:58:45,548 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:28:45.535317+00:00'
        RETURNING id
        
2025-05-16 10:58:45,550 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:58:51,943 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:58:51,951 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 10:58:51,951 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:58:51,966 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 10:58:51,992 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 10:58:51,995 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:58:52,009 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:58:52,032 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 10:58:52,038 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 10:58:52,042 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:58:52,043 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 10:58:52,052 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 10:58:52,060 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:58:52,067 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:58:52,075 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:58:52,083 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:58:52,092 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:58:52,101 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:58:52,164 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 10:58:52,164 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 10:58:52,188 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 10:58:53,633 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:58:53,638 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:58:53,966 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:58:53,969 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:58:53,977 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:58:53,982 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:59:03,315 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:59:03,320 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:59:20,186 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 10:59:20,186 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:59:20,240 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:59:20,248 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 10:59:20,267 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 10:59:20,288 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:59:20,303 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:59:20,328 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:59:20,331 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 10:59:20,353 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:59:20,355 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 10:59:20,371 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:59:20,373 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 10:59:20,391 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:59:20,392 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 10:59:20,409 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:59:20,418 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:59:20,426 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:59:20,480 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 10:59:20,495 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 10:59:20,506 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 10:59:21,682 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:59:21,688 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:59:22,015 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:59:22,018 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:59:22,027 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 10:59:22,035 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 10:59:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 10:59:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:29:45.535876+00:00'
        RETURNING id
        
2025-05-16 10:59:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 10:59:46,121 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:59:46,129 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 10:59:46,131 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:59:46,152 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 10:59:46,157 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 10:59:46,192 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 10:59:46,193 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 10:59:46,219 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 10:59:46,219 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 10:59:46,229 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 10:59:46,234 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 10:59:46,239 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 10:59:46,257 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 10:59:46,282 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 10:59:46,292 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:59:46,300 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 10:59:46,307 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 10:59:46,314 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 10:59:46,360 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 10:59:46,367 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 10:59:46,376 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 11:00:39,537 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:00:39,544 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:00:39,573 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:00:39,579 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 11:00:39,601 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:00:39,626 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:00:39,632 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 11:00:39,667 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 11:00:39,667 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 11:00:39,673 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 11:00:39,686 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 11:00:39,696 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 11:00:39,696 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 11:00:39,703 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:00:39,704 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 11:00:39,711 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 11:00:39,719 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 11:00:39,734 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:00:39,788 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 11:00:39,789 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 11:00:39,800 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 11:00:45,188 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:00:45,193 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:00:45,521 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:00:45,525 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:00:45,529 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:00:45,529 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:30:45.526669+00:00'
        RETURNING id
        
2025-05-16 11:00:45,529 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:00:45,537 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:00:45,543 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:00:54,349 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:00:54,354 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:01:45,531 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:01:45,532 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:31:45.527749+00:00'
        RETURNING id
        
2025-05-16 11:01:45,532 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:02:45,534 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:02:45,534 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:32:45.529973+00:00'
        RETURNING id
        
2025-05-16 11:02:45,534 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:03:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:03:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:33:45.539189+00:00'
        RETURNING id
        
2025-05-16 11:03:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:04:45,531 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:04:45,532 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:34:45.528071+00:00'
        RETURNING id
        
2025-05-16 11:04:45,532 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:05:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:05:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:35:45.539222+00:00'
        RETURNING id
        
2025-05-16 11:05:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:06:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:06:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:36:45.535814+00:00'
        RETURNING id
        
2025-05-16 11:06:45,540 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:07:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:07:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:37:45.537530+00:00'
        RETURNING id
        
2025-05-16 11:07:45,542 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:08:45,546 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:08:45,547 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:38:45.541903+00:00'
        RETURNING id
        
2025-05-16 11:08:45,547 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:09:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:09:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:39:45.538016+00:00'
        RETURNING id
        
2025-05-16 11:09:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:10:45,552 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:10:45,552 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:40:45.548428+00:00'
        RETURNING id
        
2025-05-16 11:10:45,553 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:11:45,555 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:11:45,555 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:41:45.550988+00:00'
        RETURNING id
        
2025-05-16 11:11:45,555 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:12:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:12:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:42:45.539624+00:00'
        RETURNING id
        
2025-05-16 11:12:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:13:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:13:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:43:45.540438+00:00'
        RETURNING id
        
2025-05-16 11:13:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:14:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:14:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:44:45.536405+00:00'
        RETURNING id
        
2025-05-16 11:14:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:15:45,533 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:15:45,533 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:45:45.529270+00:00'
        RETURNING id
        
2025-05-16 11:15:45,534 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:16:45,538 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:16:45,538 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:46:45.533965+00:00'
        RETURNING id
        
2025-05-16 11:16:45,539 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:17:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:17:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:47:45.540078+00:00'
        RETURNING id
        
2025-05-16 11:17:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:18:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:18:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:48:45.536580+00:00'
        RETURNING id
        
2025-05-16 11:18:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:19:45,539 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:19:45,539 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:49:45.534916+00:00'
        RETURNING id
        
2025-05-16 11:19:45,539 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:20:45,533 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:20:45,533 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:50:45.528488+00:00'
        RETURNING id
        
2025-05-16 11:20:45,533 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:21:45,552 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:21:45,552 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:51:45.549096+00:00'
        RETURNING id
        
2025-05-16 11:21:45,553 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:22:28,632 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:22:28,633 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:22:28,666 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:22:28,669 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 11:22:28,683 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:22:28,700 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:22:28,715 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 11:22:28,737 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 11:22:28,737 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 11:22:28,755 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 11:22:28,768 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 11:22:28,778 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 11:22:28,790 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 11:22:28,797 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 11:22:28,806 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:22:28,813 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 11:22:28,819 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 11:22:28,824 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:22:28,886 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 11:22:28,894 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 11:22:28,898 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 11:22:38,249 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:22:38,254 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:22:38,586 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:22:38,598 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:22:38,599 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:22:38,609 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:22:45,546 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:22:45,546 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:52:45.542262+00:00'
        RETURNING id
        
2025-05-16 11:22:45,547 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:23:21,141 - api.utils.logging - INFO - Executing operation: 
            SELECT id FROM task_completions
            WHERE user_id = 1 AND task_id = 1
            
2025-05-16 11:23:21,142 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:23:21,142 - api.utils.logging - INFO - Executing operation: 
            INSERT INTO task_completions (user_id, task_id)
            VALUES (1, 1)
            
2025-05-16 11:23:21,145 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:23:21,684 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 11:23:21,715 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 11:23:33,708 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:23:33,715 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:23:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:23:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:53:45.539266+00:00'
        RETURNING id
        
2025-05-16 11:23:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:24:45,536 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:24:45,536 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:54:45.531769+00:00'
        RETURNING id
        
2025-05-16 11:24:45,536 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:25:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:25:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:55:45.540741+00:00'
        RETURNING id
        
2025-05-16 11:25:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:26:45,548 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:26:45,549 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:56:45.541344+00:00'
        RETURNING id
        
2025-05-16 11:26:45,550 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:26:54,318 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:26:54,319 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:26:54,368 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:26:54,445 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 11:26:54,446 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:26:54,483 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:26:54,483 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 11:26:54,542 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 11:26:54,542 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 11:26:54,555 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 11:26:54,562 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 11:26:54,595 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 11:26:54,601 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 11:26:54,624 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:26:54,628 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 11:26:54,641 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 11:26:54,665 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 11:26:54,684 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:26:54,770 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 11:26:54,779 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 11:26:54,800 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 11:26:57,585 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:26:57,600 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:26:57,600 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:26:57,645 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 11:26:57,659 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:26:57,705 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 11:26:57,753 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:26:57,791 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 11:26:57,796 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 11:26:57,797 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 11:26:57,807 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 11:26:57,815 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 11:26:57,816 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 11:26:57,828 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 11:26:57,829 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:26:57,839 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 11:26:57,851 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 11:26:57,865 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:26:57,966 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 11:26:57,966 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 11:26:57,983 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 11:27:45,539 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:27:45,539 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:57:45.535227+00:00'
        RETURNING id
        
2025-05-16 11:27:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:28:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:28:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:58:45.540087+00:00'
        RETURNING id
        
2025-05-16 11:28:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:29:45,539 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:29:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 05:59:45.534107+00:00'
        RETURNING id
        
2025-05-16 11:29:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:29:49,001 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:29:49,006 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:29:49,354 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:29:49,357 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:29:49,370 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:29:49,375 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:30:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:30:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:00:45.538476+00:00'
        RETURNING id
        
2025-05-16 11:30:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:31:45,541 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:31:45,541 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:01:45.535979+00:00'
        RETURNING id
        
2025-05-16 11:31:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:32:45,546 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:32:45,546 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:02:45.540361+00:00'
        RETURNING id
        
2025-05-16 11:32:45,548 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:33:45,533 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:33:45,534 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:03:45.530306+00:00'
        RETURNING id
        
2025-05-16 11:33:45,534 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:34:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:34:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:04:45.537982+00:00'
        RETURNING id
        
2025-05-16 11:34:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:35:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:35:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:05:45.540049+00:00'
        RETURNING id
        
2025-05-16 11:35:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:36:45,534 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:36:45,534 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:06:45.529220+00:00'
        RETURNING id
        
2025-05-16 11:36:45,535 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:37:00,800 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:37:00,822 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:37:00,836 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:37:00,845 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 11:37:00,877 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:37:00,901 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:37:00,936 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 11:37:00,964 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 11:37:00,986 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 11:37:00,989 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 11:37:01,008 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 11:37:01,011 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 11:37:01,017 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 11:37:01,023 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:37:01,031 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 11:37:01,037 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 11:37:01,048 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 11:37:01,058 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:37:01,142 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 11:37:01,151 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 11:37:01,168 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 11:37:02,354 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:37:02,359 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:37:02,368 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:37:02,389 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-16 11:37:02,402 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-16 11:37:02,455 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 11:37:02,837 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-16 11:37:02,855 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-16 11:37:02,862 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 11:37:02,870 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 11:37:02,878 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:37:02,886 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 11:37:02,894 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 11:37:02,903 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 11:37:02,917 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-16 11:37:02,925 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-16 11:37:02,932 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-16 11:37:02,939 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-16 11:37:02,951 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-16 11:37:02,962 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-16 11:37:02,971 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-16 11:37:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:37:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:07:45.538404+00:00'
        RETURNING id
        
2025-05-16 11:37:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:38:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:38:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:08:45.538028+00:00'
        RETURNING id
        
2025-05-16 11:38:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:39:45,545 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:39:45,545 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:09:45.541216+00:00'
        RETURNING id
        
2025-05-16 11:39:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:40:45,546 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:40:45,546 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:10:45.541608+00:00'
        RETURNING id
        
2025-05-16 11:40:45,547 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:41:45,535 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:41:45,536 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:11:45.527583+00:00'
        RETURNING id
        
2025-05-16 11:41:45,537 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:42:45,533 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:42:45,534 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:12:45.528735+00:00'
        RETURNING id
        
2025-05-16 11:42:45,534 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:43:45,537 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:43:45,538 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:13:45.534176+00:00'
        RETURNING id
        
2025-05-16 11:43:45,538 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:44:45,533 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:44:45,534 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:14:45.529260+00:00'
        RETURNING id
        
2025-05-16 11:44:45,534 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:45:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:45:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:15:45.536245+00:00'
        RETURNING id
        
2025-05-16 11:45:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:46:45,534 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:46:45,534 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:16:45.530629+00:00'
        RETURNING id
        
2025-05-16 11:46:45,535 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:46:47,554 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:46:47,561 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:46:47,919 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:46:47,936 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:46:47,938 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:46:47,948 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:47:45,539 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:47:45,539 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:17:45.533517+00:00'
        RETURNING id
        
2025-05-16 11:47:45,539 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:48:45,536 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:48:45,537 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:18:45.531903+00:00'
        RETURNING id
        
2025-05-16 11:48:45,537 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:49:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:49:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:19:45.536167+00:00'
        RETURNING id
        
2025-05-16 11:49:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:50:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:50:45,541 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:20:45.536712+00:00'
        RETURNING id
        
2025-05-16 11:50:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:51:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:51:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:21:45.536261+00:00'
        RETURNING id
        
2025-05-16 11:51:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:52:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:52:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:22:45.534089+00:00'
        RETURNING id
        
2025-05-16 11:52:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:53:43,691 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:53:43,697 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:53:45,213 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:53:45,223 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:53:45,239 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 11:53:45,250 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 11:53:45,548 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:53:45,548 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:23:45.540878+00:00'
        RETURNING id
        
2025-05-16 11:53:45,549 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:54:45,537 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:54:45,538 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:24:45.533848+00:00'
        RETURNING id
        
2025-05-16 11:54:45,538 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:55:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:55:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:25:45.535958+00:00'
        RETURNING id
        
2025-05-16 11:55:45,542 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:56:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:56:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:26:45.539490+00:00'
        RETURNING id
        
2025-05-16 11:56:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:57:45,531 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:57:45,532 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:27:45.527766+00:00'
        RETURNING id
        
2025-05-16 11:57:45,532 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:58:45,534 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:58:45,535 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:28:45.529237+00:00'
        RETURNING id
        
2025-05-16 11:58:45,535 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 11:59:45,539 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 11:59:45,539 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:29:45.535235+00:00'
        RETURNING id
        
2025-05-16 11:59:45,540 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:00:45,533 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:00:45,533 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:30:45.528901+00:00'
        RETURNING id
        
2025-05-16 12:00:45,533 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:01:45,531 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:01:45,531 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:31:45.526961+00:00'
        RETURNING id
        
2025-05-16 12:01:45,531 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:02:45,531 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:02:45,532 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:32:45.527959+00:00'
        RETURNING id
        
2025-05-16 12:02:45,532 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:03:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:03:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:33:45.529551+00:00'
        RETURNING id
        
2025-05-16 12:03:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:04:45,548 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:04:45,548 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:34:45.543980+00:00'
        RETURNING id
        
2025-05-16 12:04:45,548 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:05:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:05:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:35:45.540864+00:00'
        RETURNING id
        
2025-05-16 12:05:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:06:45,541 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:06:45,541 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:36:45.537508+00:00'
        RETURNING id
        
2025-05-16 12:06:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:07:45,541 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:07:45,541 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:37:45.534262+00:00'
        RETURNING id
        
2025-05-16 12:07:45,542 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:08:45,545 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:08:45,545 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:38:45.533394+00:00'
        RETURNING id
        
2025-05-16 12:08:45,546 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:09:45,546 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:09:45,546 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:39:45.533298+00:00'
        RETURNING id
        
2025-05-16 12:09:45,547 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:10:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:10:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:40:45.539663+00:00'
        RETURNING id
        
2025-05-16 12:10:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:11:45,536 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:11:45,536 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:41:45.532826+00:00'
        RETURNING id
        
2025-05-16 12:11:45,537 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:12:45,541 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:12:45,541 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:42:45.529378+00:00'
        RETURNING id
        
2025-05-16 12:12:45,542 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:13:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:13:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:43:45.534366+00:00'
        RETURNING id
        
2025-05-16 12:13:45,540 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:14:45,532 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:14:45,532 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:44:45.528229+00:00'
        RETURNING id
        
2025-05-16 12:14:45,532 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:15:45,541 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:15:45,541 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:45:45.537375+00:00'
        RETURNING id
        
2025-05-16 12:15:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:16:45,534 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:16:45,534 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:46:45.529680+00:00'
        RETURNING id
        
2025-05-16 12:16:45,534 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:17:45,538 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:17:45,538 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:47:45.534674+00:00'
        RETURNING id
        
2025-05-16 12:17:45,539 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:18:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:18:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:48:45.538609+00:00'
        RETURNING id
        
2025-05-16 12:18:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:19:45,536 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:19:45,536 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:49:45.532151+00:00'
        RETURNING id
        
2025-05-16 12:19:45,536 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:20:45,541 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:20:45,541 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:50:45.536484+00:00'
        RETURNING id
        
2025-05-16 12:20:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:21:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:21:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:51:45.538347+00:00'
        RETURNING id
        
2025-05-16 12:21:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:22:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:22:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:52:45.536506+00:00'
        RETURNING id
        
2025-05-16 12:22:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:23:45,545 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:23:45,546 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:53:45.541614+00:00'
        RETURNING id
        
2025-05-16 12:23:45,546 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:24:45,552 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:24:45,552 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:54:45.539785+00:00'
        RETURNING id
        
2025-05-16 12:24:45,552 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:25:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:25:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:55:45.536492+00:00'
        RETURNING id
        
2025-05-16 12:25:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:26:45,532 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:26:45,533 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:56:45.528559+00:00'
        RETURNING id
        
2025-05-16 12:26:45,533 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:27:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:27:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:57:45.538062+00:00'
        RETURNING id
        
2025-05-16 12:27:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:28:01,171 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 12:28:01,179 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 12:28:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:28:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:58:45.538628+00:00'
        RETURNING id
        
2025-05-16 12:28:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:29:45,548 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:29:45,549 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 06:59:45.542353+00:00'
        RETURNING id
        
2025-05-16 12:29:45,550 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:30:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:30:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:00:45.537381+00:00'
        RETURNING id
        
2025-05-16 12:30:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:31:45,536 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:31:45,537 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:01:45.530552+00:00'
        RETURNING id
        
2025-05-16 12:31:45,537 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:32:45,554 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:32:45,554 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:02:45.539549+00:00'
        RETURNING id
        
2025-05-16 12:32:45,555 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:33:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:33:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:03:45.537733+00:00'
        RETURNING id
        
2025-05-16 12:33:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:34:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:34:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:04:45.534370+00:00'
        RETURNING id
        
2025-05-16 12:34:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:35:45,544 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:35:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:05:45.538558+00:00'
        RETURNING id
        
2025-05-16 12:35:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:36:45,539 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:36:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:06:45.533907+00:00'
        RETURNING id
        
2025-05-16 12:36:45,540 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:37:45,545 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:37:45,545 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:07:45.540357+00:00'
        RETURNING id
        
2025-05-16 12:37:45,546 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:38:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:38:45,540 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:08:45.533754+00:00'
        RETURNING id
        
2025-05-16 12:38:45,541 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:39:45,546 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:39:45,546 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:09:45.540458+00:00'
        RETURNING id
        
2025-05-16 12:39:45,547 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:40:45,536 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:40:45,536 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:10:45.530420+00:00'
        RETURNING id
        
2025-05-16 12:40:45,537 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:41:45,541 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:41:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:11:45.535832+00:00'
        RETURNING id
        
2025-05-16 12:41:45,542 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:42:45,551 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:42:45,551 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:12:45.534918+00:00'
        RETURNING id
        
2025-05-16 12:42:45,552 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:43:45,535 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:43:45,535 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:13:45.529918+00:00'
        RETURNING id
        
2025-05-16 12:43:45,536 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:44:45,533 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:44:45,533 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:14:45.527520+00:00'
        RETURNING id
        
2025-05-16 12:44:45,534 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:45:45,539 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:45:45,539 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:15:45.531405+00:00'
        RETURNING id
        
2025-05-16 12:45:45,540 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:46:45,545 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:46:45,545 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:16:45.539842+00:00'
        RETURNING id
        
2025-05-16 12:46:45,546 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:47:45,541 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:47:45,541 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:17:45.536177+00:00'
        RETURNING id
        
2025-05-16 12:47:45,542 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:48:45,538 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:48:45,538 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:18:45.533095+00:00'
        RETURNING id
        
2025-05-16 12:48:45,539 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:49:45,535 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:49:45,535 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:19:45.529768+00:00'
        RETURNING id
        
2025-05-16 12:49:45,536 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:50:45,546 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:50:45,546 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:20:45.540852+00:00'
        RETURNING id
        
2025-05-16 12:50:45,547 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:51:45,536 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:51:45,536 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:21:45.531009+00:00'
        RETURNING id
        
2025-05-16 12:51:45,537 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:57:45,594 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:57:45,597 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:27:45.543470+00:00'
        RETURNING id
        
2025-05-16 12:57:45,600 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:58:45,552 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:58:45,553 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:28:45.541178+00:00'
        RETURNING id
        
2025-05-16 12:58:45,555 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 12:59:45,550 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 12:59:45,550 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:29:45.534829+00:00'
        RETURNING id
        
2025-05-16 12:59:45,552 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:00:45,537 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:00:45,537 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:30:45.528898+00:00'
        RETURNING id
        
2025-05-16 13:00:45,538 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:01:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:01:45,543 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:31:45.533985+00:00'
        RETURNING id
        
2025-05-16 13:01:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:02:45,549 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:02:45,550 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:32:45.541542+00:00'
        RETURNING id
        
2025-05-16 13:02:45,550 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:03:45,534 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:03:45,535 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:33:45.528966+00:00'
        RETURNING id
        
2025-05-16 13:03:45,535 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:04:45,549 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:04:45,549 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:34:45.543656+00:00'
        RETURNING id
        
2025-05-16 13:04:45,550 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:05:45,550 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:05:45,550 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:35:45.535363+00:00'
        RETURNING id
        
2025-05-16 13:05:45,551 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:06:45,549 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:06:45,549 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:36:45.534323+00:00'
        RETURNING id
        
2025-05-16 13:06:45,549 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:07:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:07:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:37:45.538510+00:00'
        RETURNING id
        
2025-05-16 13:07:45,544 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:08:45,548 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:08:45,549 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:38:45.540053+00:00'
        RETURNING id
        
2025-05-16 13:08:45,551 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:09:45,553 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:09:45,554 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:39:45.537812+00:00'
        RETURNING id
        
2025-05-16 13:09:45,556 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:10:45,543 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:10:45,544 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:40:45.536324+00:00'
        RETURNING id
        
2025-05-16 13:10:45,545 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:11:45,540 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:11:45,541 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:41:45.532758+00:00'
        RETURNING id
        
2025-05-16 13:11:45,542 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:12:45,545 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:12:45,545 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:42:45.537434+00:00'
        RETURNING id
        
2025-05-16 13:12:45,546 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 13:13:45,542 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 13:13:45,542 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 07:43:45.527135+00:00'
        RETURNING id
        
2025-05-16 13:13:45,543 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 14:55:33,429 - api.utils.logging - INFO - Logging system initialized
2025-05-16 14:55:34,026 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 14:55:34,036 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 14:55:53,668 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 14:55:53,675 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 14:55:53,680 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 14:55:53,684 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 14:55:53,688 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 14:55:53,689 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 14:55:53,690 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 14:55:53,690 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 14:56:13,189 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 14:56:13,197 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 14:56:13,246 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 14:56:13,264 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 14:56:13,279 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 14:56:13,300 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 14:56:13,311 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 14:56:13,321 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 14:56:13,328 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 14:56:13,335 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 14:56:13,346 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 14:56:21,257 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 14:56:21,273 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 14:56:21,275 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 14:56:21,287 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 14:56:33,624 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 14:56:33,626 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:26:33.619528+00:00'
        RETURNING id
        
2025-05-16 14:56:33,628 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 14:56:45,725 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 14:56:45,737 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 14:56:45,739 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 14:56:45,741 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 14:56:45,756 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 14:56:45,757 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 14:56:46,470 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 14:56:46,481 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 14:56:51,580 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 14:56:51,585 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 14:56:51,905 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 14:56:51,908 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 14:56:51,912 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 14:56:51,918 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 14:57:13,884 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 14:57:13,890 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 14:57:33,614 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 14:57:33,614 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:27:33.610682+00:00'
        RETURNING id
        
2025-05-16 14:57:33,616 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 14:58:33,608 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 14:58:33,608 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:28:33.605198+00:00'
        RETURNING id
        
2025-05-16 14:58:33,610 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 14:59:33,615 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 14:59:33,616 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:29:33.612309+00:00'
        RETURNING id
        
2025-05-16 14:59:33,616 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:00:33,621 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:00:33,621 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:30:33.617298+00:00'
        RETURNING id
        
2025-05-16 15:00:33,621 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:01:33,611 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:01:33,611 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:31:33.607112+00:00'
        RETURNING id
        
2025-05-16 15:01:33,611 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:02:33,618 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:02:33,618 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:32:33.613578+00:00'
        RETURNING id
        
2025-05-16 15:02:33,618 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:03:28,932 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 15:03:28,936 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 15:03:33,609 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:03:33,609 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:33:33.605625+00:00'
        RETURNING id
        
2025-05-16 15:03:33,610 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:04:33,611 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:04:33,611 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:34:33.608199+00:00'
        RETURNING id
        
2025-05-16 15:04:33,612 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:05:03,762 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 15:05:03,768 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 15:05:24,919 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 15:05:24,925 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 15:05:33,609 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:05:33,609 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:35:33.605492+00:00'
        RETURNING id
        
2025-05-16 15:05:33,610 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:06:33,610 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:06:33,611 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:36:33.606880+00:00'
        RETURNING id
        
2025-05-16 15:06:33,611 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:07:33,619 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:07:33,619 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:37:33.614652+00:00'
        RETURNING id
        
2025-05-16 15:07:33,619 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:08:33,609 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:08:33,610 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:38:33.605929+00:00'
        RETURNING id
        
2025-05-16 15:08:33,610 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:09:33,611 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:09:33,612 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:39:33.607972+00:00'
        RETURNING id
        
2025-05-16 15:09:33,612 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:10:33,610 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:10:33,610 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:40:33.607128+00:00'
        RETURNING id
        
2025-05-16 15:10:33,611 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:11:33,611 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:11:33,611 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:41:33.607853+00:00'
        RETURNING id
        
2025-05-16 15:11:33,612 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:12:33,614 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:12:33,614 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:42:33.609825+00:00'
        RETURNING id
        
2025-05-16 15:12:33,615 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:13:33,612 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:13:33,612 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:43:33.608449+00:00'
        RETURNING id
        
2025-05-16 15:13:33,613 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:14:33,617 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:14:33,617 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:44:33.612656+00:00'
        RETURNING id
        
2025-05-16 15:14:33,617 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:15:33,616 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:15:33,617 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:45:33.612960+00:00'
        RETURNING id
        
2025-05-16 15:15:33,617 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:16:33,609 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:16:33,610 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:46:33.605549+00:00'
        RETURNING id
        
2025-05-16 15:16:33,610 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:17:33,619 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:17:33,619 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:47:33.615705+00:00'
        RETURNING id
        
2025-05-16 15:17:33,620 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:18:33,620 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:18:33,620 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:48:33.616914+00:00'
        RETURNING id
        
2025-05-16 15:18:33,621 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:19:33,619 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:19:33,619 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:49:33.616265+00:00'
        RETURNING id
        
2025-05-16 15:19:33,620 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:20:33,611 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:20:33,611 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:50:33.607743+00:00'
        RETURNING id
        
2025-05-16 15:20:33,611 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:21:33,611 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:21:33,612 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:51:33.606693+00:00'
        RETURNING id
        
2025-05-16 15:21:33,612 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:22:14,473 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-16 15:22:14,497 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-16 15:22:14,512 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-16 15:22:14,521 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-16 15:22:14,542 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-16 15:22:14,549 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-16 15:22:23,604 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-16 15:22:23,613 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-16 15:22:23,623 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-16 15:22:23,632 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-16 15:22:23,642 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-16 15:22:23,650 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-16 15:22:33,620 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:22:33,620 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:52:33.615544+00:00'
        RETURNING id
        
2025-05-16 15:22:33,620 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:23:33,618 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:23:33,618 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:53:33.614606+00:00'
        RETURNING id
        
2025-05-16 15:23:33,619 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:24:33,616 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:24:33,617 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:54:33.612792+00:00'
        RETURNING id
        
2025-05-16 15:24:33,617 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:25:33,619 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:25:33,619 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:55:33.615069+00:00'
        RETURNING id
        
2025-05-16 15:25:33,620 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:26:33,626 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:26:33,626 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:56:33.621921+00:00'
        RETURNING id
        
2025-05-16 15:26:33,626 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:27:33,619 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:27:33,620 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:57:33.615494+00:00'
        RETURNING id
        
2025-05-16 15:27:33,620 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:28:33,624 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:28:33,625 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:58:33.620530+00:00'
        RETURNING id
        
2025-05-16 15:28:33,625 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:29:33,623 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:29:33,624 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 09:59:33.617357+00:00'
        RETURNING id
        
2025-05-16 15:29:33,625 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:30:33,620 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:30:33,621 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:00:33.614844+00:00'
        RETURNING id
        
2025-05-16 15:30:33,621 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:31:33,616 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:31:33,616 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:01:33.610602+00:00'
        RETURNING id
        
2025-05-16 15:31:33,617 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:32:33,632 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:32:33,633 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:02:33.626787+00:00'
        RETURNING id
        
2025-05-16 15:32:33,634 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:33:33,609 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:33:33,618 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:03:33.604731+00:00'
        RETURNING id
        
2025-05-16 15:33:33,618 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:34:33,613 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:34:33,613 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:04:33.607032+00:00'
        RETURNING id
        
2025-05-16 15:34:33,614 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:35:33,655 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:35:33,655 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:05:33.626631+00:00'
        RETURNING id
        
2025-05-16 15:35:33,656 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:36:32,031 - api.utils.logging - INFO - Logging system initialized
2025-05-16 15:36:40,413 - api.utils.logging - INFO - Logging system initialized
2025-05-16 15:36:49,356 - api.utils.logging - INFO - Logging system initialized
2025-05-16 15:36:57,578 - api.utils.logging - INFO - Logging system initialized
2025-05-16 15:36:58,147 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 15:36:58,147 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 15:37:57,776 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:37:57,776 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:07:57.765853+00:00'
        RETURNING id
        
2025-05-16 15:37:57,778 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:38:07,125 - api.utils.logging - INFO - Logging system initialized
2025-05-16 15:38:15,710 - api.utils.logging - INFO - Logging system initialized
2025-05-16 15:38:23,787 - api.utils.logging - INFO - Logging system initialized
2025-05-16 15:38:32,050 - api.utils.logging - INFO - Logging system initialized
2025-05-16 15:38:32,599 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 15:38:32,613 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 15:38:58,162 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 15:38:58,170 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 15:38:58,176 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 15:38:58,212 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 15:38:58,213 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 15:38:58,227 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 15:39:10,672 - api.utils.logging - INFO - Logging system initialized
2025-05-16 15:39:11,561 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 15:39:11,562 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 15:39:11,573 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 15:39:11,575 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 15:40:11,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:40:11,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:10:10.987953+00:00'
        RETURNING id
        
2025-05-16 15:40:11,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:40:57,999 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 15:40:58,007 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 15:40:58,400 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 15:40:58,402 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 15:40:58,409 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 15:40:58,410 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 15:41:10,997 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:41:10,997 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:11:10.991246+00:00'
        RETURNING id
        
2025-05-16 15:41:10,998 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:41:19,081 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 15:41:19,090 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 15:41:44,655 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 15:41:44,664 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 15:42:10,985 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:42:10,985 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:12:10.978461+00:00'
        RETURNING id
        
2025-05-16 15:42:10,987 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:43:11,006 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:43:11,007 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:13:10.991907+00:00'
        RETURNING id
        
2025-05-16 15:43:11,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:44:10,990 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:44:10,990 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:14:10.984342+00:00'
        RETURNING id
        
2025-05-16 15:44:10,991 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:45:10,997 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:45:10,997 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:15:10.991410+00:00'
        RETURNING id
        
2025-05-16 15:45:10,998 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:46:10,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:46:10,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:16:10.981023+00:00'
        RETURNING id
        
2025-05-16 15:46:10,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:47:10,985 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:47:10,985 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:17:10.978810+00:00'
        RETURNING id
        
2025-05-16 15:47:10,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:48:11,000 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:48:11,000 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:18:10.994660+00:00'
        RETURNING id
        
2025-05-16 15:48:11,002 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:49:10,997 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:49:10,997 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:19:10.991155+00:00'
        RETURNING id
        
2025-05-16 15:49:10,998 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:50:11,008 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:50:11,008 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:20:10.992919+00:00'
        RETURNING id
        
2025-05-16 15:50:11,009 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:51:10,996 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:51:10,997 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:21:10.990329+00:00'
        RETURNING id
        
2025-05-16 15:51:10,997 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:52:10,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:52:10,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:22:10.982662+00:00'
        RETURNING id
        
2025-05-16 15:52:10,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:53:10,983 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:53:10,983 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:23:10.979067+00:00'
        RETURNING id
        
2025-05-16 15:53:10,984 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:54:10,994 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:54:10,994 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:24:10.990418+00:00'
        RETURNING id
        
2025-05-16 15:54:10,995 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:55:10,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:55:10,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:25:10.981322+00:00'
        RETURNING id
        
2025-05-16 15:55:10,987 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:56:10,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:56:10,987 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:26:10.983208+00:00'
        RETURNING id
        
2025-05-16 15:56:10,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:57:10,994 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:57:10,995 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:27:10.990178+00:00'
        RETURNING id
        
2025-05-16 15:57:10,996 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:58:10,991 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:58:10,992 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:28:10.986889+00:00'
        RETURNING id
        
2025-05-16 15:58:10,992 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 15:59:11,000 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 15:59:11,001 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:29:10.996258+00:00'
        RETURNING id
        
2025-05-16 15:59:11,001 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:00:10,992 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:00:10,992 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:30:10.988106+00:00'
        RETURNING id
        
2025-05-16 16:00:10,993 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:01:11,003 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:01:11,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:31:10.999298+00:00'
        RETURNING id
        
2025-05-16 16:01:11,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:02:11,005 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:02:11,006 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:32:11.000416+00:00'
        RETURNING id
        
2025-05-16 16:02:11,006 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:03:11,002 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:03:11,003 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:33:10.998058+00:00'
        RETURNING id
        
2025-05-16 16:03:11,004 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:04:10,997 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:04:10,997 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:34:10.992637+00:00'
        RETURNING id
        
2025-05-16 16:04:10,998 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:05:11,004 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:05:11,004 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:35:11.000239+00:00'
        RETURNING id
        
2025-05-16 16:05:11,005 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:06:10,997 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:06:10,997 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:36:10.992844+00:00'
        RETURNING id
        
2025-05-16 16:06:10,999 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:07:10,995 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:07:10,995 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 10:37:10.990530+00:00'
        RETURNING id
        
2025-05-16 16:07:10,995 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:38:00,537 - api.utils.logging - INFO - Logging system initialized
2025-05-16 16:38:01,241 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 16:38:01,241 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 16:38:19,793 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:38:19,798 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 16:38:19,804 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:38:19,804 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:38:19,810 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 16:38:19,812 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 16:38:19,812 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 16:38:19,813 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 16:38:19,841 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:38:19,927 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:38:42,499 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:38:42,507 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 16:38:42,508 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:38:42,515 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:38:42,522 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 16:38:42,524 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 16:38:42,525 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 16:38:42,526 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 16:39:00,780 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:39:00,785 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:09:00.769107+00:00'
        RETURNING id
        
2025-05-16 16:39:00,788 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:39:15,166 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 16:39:15,166 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 16:39:15,172 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 16:39:15,184 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 16:39:15,186 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 16:39:15,204 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 16:39:16,164 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:39:16,177 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:39:19,609 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:39:19,619 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:39:19,671 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 16:39:19,686 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 16:39:19,693 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 16:39:19,700 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 16:39:19,712 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 16:39:19,717 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 16:39:19,728 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 16:39:19,734 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 16:39:19,741 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 16:39:25,913 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 16:39:25,920 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 16:39:26,338 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 16:39:26,339 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 16:39:26,362 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 16:39:26,362 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 16:39:59,523 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 16:39:59,530 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 16:40:01,128 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:40:01,130 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:10:01.117777+00:00'
        RETURNING id
        
2025-05-16 16:40:01,131 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:41:00,770 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:41:00,770 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:11:00.761653+00:00'
        RETURNING id
        
2025-05-16 16:41:00,771 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:41:16,032 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 16:41:16,038 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 16:41:28,591 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 16:41:28,598 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 16:42:00,758 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:42:00,758 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:12:00.752424+00:00'
        RETURNING id
        
2025-05-16 16:42:00,759 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:43:00,756 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:43:00,756 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:13:00.750154+00:00'
        RETURNING id
        
2025-05-16 16:43:00,756 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:44:00,760 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:44:00,761 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:14:00.750563+00:00'
        RETURNING id
        
2025-05-16 16:44:00,763 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:45:00,768 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:45:00,768 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:15:00.762008+00:00'
        RETURNING id
        
2025-05-16 16:45:00,769 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:46:00,757 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:46:00,758 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:16:00.748737+00:00'
        RETURNING id
        
2025-05-16 16:46:00,759 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:47:00,763 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:47:00,763 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:17:00.758650+00:00'
        RETURNING id
        
2025-05-16 16:47:00,764 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:48:00,759 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:48:00,760 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:18:00.752140+00:00'
        RETURNING id
        
2025-05-16 16:48:00,760 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:49:00,761 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:49:00,762 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:19:00.755745+00:00'
        RETURNING id
        
2025-05-16 16:49:00,762 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:50:00,773 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:50:00,773 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:20:00.768260+00:00'
        RETURNING id
        
2025-05-16 16:50:00,774 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:51:00,771 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:51:00,772 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:21:00.766958+00:00'
        RETURNING id
        
2025-05-16 16:51:00,773 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:52:00,770 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:52:00,770 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:22:00.765246+00:00'
        RETURNING id
        
2025-05-16 16:52:00,771 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:53:00,771 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:53:00,771 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:23:00.766153+00:00'
        RETURNING id
        
2025-05-16 16:53:00,772 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 16:53:17,973 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 16:53:17,982 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 16:53:42,780 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 16:53:42,785 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 16:54:00,760 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 16:54:00,760 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 11:24:00.755984+00:00'
        RETURNING id
        
2025-05-16 16:54:00,761 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:45:33,504 - api.utils.logging - INFO - Logging system initialized
2025-05-16 18:45:35,034 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 18:45:35,034 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 18:46:33,930 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:46:33,941 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:16:33.851342+00:00'
        RETURNING id
        
2025-05-16 18:46:33,946 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:47:03,271 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 18:47:03,273 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 18:47:03,297 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 18:47:03,308 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 18:47:03,341 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 18:47:03,348 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 18:47:33,830 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:47:33,836 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:17:33.822749+00:00'
        RETURNING id
        
2025-05-16 18:47:33,841 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:48:33,900 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:48:33,907 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:18:33.844597+00:00'
        RETURNING id
        
2025-05-16 18:48:33,910 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:49:32,740 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 18:49:32,767 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 18:49:32,772 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 18:49:32,774 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 18:49:32,779 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 18:49:32,780 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 18:49:32,781 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 18:49:32,782 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 18:49:33,828 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:49:33,831 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:19:33.823200+00:00'
        RETURNING id
        
2025-05-16 18:49:33,833 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:49:58,160 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 18:49:58,172 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 18:49:58,681 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 18:49:58,682 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-16 18:49:58,696 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 18:49:58,704 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 18:49:58,714 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 18:49:58,720 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-16 18:49:58,739 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 18:49:58,747 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 18:49:58,756 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 18:50:22,482 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 18:50:22,490 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 18:50:22,503 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 18:50:22,511 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 18:50:22,519 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 18:50:22,522 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 18:50:23,569 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 18:50:23,586 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 18:50:25,821 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 18:50:25,828 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 18:50:26,242 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 18:50:26,247 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 18:50:26,250 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 18:50:26,267 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 18:50:33,828 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:50:33,835 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:20:33.820038+00:00'
        RETURNING id
        
2025-05-16 18:50:33,837 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:51:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:51:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:21:33.812371+00:00'
        RETURNING id
        
2025-05-16 18:51:33,819 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:52:33,826 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:52:33,827 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:22:33.818197+00:00'
        RETURNING id
        
2025-05-16 18:52:33,829 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:53:33,870 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:53:33,881 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:23:33.835396+00:00'
        RETURNING id
        
2025-05-16 18:53:33,883 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:54:33,825 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:54:33,826 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:24:33.820193+00:00'
        RETURNING id
        
2025-05-16 18:54:33,827 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:55:33,826 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:55:33,827 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:25:33.821150+00:00'
        RETURNING id
        
2025-05-16 18:55:33,828 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:56:33,865 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:56:33,873 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:26:33.834781+00:00'
        RETURNING id
        
2025-05-16 18:56:33,876 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:57:33,835 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:57:33,836 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:27:33.821442+00:00'
        RETURNING id
        
2025-05-16 18:57:33,838 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:58:33,822 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:58:33,822 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:28:33.815256+00:00'
        RETURNING id
        
2025-05-16 18:58:33,823 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 18:59:33,822 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 18:59:33,823 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:29:33.816434+00:00'
        RETURNING id
        
2025-05-16 18:59:33,825 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:00:33,833 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:00:33,833 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:30:33.816439+00:00'
        RETURNING id
        
2025-05-16 19:00:33,834 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:01:30,380 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:30,405 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 19:01:30,412 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:30,417 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:30,437 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:30,441 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 19:01:30,448 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 19:01:30,449 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 19:01:30,449 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 19:01:30,451 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:30,474 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:30,521 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:30,540 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:30,594 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:01:30,594 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:30,600 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:01:30,613 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-16 19:01:30,619 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:01:30,632 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 2
        
2025-05-16 19:01:30,636 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:01:30,643 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:01:30,649 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:01:33,822 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:01:33,822 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:31:33.817398+00:00'
        RETURNING id
        
2025-05-16 19:01:33,823 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:01:48,246 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:01:48,249 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:01:48,253 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:01:48,253 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:01:48,262 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:01:48,262 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:01:49,149 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:49,159 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:01:52,122 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:01:52,129 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:01:52,483 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:01:52,483 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:01:52,490 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:01:52,490 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:02:33,816 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:02:33,816 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:32:33.810435+00:00'
        RETURNING id
        
2025-05-16 19:02:33,817 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:03:33,825 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:03:33,825 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:33:33.817059+00:00'
        RETURNING id
        
2025-05-16 19:03:33,826 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:04:33,812 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:04:33,813 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:34:33.807513+00:00'
        RETURNING id
        
2025-05-16 19:04:33,814 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:05:33,816 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:05:33,818 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:35:33.812904+00:00'
        RETURNING id
        
2025-05-16 19:05:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:05:51,565 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:05:51,571 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:05:55,946 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:05:55,946 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:05:55,954 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:05:55,959 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:18,175 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:18,186 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:19,553 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:19,560 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:06:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:36:33.811322+00:00'
        RETURNING id
        
2025-05-16 19:06:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:06:36,165 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:36,173 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:36,479 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:36,489 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:37,248 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:37,254 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:42,775 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:42,782 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:42,794 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:42,801 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:55,557 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:55,562 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:56,252 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:56,255 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:56,261 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:56,276 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:06:58,956 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:06:58,964 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:07:13,550 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:07:13,555 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:07:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:07:33,818 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:37:33.812108+00:00'
        RETURNING id
        
2025-05-16 19:07:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:07:34,552 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:07:34,560 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:08:03,546 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:08:03,561 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:08:33,824 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:08:33,824 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:38:33.818619+00:00'
        RETURNING id
        
2025-05-16 19:08:33,825 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:09:07,545 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:09:07,550 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:09:11,218 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:09:11,225 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:09:29,914 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:09:29,921 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:09:33,824 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:09:33,824 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:39:33.818855+00:00'
        RETURNING id
        
2025-05-16 19:09:33,825 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:10:00,542 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:10:00,547 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:10:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:10:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:40:33.812180+00:00'
        RETURNING id
        
2025-05-16 19:10:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:10:44,550 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:10:44,555 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:11:25,665 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:11:25,671 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:11:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:11:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:41:33.815913+00:00'
        RETURNING id
        
2025-05-16 19:11:33,820 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:11:42,000 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:11:42,007 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:12:33,812 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:12:33,812 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:42:33.806975+00:00'
        RETURNING id
        
2025-05-16 19:12:33,813 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:12:41,553 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:12:41,561 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:12:43,242 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:12:43,243 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:12:43,249 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:12:43,249 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:12:45,554 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:12:45,559 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:12:49,255 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:12:49,257 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:12:49,264 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:12:49,280 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:12:50,248 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:12:50,254 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:12:52,244 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:12:52,255 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:12:52,560 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:12:52,566 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:13:33,825 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:13:33,825 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:43:33.820358+00:00'
        RETURNING id
        
2025-05-16 19:13:33,826 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:13:34,395 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:13:34,402 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:18,256 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:18,269 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:18,572 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:18,578 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:26,247 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:26,252 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:26,551 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:26,556 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:28,243 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:28,243 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:28,260 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:28,261 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:33,270 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:33,292 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:33,539 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:33,547 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:33,825 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:14:33,826 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:44:33.815335+00:00'
        RETURNING id
        
2025-05-16 19:14:33,827 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:14:47,245 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:47,250 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:47,549 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:47,600 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:14:51,816 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:14:51,828 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:15:12,634 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:15:12,640 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:15:27,548 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:15:27,554 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:15:31,260 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:15:31,264 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:15:31,270 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:15:31,283 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:15:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:15:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:45:33.814666+00:00'
        RETURNING id
        
2025-05-16 19:15:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:15:50,546 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:15:50,552 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:16:12,224 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:16:12,229 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:16:25,518 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:16:25,525 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:16:33,828 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:16:33,828 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:46:33.820656+00:00'
        RETURNING id
        
2025-05-16 19:16:33,830 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:17:33,813 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:17:33,814 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:47:33.809385+00:00'
        RETURNING id
        
2025-05-16 19:17:33,814 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:18:33,821 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:18:33,821 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:48:33.816727+00:00'
        RETURNING id
        
2025-05-16 19:18:33,822 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:18:36,558 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:18:36,564 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:19:02,934 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:19:02,942 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:19:16,739 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:19:16,746 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:19:28,676 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:19:28,682 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:19:33,821 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:19:33,821 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:49:33.816610+00:00'
        RETURNING id
        
2025-05-16 19:19:33,822 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:20:33,811 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:20:33,811 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:50:33.806377+00:00'
        RETURNING id
        
2025-05-16 19:20:33,811 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:20:46,550 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:20:46,553 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:20:48,236 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:20:48,239 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:15,246 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:15,251 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:15,550 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:15,554 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:16,244 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:16,249 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:19,256 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:19,256 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:19,259 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:19,273 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:33,811 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:21:33,811 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:51:33.808438+00:00'
        RETURNING id
        
2025-05-16 19:21:33,811 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:21:49,551 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:49,555 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:52,249 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:52,249 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:52,253 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:52,253 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:54,241 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:54,245 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:21:54,545 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:21:54,548 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:22:14,551 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:22:14,555 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:22:18,548 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:22:18,552 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:22:20,037 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:22:20,043 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:22:20,055 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:22:20,060 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:22:33,816 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:22:33,816 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:52:33.813022+00:00'
        RETURNING id
        
2025-05-16 19:22:33,816 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:22:50,148 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:22:50,151 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:22:57,555 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:22:57,558 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:00,242 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:23:00,245 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:23:00,246 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:00,248 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:02,245 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:23:02,249 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:02,550 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:23:02,553 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:04,238 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:23:04,241 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:06,546 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:23:06,550 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:08,527 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:23:08,528 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:23:08,534 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:08,535 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:21,963 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:23:21,968 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:23:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:23:33,821 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:53:33.817645+00:00'
        RETURNING id
        
2025-05-16 19:23:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:24:01,002 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:24:01,008 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:24:13,543 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:24:13,556 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:24:33,818 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:24:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:54:33.813596+00:00'
        RETURNING id
        
2025-05-16 19:24:33,819 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:24:34,615 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:24:34,618 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:24:43,553 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:24:43,557 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:25:02,551 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:25:02,554 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:25:05,298 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:25:05,300 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:25:05,321 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:25:05,326 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:25:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:25:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:55:33.808180+00:00'
        RETURNING id
        
2025-05-16 19:25:33,820 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:26:30,542 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:26:30,546 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:26:33,822 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:26:33,822 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:56:33.819399+00:00'
        RETURNING id
        
2025-05-16 19:26:33,823 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:26:38,238 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:26:38,242 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:26:38,543 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:26:38,546 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:26:44,969 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:26:44,976 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:26:46,237 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:26:46,240 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:26:52,551 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:26:52,554 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:26:56,246 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:26:56,257 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:27:01,244 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:27:01,247 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:27:07,245 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:27:07,250 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:27:07,562 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 19:27:07,567 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 19:27:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:27:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:57:33.816186+00:00'
        RETURNING id
        
2025-05-16 19:27:33,819 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:28:33,815 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:28:33,815 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:58:33.811043+00:00'
        RETURNING id
        
2025-05-16 19:28:33,816 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:29:33,813 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:29:33,813 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 13:59:33.810189+00:00'
        RETURNING id
        
2025-05-16 19:29:33,814 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:30:13,503 - api.utils.logging - INFO - Executing operation: 
            SELECT id FROM task_completions
            WHERE user_id = 1 AND task_id = 1
            
2025-05-16 19:30:33,812 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:30:33,821 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:00:33.809252+00:00'
        RETURNING id
        
2025-05-16 19:30:33,822 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:31:33,814 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:31:33,814 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:01:33.812038+00:00'
        RETURNING id
        
2025-05-16 19:31:33,815 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:32:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:32:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:02:33.817368+00:00'
        RETURNING id
        
2025-05-16 19:32:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:33:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:33:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:03:33.817900+00:00'
        RETURNING id
        
2025-05-16 19:33:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:34:33,823 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:34:33,823 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:04:33.819414+00:00'
        RETURNING id
        
2025-05-16 19:34:33,823 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:35:33,826 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:35:33,826 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:05:33.823457+00:00'
        RETURNING id
        
2025-05-16 19:35:33,826 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:36:33,824 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:36:33,824 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:06:33.819773+00:00'
        RETURNING id
        
2025-05-16 19:36:33,825 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:37:33,812 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:37:33,812 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:07:33.809597+00:00'
        RETURNING id
        
2025-05-16 19:37:33,813 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:38:33,825 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:38:33,825 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:08:33.819413+00:00'
        RETURNING id
        
2025-05-16 19:38:33,825 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:39:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:39:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:09:33.818003+00:00'
        RETURNING id
        
2025-05-16 19:39:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:40:33,810 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:40:33,811 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:10:33.808042+00:00'
        RETURNING id
        
2025-05-16 19:40:33,811 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:41:33,823 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:41:33,823 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:11:33.819940+00:00'
        RETURNING id
        
2025-05-16 19:41:33,824 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:42:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:42:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:12:33.817178+00:00'
        RETURNING id
        
2025-05-16 19:42:33,820 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:43:33,815 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:43:33,815 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:13:33.812259+00:00'
        RETURNING id
        
2025-05-16 19:43:33,816 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:44:33,821 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:44:33,821 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:14:33.818163+00:00'
        RETURNING id
        
2025-05-16 19:44:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:44:46,914 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:44:46,914 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:44:46,919 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:44:46,926 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:44:46,951 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:44:46,958 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:44:47,932 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:44:47,947 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:44:59,611 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 2
2025-05-16 19:44:59,614 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:44:59,614 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'learning_material', 'New Learning Material', 'draft')
2025-05-16 19:44:59,615 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 2 AND milestone_id = 1
2025-05-16 19:44:59,616 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (2, 6, 1, 2)
2025-05-16 19:44:59,616 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:44:59,630 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 2 AND ct.milestone_id = 1 AND ct.ordering < 2 AND t.deleted_at IS NULL
            
2025-05-16 19:45:04,635 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:45:04,639 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:45:04,648 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:45:04,651 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:45:15,790 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:45:15,793 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:45:33,810 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:45:33,818 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:15:33.806631+00:00'
        RETURNING id
        
2025-05-16 19:45:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:46:33,830 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:46:33,830 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:16:33.818553+00:00'
        RETURNING id
        
2025-05-16 19:46:33,830 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:47:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:47:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:17:33.816252+00:00'
        RETURNING id
        
2025-05-16 19:47:33,820 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:47:53,132 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:47:53,137 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:47:53,137 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "84d7bf26-8b69-4a29-a1e5-98cceca1d75c", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 1}, "content": [{"type": "text", "text": "React Hook: ", "styles": {"bold": true}}, {"type": "text", "text": "useState", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "d2c58ba8-c130-445d-971f-b89ed0fb293e", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Overview", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "10ec2eb6-3993-438b-9c0d-459899e62b13", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "The ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " Hook lets you add ", "styles": {}}, {"type": "text", "text": "state", "styles": {"bold": true}}, {"type": "text", "text": " to ", "styles": {}}, {"type": "text", "text": "functional components", "styles": {"bold": true}}, {"type": "text", "text": " in React. It returns a stateful value and a function to update it. Each call to ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " creates a single piece of state.", "styles": {}}], "children": [], "position": 2}, {"id": "2cb795a0-73e8-43c2-9149-3d1763cc10eb", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Syntax", "styles": {"bold": true}}], "children": [], "position": 3}, {"id": "fd110cb7-2c80-4ac7-ac8d-e55bba1863f5", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "const [state, setState] = useState(initialState);\n", "styles": {}}], "children": [], "position": 4}, {"id": "e94188d6-a9a8-4ed8-bbb8-59d4f63a962b", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Parameters", "styles": {"bold": true}}], "children": [], "position": 5}, {"id": "c444e32d-d6ae-43da-9d1f-b2f256320901", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "initialState\n", "styles": {"code": true}}, {"type": "text", "text": "(any type)", "styles": {"italic": true}}, {"type": "text", "text": ": The initial value of the state. It can be a value or a function that returns a value (for lazy initialization).", "styles": {}}], "children": [], "position": 6}, {"id": "f9948500-9e68-41fd-8b6b-f01e97fdfd26", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Returns", "styles": {"bold": true}}], "children": [], "position": 7}, {"id": "df24fbcc-b0d7-44b7-bba0-fcd4f0ffa535", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "An array with two elements:", "styles": {}}], "children": [{"id": "e2d2a363-d21a-45d4-9210-0ab7dd755b16", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "start": 623}, "content": [{"type": "text", "text": "state", "styles": {"code": true}}, {"type": "text", "text": " \u2013 the current state value.", "styles": {}}], "children": []}, {"id": "fc9314e1-c984-4075-b38a-8dcdbbeb449d", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": " \u2013 a function that updates the state value.", "styles": {}}], "children": []}], "position": 8}, {"id": "5aa775e5-a4d4-435a-a3d5-dc4b31ff856f", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Usage Example", "styles": {"bold": true}}], "children": [], "position": 9}, {"id": "98c3e923-6e7b-47bb-bef7-19e632b8ecb3", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "import React, { useState } from ''react'';\n\nfunction Example() {\n  const [count, setCount] = useState(0);\n\n  return (\n    <div>\n      <p>You clicked {count} times</p>\n      <button onClick={() => setCount(count + 1)}>Click me</button>\n    </div>\n  );\n}\n", "styles": {}}], "children": [], "position": 10}, {"id": "43a95387-3c86-4d13-a0b0-b51260412743", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Functional Updates", "styles": {"bold": true}}], "children": [], "position": 11}, {"id": "e55577dd-6986-4e4e-9a3d-48d41ec8054f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "When the new state depends on the previous state, you can pass a function to ", "styles": {}}, {"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": ":", "styles": {}}], "children": [], "position": 12}, {"id": "2ff3bd88-a208-4f04-bf46-88a17a2a8dfa", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "setCount(prevCount => prevCount + 1);\n", "styles": {}}], "children": [], "position": 13}, {"id": "e943656b-a513-4cb0-8fbd-d08de92a42ec", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Lazy Initialization", "styles": {"bold": true}}], "children": [], "position": 14}, {"id": "758723db-5745-4fc5-a05d-eb835738abbc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "If ", "styles": {}}, {"type": "text", "text": "initialState", "styles": {"code": true}}, {"type": "text", "text": " is the result of an expensive calculation, you can pass a function that returns the initial state:", "styles": {}}], "children": [], "position": 15}, {"id": "f9a6d624-3c57-47bb-a333-829b66958cc5", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "const [state, setState] = useState(() => {\n  return someExpensiveComputation();\n});\n", "styles": {}}], "children": [], "position": 16}, {"id": "ebec98bd-bd2c-486c-bf0c-61f14ddc8f7d", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Notes", "styles": {"bold": true}}], "children": [], "position": 17}, {"id": "022489d5-348f-4f13-9ea9-e7eb1e8514c6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " does not merge the state like ", "styles": {}}, {"type": "text", "text": "this.setState()", "styles": {"code": true}}, {"type": "text", "text": " in class components. If you''re using an object, you must merge it manually:", "styles": {}}], "children": [], "position": 18}, {"id": "f97a3ad3-7c80-4222-9c41-cbce5656cc3e", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "setUser(prevUser => ({\n  ...prevUser,\n  age: 25\n}));\n", "styles": {}}], "children": [], "position": 19}, {"id": "fea7c7bc-3c52-4c81-9589-a2eb94536e8f", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "You can call ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " multiple times in a single component to manage multiple state variables.", "styles": {}}], "children": [], "position": 20}, {"id": "3271a97e-14d6-45bf-9f19-a9bd9c274fc5", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Common Use Cases", "styles": {"bold": true}}], "children": [], "position": 21}, {"id": "8a526ac7-c16c-4963-aec6-8cdcf1e8f4a6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Toggling boolean values:", "styles": {}}], "children": [], "position": 22}, {"id": "6a376bef-6775-4e5c-ae47-7026b268584f", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "const [isVisible, setIsVisible] = useState(false);\n", "styles": {}}], "children": [], "position": 23}, {"id": "449c52b8-d224-44cd-9283-34d8bacde891", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Managing form inputs:", "styles": {}}], "children": [], "position": 24}, {"id": "d9b49cdf-d201-4782-b54c-2fd6104fa2c6", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "const [name, setName] = useState('''');\n", "styles": {}}], "children": [], "position": 25}, {"id": "09a0c577-5494-42e7-9e93-a826df40c9bd", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Tracking UI state like modals, tabs, counters, etc.", "styles": {}}], "children": [], "position": 26}, {"id": "69661993-3e77-4bbc-940a-05570174f1e3", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Import Path", "styles": {"bold": true}}], "children": [], "position": 27}, {"id": "9b058ec7-9ab7-4034-b3fc-be689fddd2e1", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "import { useState } from ''react'';", "styles": {}}], "children": [], "position": 28}, {"id": "b8f2baf4-8638-459a-93f0-d1810b318c0f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 29}]', status = 'draft', title = 'React Js', scheduled_publish_at = NULL WHERE id = 6
2025-05-16 19:47:53,138 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:47:53,147 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:47:53,150 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:47:55,030 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:47:55,033 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:47:55,040 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:47:55,043 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:47:59,455 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:47:59,460 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:47:59,461 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "84d7bf26-8b69-4a29-a1e5-98cceca1d75c", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 1}, "content": [{"type": "text", "text": "React Hook: ", "styles": {"bold": true}}, {"type": "text", "text": "useState", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "d2c58ba8-c130-445d-971f-b89ed0fb293e", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Overview", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "10ec2eb6-3993-438b-9c0d-459899e62b13", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "The ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " Hook lets you add ", "styles": {}}, {"type": "text", "text": "state", "styles": {"bold": true}}, {"type": "text", "text": " to ", "styles": {}}, {"type": "text", "text": "functional components", "styles": {"bold": true}}, {"type": "text", "text": " in React. It returns a stateful value and a function to update it. Each call to ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " creates a single piece of state.", "styles": {}}], "children": [], "position": 2}, {"id": "2cb795a0-73e8-43c2-9149-3d1763cc10eb", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Syntax", "styles": {"bold": true}}], "children": [], "position": 3}, {"id": "fd110cb7-2c80-4ac7-ac8d-e55bba1863f5", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "const [state, setState] = useState(initialState);\n", "styles": {}}], "children": [], "position": 4}, {"id": "e94188d6-a9a8-4ed8-bbb8-59d4f63a962b", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Parameters", "styles": {"bold": true}}], "children": [], "position": 5}, {"id": "c444e32d-d6ae-43da-9d1f-b2f256320901", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "initialState\n", "styles": {"code": true}}, {"type": "text", "text": "(any type)", "styles": {"italic": true}}, {"type": "text", "text": ": The initial value of the state. It can be a value or a function that returns a value (for lazy initialization).", "styles": {}}], "children": [], "position": 6}, {"id": "f9948500-9e68-41fd-8b6b-f01e97fdfd26", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Returns", "styles": {"bold": true}}], "children": [], "position": 7}, {"id": "df24fbcc-b0d7-44b7-bba0-fcd4f0ffa535", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "An array with two elements:", "styles": {}}], "children": [{"id": "e2d2a363-d21a-45d4-9210-0ab7dd755b16", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "start": 623}, "content": [{"type": "text", "text": "state", "styles": {"code": true}}, {"type": "text", "text": " \u2013 the current state value.", "styles": {}}], "children": []}, {"id": "fc9314e1-c984-4075-b38a-8dcdbbeb449d", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": " \u2013 a function that updates the state value.", "styles": {}}], "children": []}], "position": 8}, {"id": "5aa775e5-a4d4-435a-a3d5-dc4b31ff856f", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Usage Example", "styles": {"bold": true}}], "children": [], "position": 9}, {"id": "98c3e923-6e7b-47bb-bef7-19e632b8ecb3", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "import React, { useState } from ''react'';\n\nfunction Example() {\n  const [count, setCount] = useState(0);\n\n  return (\n    <div>\n      <p>You clicked {count} times</p>\n      <button onClick={() => setCount(count + 1)}>Click me</button>\n    </div>\n  );\n}\n", "styles": {}}], "children": [], "position": 10}, {"id": "43a95387-3c86-4d13-a0b0-b51260412743", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Functional Updates", "styles": {"bold": true}}], "children": [], "position": 11}, {"id": "e55577dd-6986-4e4e-9a3d-48d41ec8054f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "When the new state depends on the previous state, you can pass a function to ", "styles": {}}, {"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": ":", "styles": {}}], "children": [], "position": 12}, {"id": "2ff3bd88-a208-4f04-bf46-88a17a2a8dfa", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "setCount(prevCount => prevCount + 1);\n", "styles": {}}], "children": [], "position": 13}, {"id": "e943656b-a513-4cb0-8fbd-d08de92a42ec", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Lazy Initialization", "styles": {"bold": true}}], "children": [], "position": 14}, {"id": "758723db-5745-4fc5-a05d-eb835738abbc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "If ", "styles": {}}, {"type": "text", "text": "initialState", "styles": {"code": true}}, {"type": "text", "text": " is the result of an expensive calculation, you can pass a function that returns the initial state:", "styles": {}}], "children": [], "position": 15}, {"id": "f9a6d624-3c57-47bb-a333-829b66958cc5", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "const [state, setState] = useState(() => {\n  return someExpensiveComputation();\n});\n", "styles": {}}], "children": [], "position": 16}, {"id": "ebec98bd-bd2c-486c-bf0c-61f14ddc8f7d", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Notes", "styles": {"bold": true}}], "children": [], "position": 17}, {"id": "022489d5-348f-4f13-9ea9-e7eb1e8514c6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " does not merge the state like ", "styles": {}}, {"type": "text", "text": "this.setState()", "styles": {"code": true}}, {"type": "text", "text": " in class components. If you''re using an object, you must merge it manually:", "styles": {}}], "children": [], "position": 18}, {"id": "f97a3ad3-7c80-4222-9c41-cbce5656cc3e", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "setUser(prevUser => ({\n  ...prevUser,\n  age: 25\n}));\n", "styles": {}}], "children": [], "position": 19}, {"id": "fea7c7bc-3c52-4c81-9589-a2eb94536e8f", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "You can call ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " multiple times in a single component to manage multiple state variables.", "styles": {}}], "children": [], "position": 20}, {"id": "3271a97e-14d6-45bf-9f19-a9bd9c274fc5", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Common Use Cases", "styles": {"bold": true}}], "children": [], "position": 21}, {"id": "8a526ac7-c16c-4963-aec6-8cdcf1e8f4a6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Toggling boolean values:", "styles": {}}], "children": [], "position": 22}, {"id": "6a376bef-6775-4e5c-ae47-7026b268584f", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "const [isVisible, setIsVisible] = useState(false);\n", "styles": {}}], "children": [], "position": 23}, {"id": "449c52b8-d224-44cd-9283-34d8bacde891", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Managing form inputs:", "styles": {}}], "children": [], "position": 24}, {"id": "d9b49cdf-d201-4782-b54c-2fd6104fa2c6", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "const [name, setName] = useState('''');\n", "styles": {}}], "children": [], "position": 25}, {"id": "09a0c577-5494-42e7-9e93-a826df40c9bd", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Tracking UI state like modals, tabs, counters, etc.", "styles": {}}], "children": [], "position": 26}, {"id": "69661993-3e77-4bbc-940a-05570174f1e3", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Import Path", "styles": {"bold": true}}], "children": [], "position": 27}, {"id": "9b058ec7-9ab7-4034-b3fc-be689fddd2e1", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "import { useState } from ''react'';", "styles": {}}], "children": [], "position": 28}, {"id": "b8f2baf4-8638-459a-93f0-d1810b318c0f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 29}]', status = 'published', title = 'React Js', scheduled_publish_at = NULL WHERE id = 6
2025-05-16 19:47:59,461 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:47:59,474 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:47:59,477 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:48:12,978 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:48:12,981 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:48:12,985 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:48:12,989 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:48:12,993 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:48:12,995 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:48:13,742 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:48:13,752 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:48:15,679 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:48:15,683 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:48:16,018 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:48:16,018 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:48:16,022 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:48:16,029 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:48:33,823 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:48:33,823 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:18:33.820369+00:00'
        RETURNING id
        
2025-05-16 19:48:33,823 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:49:09,256 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:49:09,260 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:49:10,920 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:49:10,923 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:49:10,929 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:49:10,933 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:49:33,811 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:49:33,811 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:19:33.808588+00:00'
        RETURNING id
        
2025-05-16 19:49:33,811 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:50:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:50:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:20:33.814906+00:00'
        RETURNING id
        
2025-05-16 19:50:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:51:33,816 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:51:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:21:33.814022+00:00'
        RETURNING id
        
2025-05-16 19:51:33,817 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:52:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:52:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:22:33.815765+00:00'
        RETURNING id
        
2025-05-16 19:52:33,819 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:53:33,821 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:53:33,822 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:23:33.817946+00:00'
        RETURNING id
        
2025-05-16 19:53:33,822 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:54:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:54:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:24:33.816421+00:00'
        RETURNING id
        
2025-05-16 19:54:33,820 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:55:33,813 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:55:33,813 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:25:33.810316+00:00'
        RETURNING id
        
2025-05-16 19:55:33,814 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:56:33,818 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:56:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:26:33.815503+00:00'
        RETURNING id
        
2025-05-16 19:56:33,819 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:56:39,561 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:56:39,565 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:56:39,565 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "84d7bf26-8b69-4a29-a1e5-98cceca1d75c", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 1}, "content": [{"type": "text", "text": "React Hook: ", "styles": {"bold": true}}, {"type": "text", "text": "useState", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "d2c58ba8-c130-445d-971f-b89ed0fb293e", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Overview", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "10ec2eb6-3993-438b-9c0d-459899e62b13", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "The ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " Hook lets you add ", "styles": {}}, {"type": "text", "text": "state", "styles": {"bold": true}}, {"type": "text", "text": " to ", "styles": {}}, {"type": "text", "text": "functional components", "styles": {"bold": true}}, {"type": "text", "text": " in React. It returns a stateful value and a function to update it. Each call to ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " creates a single piece of state.", "styles": {}}], "children": [], "position": 2}, {"id": "2cb795a0-73e8-43c2-9149-3d1763cc10eb", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Syntax", "styles": {"bold": true}}], "children": [], "position": 3}, {"id": "fd110cb7-2c80-4ac7-ac8d-e55bba1863f5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [state, setState] = useState(initialState);", "styles": {}}], "children": [], "position": 4}, {"id": "e94188d6-a9a8-4ed8-bbb8-59d4f63a962b", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Parameters", "styles": {"bold": true}}], "children": [], "position": 5}, {"id": "c444e32d-d6ae-43da-9d1f-b2f256320901", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "initialState\n", "styles": {"code": true}}, {"type": "text", "text": "(any type)", "styles": {"italic": true}}, {"type": "text", "text": ": The initial value of the state. It can be a value or a function that returns a value (for lazy initialization).", "styles": {}}], "children": [], "position": 6}, {"id": "f9948500-9e68-41fd-8b6b-f01e97fdfd26", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Returns", "styles": {"bold": true}}], "children": [], "position": 7}, {"id": "df24fbcc-b0d7-44b7-bba0-fcd4f0ffa535", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "An array with two elements:", "styles": {}}], "children": [{"id": "e2d2a363-d21a-45d4-9210-0ab7dd755b16", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "start": 623}, "content": [{"type": "text", "text": "state", "styles": {"code": true}}, {"type": "text", "text": " \u2013 the current state value.", "styles": {}}], "children": []}, {"id": "fc9314e1-c984-4075-b38a-8dcdbbeb449d", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": " \u2013 a function that updates the state value.", "styles": {}}], "children": []}], "position": 8}, {"id": "5aa775e5-a4d4-435a-a3d5-dc4b31ff856f", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Usage Example", "styles": {"bold": true}}], "children": [], "position": 9}, {"id": "98c3e923-6e7b-47bb-bef7-19e632b8ecb3", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import React, { useState } from ''react'';", "styles": {}}], "children": [], "position": 10}, {"id": "852eac25-76a8-4348-be6a-9be09989e6ea", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "function Example() {", "styles": {}}], "children": [], "position": 11}, {"id": "2316fdb0-a943-41a2-9345-88ef865c5174", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [count, setCount] = useState(0);", "styles": {}}], "children": [], "position": 12}, {"id": "6676aa41-34eb-4153-814c-65b5e393199e", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return (", "styles": {}}], "children": [], "position": 13}, {"id": "705555f5-e5b3-4cec-bbdf-2697ec643906", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<div>", "styles": {}}], "children": [], "position": 14}, {"id": "3ee342ef-ade0-42ee-bdc1-4b943dbb7770", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<p>You clicked {count} times</p>", "styles": {}}], "children": [], "position": 15}, {"id": "37a2ea65-686b-4240-b9a4-5a0876139693", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<button onClick={() => setCount(count + 1)}>Click me</button>", "styles": {}}], "children": [], "position": 16}, {"id": "73dda938-c573-4820-80a9-cb8d24cea9d7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</div>", "styles": {}}], "children": [], "position": 17}, {"id": "1531d87f-1768-4c79-a1d1-1950525a8021", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": ");", "styles": {}}], "children": [], "position": 18}, {"id": "d1b74df0-e1da-4c3d-b361-df3955cb563d", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}\n", "styles": {}}], "children": [], "position": 19}, {"id": "43a95387-3c86-4d13-a0b0-b51260412743", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Functional Updates", "styles": {"bold": true}}], "children": [], "position": 20}, {"id": "e55577dd-6986-4e4e-9a3d-48d41ec8054f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "When the new state depends on the previous state, you can pass a function to ", "styles": {}}, {"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": ":", "styles": {}}], "children": [], "position": 21}, {"id": "2ff3bd88-a208-4f04-bf46-88a17a2a8dfa", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setCount(prevCount => prevCount + 1);\n", "styles": {}}], "children": [], "position": 22}, {"id": "e943656b-a513-4cb0-8fbd-d08de92a42ec", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Lazy Initialization", "styles": {"bold": true}}], "children": [], "position": 23}, {"id": "758723db-5745-4fc5-a05d-eb835738abbc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "If ", "styles": {}}, {"type": "text", "text": "initialState", "styles": {"code": true}}, {"type": "text", "text": " is the result of an expensive calculation, you can pass a function that returns the initial state:", "styles": {}}], "children": [], "position": 24}, {"id": "f9a6d624-3c57-47bb-a333-829b66958cc5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [state, setState] = useState(() => {", "styles": {}}], "children": [], "position": 25}, {"id": "8b4d6784-2366-44a5-8645-d2158145486f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return someExpensiveComputation();", "styles": {}}], "children": [], "position": 26}, {"id": "ef27d967-0382-44e8-bd00-ae0c75abef60", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "});", "styles": {}}], "children": [], "position": 27}, {"id": "ebec98bd-bd2c-486c-bf0c-61f14ddc8f7d", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Notes", "styles": {"bold": true}}], "children": [], "position": 28}, {"id": "022489d5-348f-4f13-9ea9-e7eb1e8514c6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " does not merge the state like ", "styles": {}}, {"type": "text", "text": "this.setState()", "styles": {"code": true}}, {"type": "text", "text": " in class components. If you''re using an object, you must merge it manually:", "styles": {}}], "children": [], "position": 29}, {"id": "f97a3ad3-7c80-4222-9c41-cbce5656cc3e", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setUser(prevUser => ({", "styles": {}}], "children": [], "position": 30}, {"id": "775e28be-e602-4df7-b96a-784a9ccd4e20", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "...prevUser,", "styles": {}}], "children": [], "position": 31}, {"id": "b8e7338a-a7c0-4719-ac46-883f7a4394ed", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "age: 25", "styles": {}}], "children": [], "position": 32}, {"id": "ad6f5e84-8c8c-4542-9cf1-4caf7f0695b1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}));\n", "styles": {}}], "children": [], "position": 33}, {"id": "fea7c7bc-3c52-4c81-9589-a2eb94536e8f", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "You can call ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " multiple times in a single component to manage multiple state variables.", "styles": {}}], "children": [], "position": 34}, {"id": "3271a97e-14d6-45bf-9f19-a9bd9c274fc5", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Common Use Cases", "styles": {"bold": true}}], "children": [], "position": 35}, {"id": "8a526ac7-c16c-4963-aec6-8cdcf1e8f4a6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Toggling boolean values:", "styles": {}}], "children": [], "position": 36}, {"id": "6a376bef-6775-4e5c-ae47-7026b268584f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [isVisible, setIsVisible] = useState(false);\n", "styles": {}}], "children": [], "position": 37}, {"id": "449c52b8-d224-44cd-9283-34d8bacde891", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Managing form inputs:", "styles": {}}], "children": [], "position": 38}, {"id": "d9b49cdf-d201-4782-b54c-2fd6104fa2c6", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [name, setName] = useState('''');\n", "styles": {}}], "children": [], "position": 39}, {"id": "09a0c577-5494-42e7-9e93-a826df40c9bd", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Tracking UI state like modals, tabs, counters, etc.", "styles": {}}], "children": [], "position": 40}, {"id": "69661993-3e77-4bbc-940a-05570174f1e3", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Import Path", "styles": {"bold": true}}], "children": [], "position": 41}, {"id": "9b058ec7-9ab7-4034-b3fc-be689fddd2e1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import { useState } from ''react'';", "styles": {}}], "children": [], "position": 42}, {"id": "b8f2baf4-8638-459a-93f0-d1810b318c0f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 43}]', status = 'published', title = 'React Js', scheduled_publish_at = NULL WHERE id = 6
2025-05-16 19:56:39,565 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:56:39,574 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:56:39,577 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:56:39,606 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:56:39,611 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:56:39,814 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:56:39,818 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:56:47,340 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:56:47,347 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 19:56:47,347 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:56:47,351 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 19:56:47,360 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:56:47,361 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 19:56:48,205 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:56:48,221 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 19:56:49,841 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:56:49,845 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:56:50,171 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:56:50,176 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:56:50,482 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 19:56:50,486 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 19:57:33,813 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:57:33,813 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:27:33.809373+00:00'
        RETURNING id
        
2025-05-16 19:57:33,813 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:58:33,813 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:58:33,813 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:28:33.810380+00:00'
        RETURNING id
        
2025-05-16 19:58:33,813 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 19:59:33,830 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 19:59:33,830 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:29:33.818819+00:00'
        RETURNING id
        
2025-05-16 19:59:33,831 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:00:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:00:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:30:33.816965+00:00'
        RETURNING id
        
2025-05-16 20:00:33,820 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:01:33,810 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:01:33,810 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:31:33.807769+00:00'
        RETURNING id
        
2025-05-16 20:01:33,811 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:02:33,824 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:02:33,825 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:32:33.821962+00:00'
        RETURNING id
        
2025-05-16 20:02:33,825 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:03:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:03:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:33:33.814650+00:00'
        RETURNING id
        
2025-05-16 20:03:33,817 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:04:33,813 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:04:33,813 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:34:33.809982+00:00'
        RETURNING id
        
2025-05-16 20:04:33,813 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:05:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:05:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:35:33.814765+00:00'
        RETURNING id
        
2025-05-16 20:05:33,820 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:06:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:06:33,818 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:36:33.805858+00:00'
        RETURNING id
        
2025-05-16 20:06:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:07:33,824 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:07:33,824 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:37:33.819958+00:00'
        RETURNING id
        
2025-05-16 20:07:33,824 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:08:33,815 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:08:33,815 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:38:33.811392+00:00'
        RETURNING id
        
2025-05-16 20:08:33,815 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:09:06,159 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:09:06,163 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:09:33,822 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:09:33,822 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:39:33.819166+00:00'
        RETURNING id
        
2025-05-16 20:09:33,823 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:10:33,818 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:10:33,818 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:40:33.805712+00:00'
        RETURNING id
        
2025-05-16 20:10:33,819 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:11:33,812 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:11:33,812 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:41:33.807428+00:00'
        RETURNING id
        
2025-05-16 20:11:33,812 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:12:33,815 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:12:33,815 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:42:33.812574+00:00'
        RETURNING id
        
2025-05-16 20:12:33,816 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:13:33,811 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:13:33,812 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:43:33.808058+00:00'
        RETURNING id
        
2025-05-16 20:13:33,812 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:13:40,136 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:13:40,148 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:13:40,149 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:13:40,152 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:13:40,158 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:13:40,165 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:13:40,166 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:13:40,175 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:13:41,346 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:13:41,356 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:13:55,315 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:13:55,318 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:13:55,648 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:13:55,648 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:13:55,652 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:13:55,666 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:14:19,572 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:14:19,575 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:14:33,816 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:14:33,816 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:44:33.812891+00:00'
        RETURNING id
        
2025-05-16 20:14:33,816 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:15:33,818 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:15:33,818 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:45:33.814996+00:00'
        RETURNING id
        
2025-05-16 20:15:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:16:33,810 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:16:33,810 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:46:33.806689+00:00'
        RETURNING id
        
2025-05-16 20:16:33,811 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:17:33,823 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:17:33,823 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:47:33.820194+00:00'
        RETURNING id
        
2025-05-16 20:17:33,823 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:18:33,814 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:18:33,814 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:48:33.810887+00:00'
        RETURNING id
        
2025-05-16 20:18:33,814 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:19:33,814 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:19:33,814 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:49:33.810969+00:00'
        RETURNING id
        
2025-05-16 20:19:33,814 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:20:33,814 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:20:33,814 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:50:33.810986+00:00'
        RETURNING id
        
2025-05-16 20:20:33,814 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:21:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:21:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:51:33.817078+00:00'
        RETURNING id
        
2025-05-16 20:21:33,820 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:22:33,818 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:22:33,818 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:52:33.815061+00:00'
        RETURNING id
        
2025-05-16 20:22:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:23:10,974 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:23:10,978 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:23:33,814 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:23:33,814 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:53:33.810520+00:00'
        RETURNING id
        
2025-05-16 20:23:33,815 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:24:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:24:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:54:33.816913+00:00'
        RETURNING id
        
2025-05-16 20:24:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:25:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:25:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:55:33.816198+00:00'
        RETURNING id
        
2025-05-16 20:25:33,820 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:25:46,062 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:25:46,070 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:25:46,087 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:25:46,091 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:25:46,309 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:25:46,313 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:26:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:26:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:56:33.812332+00:00'
        RETURNING id
        
2025-05-16 20:26:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:26:36,240 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:26:36,244 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:26:38,088 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:26:38,092 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:27:33,814 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:27:33,814 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:57:33.811643+00:00'
        RETURNING id
        
2025-05-16 20:27:33,815 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:28:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:28:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:58:33.815442+00:00'
        RETURNING id
        
2025-05-16 20:28:33,819 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:29:33,812 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:29:33,812 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 14:59:33.809718+00:00'
        RETURNING id
        
2025-05-16 20:29:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:29:52,246 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:29:52,250 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:29:52,250 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "ee05ae23-60d5-4245-af07-8bfb0cbb8703", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 1}, "content": [{"type": "text", "text": "React Hook: ", "styles": {"bold": true}}, {"type": "text", "text": "useState", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "cae9152b-8d5a-45ec-ab48-d7607041bcb9", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Overview (\u0bae\u0bc7\u0bb2\u0bcb\u0b9f\u0bcd\u0b9f\u0bae\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "aff7f7a3-f0d2-431e-a5f3-e66b015dd3ad", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " \u0b8e\u0ba9\u0bcd\u0baa\u0ba4\u0bc1 React-\u0b87\u0bb2\u0bcd \u0b89\u0bb3\u0bcd\u0bb3 \u0b92\u0bb0\u0bc1 ", "styles": {}}, {"type": "text", "text": "Hook", "styles": {"bold": true}}, {"type": "text", "text": " \u0b86\u0b95\u0bc1\u0bae\u0bcd. \u0b87\u0ba4\u0bc1 ", "styles": {}}, {"type": "text", "text": "functional component", "styles": {"bold": true}}, {"type": "text", "text": "-\u0b95\u0bb3\u0bbf\u0bb2\u0bcd ", "styles": {}}, {"type": "text", "text": "state", "styles": {"bold": true}}, {"type": "text", "text": " (\u0ba8\u0bbf\u0bb2\u0bc8\u0bae\u0bc8\u0baf\u0bc8) \u0ba8\u0bbf\u0bb0\u0bcd\u0bb5\u0b95\u0bbf\u0b95\u0bcd\u0b95 \u0b89\u0ba4\u0bb5\u0bc1\u0b95\u0bbf\u0bb1\u0ba4\u0bc1. \u0b87\u0ba4\u0bc1 \u0b87\u0bb0\u0ba3\u0bcd\u0b9f\u0bc1 \u0bae\u0ba4\u0bbf\u0baa\u0bcd\u0baa\u0bc1\u0b95\u0bb3\u0bc8 return \u0b9a\u0bc6\u0baf\u0bcd\u0b95\u0bbf\u0bb1\u0ba4\u0bc1:", "styles": {}}], "children": [], "position": 2}, {"id": "4200c68c-02a0-4901-96ae-cc7ebced90a1", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "start": 325}, "content": [{"type": "text", "text": "\u0ba4\u0bb1\u0bcd\u0baa\u0bcb\u0ba4\u0bc8\u0baf state value", "styles": {}}], "children": [], "position": 3}, {"id": "ef323b2a-6da8-47fd-a49a-8e00fc32eef9", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b85\u0ba8\u0bcd\u0ba4 state-\u0b90 update \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bc1\u0bae\u0bcd function", "styles": {}}], "children": [], "position": 4}, {"id": "df91f9fd-fe8c-48e4-bf47-81466d7a4356", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Syntax (\u0bb5\u0b9f\u0bbf\u0bb5\u0bae\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 5}, {"id": "6abea82f-0aa6-4a46-a8ce-4159a1aff615", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [state, setState] = useState(initialState);\n", "styles": {}}], "children": [], "position": 6}, {"id": "3a5861a9-9178-469c-b471-c78378eea379", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Parameters (\u0b89\u0bb3\u0bcd\u0bb3\u0bc0\u0b9f\u0bc1\u0b95\u0bb3\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 7}, {"id": "545fa9c1-fc2f-4376-a57b-94427c0d7a5c", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "initialState\n", "styles": {"code": true}}, {"type": "text", "text": "(\u0b8f\u0ba4\u0bc7\u0ba9\u0bc1\u0bae\u0bcd value)", "styles": {"italic": true}}, {"type": "text", "text": " \u2013 \u0b86\u0bb0\u0bae\u0bcd\u0baa \u0ba8\u0bbf\u0bb2\u0bc8\u0baf\u0bbf\u0bb2\u0bcd \u0b87\u0bb0\u0bc1\u0b95\u0bcd\u0b95 \u0bb5\u0bc7\u0ba3\u0bcd\u0b9f\u0bbf\u0baf state value. \u0b87\u0ba4\u0bc1 \u0b92\u0bb0\u0bc1 value \u0b85\u0bb2\u0bcd\u0bb2\u0ba4\u0bc1 function \u0b86\u0b95 \u0b87\u0bb0\u0bc1\u0b95\u0bcd\u0b95\u0bb2\u0bbe\u0bae\u0bcd.", "styles": {}}], "children": [], "position": 8}, {"id": "463344ba-7d9f-47dd-bf21-0b6678266bea", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Returns (\u0ba4\u0bbf\u0bb0\u0bc1\u0bae\u0bcd\u0baa\u0bc1\u0bae\u0bcd \u0bae\u0ba4\u0bbf\u0baa\u0bcd\u0baa\u0bc1)", "styles": {"bold": true}}], "children": [], "position": 9}, {"id": "5f876a85-790c-414b-ad58-2a125f125f69", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b92\u0bb0\u0bc1 array:", "styles": {}}], "children": [{"id": "89a5c1a9-50ef-4750-81ac-6b22dedf2fa2", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "start": 708}, "content": [{"type": "text", "text": "state", "styles": {"code": true}}, {"type": "text", "text": " \u2013 \u0ba4\u0bb1\u0bcd\u0baa\u0bcb\u0ba4\u0bc8\u0baf state value", "styles": {}}], "children": []}, {"id": "3a28fbf4-07c9-43f9-bb67-9c180671abc7", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": " \u2013 state-\u0b90 \u0bae\u0bbe\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0bcd function", "styles": {}}], "children": []}], "position": 10}, {"id": "55bfb8e4-1729-4157-a6ef-647a43dcb263", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Usage Example (\u0baa\u0baf\u0ba9\u0bcd\u0baa\u0bbe\u0b9f\u0bcd\u0b9f\u0bc1 \u0b89\u0ba4\u0bbe\u0bb0\u0ba3\u0bae\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 11}, {"id": "3faffb37-3c9b-4941-9664-c046a07a48bc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import React, { useState } from ''react'';", "styles": {}}], "children": [], "position": 12}, {"id": "485a3a2f-9e4e-43f9-adba-8a55193456eb", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "function Example() {", "styles": {}}], "children": [], "position": 13}, {"id": "a839db09-e243-4bdf-a32b-64ee0ba8f464", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [count, setCount] = useState(0);", "styles": {}}], "children": [], "position": 14}, {"id": "4d4fa91a-59fa-4485-9305-e32c406a9ab7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return (", "styles": {}}], "children": [], "position": 15}, {"id": "67b05b51-35c0-466d-8194-5a7d41fcb4f2", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<div>", "styles": {}}], "children": [], "position": 16}, {"id": "0ca32820-ce46-4588-b76c-bd18cec84a81", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<p>You clicked {count} times</p>", "styles": {}}], "children": [], "position": 17}, {"id": "36c9d282-eedd-4c7d-aa10-00e6283a46bb", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<button onClick={() => setCount(count + 1)}>Click me</button>", "styles": {}}], "children": [], "position": 18}, {"id": "d31f5b6d-18b7-4345-9dd4-72d186a3f47f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</div>", "styles": {}}], "children": [], "position": 19}, {"id": "d48f8c56-9e2a-4707-8eb7-07f48e03412b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": ");", "styles": {}}], "children": [], "position": 20}, {"id": "4b163837-60a2-414d-b389-e86be39a4aa1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}\n", "styles": {}}], "children": [], "position": 21}, {"id": "1f3576a9-bc82-4dc4-8870-cd6459a2dbd4", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Functional Updates (function \u0bae\u0bc2\u0bb2\u0bae\u0bcd update \u0b9a\u0bc6\u0baf\u0bcd\u0bb5\u0ba4\u0bc1)", "styles": {"bold": true}}], "children": [], "position": 22}, {"id": "edded8c6-6c73-4c93-aae9-1dc2696b0453", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "State value \u0baa\u0bb4\u0bc8\u0baf \u0bae\u0ba4\u0bbf\u0baa\u0bcd\u0baa\u0bc8\u0baa\u0bcd \u0baa\u0bca\u0bb0\u0bc1\u0ba4\u0bcd\u0ba4\u0ba4\u0bc1 \u0b8e\u0ba9\u0bcd\u0bb1\u0bbe\u0bb2\u0bcd, function-\u0b90 pass \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bb2\u0bbe\u0bae\u0bcd:", "styles": {}}], "children": [], "position": 23}, {"id": "6cee4a93-9db4-4cf5-a0f1-a9e52e60ac41", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setCount(prevCount => prevCount + 1);\n", "styles": {}}], "children": [], "position": 24}, {"id": "13e9dd88-c1fa-478e-989b-cb13a3a251ad", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Lazy Initialization (\u0ba4\u0bbe\u0bae\u0ba4\u0bae\u0bbe\u0b95 \u0b86\u0bb0\u0bae\u0bcd\u0baa\u0bbf\u0b95\u0bcd\u0b95)", "styles": {"bold": true}}], "children": [], "position": 25}, {"id": "5474169d-5bc7-4d7a-9d72-2c12c8225a51", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Initial state value \u0b92\u0ba9\u0bcd\u0bb1\u0bc1 \u0baa\u0bc6\u0bb0\u0bbf\u0baf calculation-\u0b86\u0ba9\u0bbe\u0bb2\u0bcd \u0b95\u0bbf\u0b9f\u0bc8\u0b95\u0bcd\u0b95 \u0bb5\u0bc7\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bc6\u0ba9\u0bcd\u0bb1\u0bbe\u0bb2\u0bcd, function-\u0b86\u0b95 pass \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bb2\u0bbe\u0bae\u0bcd:", "styles": {}}], "children": [], "position": 26}, {"id": "386b086e-3115-4b5d-9e5e-dcc70359ca8b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [value, setValue] = useState(() => {", "styles": {}}], "children": [], "position": 27}, {"id": "42ab2be3-99b5-4b76-91a5-2222328aae8f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return heavyComputation();", "styles": {}}], "children": [], "position": 28}, {"id": "e7e3c4c1-2c48-4133-8348-ff9dd9c84a78", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "});", "styles": {}}], "children": [], "position": 29}, {"id": "b7eb8e6c-9cf5-4e45-9f23-71c7cb0f18af", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\u0b95\u0bc1\u0bb1\u0bbf\u0baa\u0bcd\u0baa\u0bc1\u0b95\u0bb3\u0bcd (Notes)", "styles": {"bold": true}}], "children": [], "position": 30}, {"id": "cca84fdd-f2be-4da4-99d6-530180b3f999", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " \u0b8e\u0ba9\u0bcd\u0baa\u0ba4\u0bc1 class component-\u0b87\u0bb2\u0bcd \u0b89\u0bb3\u0bcd\u0bb3 ", "styles": {}}, {"type": "text", "text": "this.setState()", "styles": {"code": true}}, {"type": "text", "text": " \u0baa\u0bcb\u0bb2 state-\u0b90 merge \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bbe\u0ba4\u0bc1. \u0ba8\u0bc0\u0b99\u0bcd\u0b95\u0bb3\u0bcd object update \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bc1\u0bae\u0bcd \u0baa\u0bcb\u0ba4\u0bc1, \u0b85\u0ba4\u0bc8 \u0b95\u0bc8\u0baf\u0bc7\u0b9f\u0bc1 \u0bae\u0bc1\u0bb1\u0bc8\u0baf\u0bbf\u0bb2\u0bcd merge \u0b9a\u0bc6\u0baf\u0bcd\u0baf \u0bb5\u0bc7\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bcd:", "styles": {}}], "children": [], "position": 31}, {"id": "2c1febb7-7ab7-4856-9343-617c10ba7ea4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setUser(prevUser => ({", "styles": {}}], "children": [], "position": 32}, {"id": "cd86aacb-eef2-4ce0-9652-de1d8ab36f66", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "...prevUser,", "styles": {}}], "children": [], "position": 33}, {"id": "c5b97367-e3da-4965-9301-11d4dd0df24a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "name: \"Arun\"", "styles": {}}], "children": [], "position": 34}, {"id": "277c8c33-8d98-4f1d-975c-f6729ff6e7d8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}));\n", "styles": {}}], "children": [], "position": 35}, {"id": "da8af842-bf0d-464e-b227-a2753002f351", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b92\u0bb0\u0bc7 component-\u0b87\u0bb2\u0bcd \u0baa\u0bb2 ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " hook-\u0b95\u0bb3\u0bc8 \u0baa\u0baf\u0ba9\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bb2\u0bbe\u0bae\u0bcd.", "styles": {}}], "children": [], "position": 36}, {"id": "fe9097fa-d1f8-4f75-91ce-005a27592a53", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Common Use Cases (\u0baa\u0bca\u0ba4\u0bc1\u0bb5\u0bbe\u0b95 \u0baa\u0baf\u0ba9\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bc1\u0bae\u0bcd \u0b87\u0b9f\u0b99\u0bcd\u0b95\u0bb3\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 37}, {"id": "eef5f8e0-b459-4f78-ad58-771727d395f2", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Boolean value toggle \u0b9a\u0bc6\u0baf\u0bcd\u0baf:", "styles": {}}], "children": [], "position": 38}, {"id": "f8216be5-2514-4f8b-aa97-1cf26f9d6e98", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [isVisible, setIsVisible] = useState(false);\n", "styles": {}}], "children": [], "position": 39}, {"id": "55ad9c5a-4f27-412f-a813-18cc537a1ca6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Form input value-\u0b90 track \u0b9a\u0bc6\u0baf\u0bcd\u0baf:", "styles": {}}], "children": [], "position": 40}, {"id": "2a7c52ad-f5eb-4308-95fa-508a73bb20d3", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [name, setName] = useState('''');\n", "styles": {}}], "children": [], "position": 41}, {"id": "26303497-4613-4844-bc25-fdd3fc67cc08", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Counter, modal, tab switcher, etc \u0baa\u0bcb\u0ba9\u0bcd\u0bb1 UI state-\u0b90 \u0ba8\u0bbf\u0bb0\u0bcd\u0bb5\u0b95\u0bbf\u0b95\u0bcd\u0b95.", "styles": {}}], "children": [], "position": 42}, {"id": "8fb58ea7-e230-41a9-88b7-4574d795f727", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Import Path (\u0b8f\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0ba4\u0bbf \u0bb5\u0bb4\u0bbf)", "styles": {"bold": true}}], "children": [], "position": 43}, {"id": "bbb14db8-9942-46d4-9440-3e46aff54e9b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import { useState } from ''react'';", "styles": {}}], "children": [], "position": 44}, {"id": "f6965ff7-0759-481a-8f90-3d21c99ff4b7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 45}]', status = 'published', title = 'React js (Tamil)', scheduled_publish_at = NULL WHERE id = 1
2025-05-16 20:29:52,251 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:29:52,262 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:29:52,265 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:29:52,294 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:29:52,298 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:29:52,502 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:29:52,506 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:29:59,570 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:29:59,570 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:29:59,577 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:29:59,584 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:29:59,590 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:29:59,594 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:30:00,361 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:30:00,375 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:30:03,510 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:30:03,513 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:30:03,837 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:30:03,837 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:30:03,861 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:30:03,861 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:30:33,809 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:30:33,809 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:00:33.806644+00:00'
        RETURNING id
        
2025-05-16 20:30:33,810 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:31:33,811 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:31:33,811 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:01:33.808393+00:00'
        RETURNING id
        
2025-05-16 20:31:33,812 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:31:49,972 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:31:49,975 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:32:03,424 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:32:03,429 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:32:03,429 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "ee05ae23-60d5-4245-af07-8bfb0cbb8703", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 1}, "content": [{"type": "text", "text": "React Hook: ", "styles": {"bold": true}}, {"type": "text", "text": "useState", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "cae9152b-8d5a-45ec-ab48-d7607041bcb9", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Overview (\u0bae\u0bc7\u0bb2\u0bcb\u0b9f\u0bcd\u0b9f\u0bae\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "aff7f7a3-f0d2-431e-a5f3-e66b015dd3ad", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " \u0b8e\u0ba9\u0bcd\u0baa\u0ba4\u0bc1 React-\u0b87\u0bb2\u0bcd \u0b89\u0bb3\u0bcd\u0bb3 \u0b92\u0bb0\u0bc1 ", "styles": {}}, {"type": "text", "text": "Hook", "styles": {"bold": true}}, {"type": "text", "text": " \u0b86\u0b95\u0bc1\u0bae\u0bcd. \u0b87\u0ba4\u0bc1 ", "styles": {}}, {"type": "text", "text": "functional component", "styles": {"bold": true}}, {"type": "text", "text": "-\u0b95\u0bb3\u0bbf\u0bb2\u0bcd ", "styles": {}}, {"type": "text", "text": "state", "styles": {"bold": true}}, {"type": "text", "text": " (\u0ba8\u0bbf\u0bb2\u0bc8\u0bae\u0bc8\u0baf\u0bc8) \u0ba8\u0bbf\u0bb0\u0bcd\u0bb5\u0b95\u0bbf\u0b95\u0bcd\u0b95 \u0b89\u0ba4\u0bb5\u0bc1\u0b95\u0bbf\u0bb1\u0ba4\u0bc1. \u0b87\u0ba4\u0bc1 \u0b87\u0bb0\u0ba3\u0bcd\u0b9f\u0bc1 \u0bae\u0ba4\u0bbf\u0baa\u0bcd\u0baa\u0bc1\u0b95\u0bb3\u0bc8 return \u0b9a\u0bc6\u0baf\u0bcd\u0b95\u0bbf\u0bb1\u0ba4\u0bc1:", "styles": {}}], "children": [], "position": 2}, {"id": "4200c68c-02a0-4901-96ae-cc7ebced90a1", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "start": 325}, "content": [{"type": "text", "text": "\u0ba4\u0bb1\u0bcd\u0baa\u0bcb\u0ba4\u0bc8\u0baf state value", "styles": {}}], "children": [], "position": 3}, {"id": "ef323b2a-6da8-47fd-a49a-8e00fc32eef9", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b85\u0ba8\u0bcd\u0ba4 state-\u0b90 update \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bc1\u0bae\u0bcd function", "styles": {}}], "children": [], "position": 4}, {"id": "df91f9fd-fe8c-48e4-bf47-81466d7a4356", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Syntax (\u0bb5\u0b9f\u0bbf\u0bb5\u0bae\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 5}, {"id": "6abea82f-0aa6-4a46-a8ce-4159a1aff615", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [state, setState] = useState(initialState);\n", "styles": {}}], "children": [], "position": 6}, {"id": "3a5861a9-9178-469c-b471-c78378eea379", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Parameters (\u0b89\u0bb3\u0bcd\u0bb3\u0bc0\u0b9f\u0bc1\u0b95\u0bb3\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 7}, {"id": "545fa9c1-fc2f-4376-a57b-94427c0d7a5c", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "initialState\n", "styles": {"code": true}}, {"type": "text", "text": "(\u0b8f\u0ba4\u0bc7\u0ba9\u0bc1\u0bae\u0bcd value)", "styles": {"italic": true}}, {"type": "text", "text": " \u2013 \u0b86\u0bb0\u0bae\u0bcd\u0baa \u0ba8\u0bbf\u0bb2\u0bc8\u0baf\u0bbf\u0bb2\u0bcd \u0b87\u0bb0\u0bc1\u0b95\u0bcd\u0b95 \u0bb5\u0bc7\u0ba3\u0bcd\u0b9f\u0bbf\u0baf state value. \u0b87\u0ba4\u0bc1 \u0b92\u0bb0\u0bc1 value \u0b85\u0bb2\u0bcd\u0bb2\u0ba4\u0bc1 function \u0b86\u0b95 \u0b87\u0bb0\u0bc1\u0b95\u0bcd\u0b95\u0bb2\u0bbe\u0bae\u0bcd.", "styles": {}}], "children": [], "position": 8}, {"id": "463344ba-7d9f-47dd-bf21-0b6678266bea", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Returns (\u0ba4\u0bbf\u0bb0\u0bc1\u0bae\u0bcd\u0baa\u0bc1\u0bae\u0bcd \u0bae\u0ba4\u0bbf\u0baa\u0bcd\u0baa\u0bc1)", "styles": {"bold": true}}], "children": [], "position": 9}, {"id": "5f876a85-790c-414b-ad58-2a125f125f69", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b92\u0bb0\u0bc1 array:", "styles": {}}], "children": [{"id": "89a5c1a9-50ef-4750-81ac-6b22dedf2fa2", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "start": 708}, "content": [{"type": "text", "text": "state", "styles": {"code": true}}, {"type": "text", "text": " \u2013 \u0ba4\u0bb1\u0bcd\u0baa\u0bcb\u0ba4\u0bc8\u0baf state value", "styles": {}}], "children": []}, {"id": "3a28fbf4-07c9-43f9-bb67-9c180671abc7", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": " \u2013 state-\u0b90 \u0bae\u0bbe\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0bcd function", "styles": {}}], "children": []}], "position": 10}, {"id": "55bfb8e4-1729-4157-a6ef-647a43dcb263", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Usage Example (\u0baa\u0baf\u0ba9\u0bcd\u0baa\u0bbe\u0b9f\u0bcd\u0b9f\u0bc1 \u0b89\u0ba4\u0bbe\u0bb0\u0ba3\u0bae\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 11}, {"id": "3faffb37-3c9b-4941-9664-c046a07a48bc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import React, { useState } from ''react'';", "styles": {}}], "children": [], "position": 12}, {"id": "485a3a2f-9e4e-43f9-adba-8a55193456eb", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "function Example() {", "styles": {}}], "children": [], "position": 13}, {"id": "a839db09-e243-4bdf-a32b-64ee0ba8f464", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [count, setCount] = useState(0);", "styles": {}}], "children": [], "position": 14}, {"id": "4d4fa91a-59fa-4485-9305-e32c406a9ab7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return (", "styles": {}}], "children": [], "position": 15}, {"id": "67b05b51-35c0-466d-8194-5a7d41fcb4f2", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<div>", "styles": {}}], "children": [], "position": 16}, {"id": "0ca32820-ce46-4588-b76c-bd18cec84a81", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<p>You clicked {count} times</p>", "styles": {}}], "children": [], "position": 17}, {"id": "36c9d282-eedd-4c7d-aa10-00e6283a46bb", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<button onClick={() => setCount(count + 1)}>Click me</button>", "styles": {}}], "children": [], "position": 18}, {"id": "d31f5b6d-18b7-4345-9dd4-72d186a3f47f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</div>", "styles": {}}], "children": [], "position": 19}, {"id": "d48f8c56-9e2a-4707-8eb7-07f48e03412b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": ");", "styles": {}}], "children": [], "position": 20}, {"id": "4b163837-60a2-414d-b389-e86be39a4aa1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}\n", "styles": {}}], "children": [], "position": 21}, {"id": "1f3576a9-bc82-4dc4-8870-cd6459a2dbd4", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Functional Updates (function \u0bae\u0bc2\u0bb2\u0bae\u0bcd update \u0b9a\u0bc6\u0baf\u0bcd\u0bb5\u0ba4\u0bc1)", "styles": {"bold": true}}], "children": [], "position": 22}, {"id": "edded8c6-6c73-4c93-aae9-1dc2696b0453", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "State value \u0baa\u0bb4\u0bc8\u0baf \u0bae\u0ba4\u0bbf\u0baa\u0bcd\u0baa\u0bc8\u0baa\u0bcd \u0baa\u0bca\u0bb0\u0bc1\u0ba4\u0bcd\u0ba4\u0ba4\u0bc1 \u0b8e\u0ba9\u0bcd\u0bb1\u0bbe\u0bb2\u0bcd, function-\u0b90 pass \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bb2\u0bbe\u0bae\u0bcd:", "styles": {}}], "children": [], "position": 23}, {"id": "6cee4a93-9db4-4cf5-a0f1-a9e52e60ac41", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setCount(prevCount => prevCount + 1);\n", "styles": {}}], "children": [], "position": 24}, {"id": "13e9dd88-c1fa-478e-989b-cb13a3a251ad", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Lazy Initialization (\u0ba4\u0bbe\u0bae\u0ba4\u0bae\u0bbe\u0b95 \u0b86\u0bb0\u0bae\u0bcd\u0baa\u0bbf\u0b95\u0bcd\u0b95)", "styles": {"bold": true}}], "children": [], "position": 25}, {"id": "5474169d-5bc7-4d7a-9d72-2c12c8225a51", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Initial state value \u0b92\u0ba9\u0bcd\u0bb1\u0bc1 \u0baa\u0bc6\u0bb0\u0bbf\u0baf calculation-\u0b86\u0ba9\u0bbe\u0bb2\u0bcd \u0b95\u0bbf\u0b9f\u0bc8\u0b95\u0bcd\u0b95 \u0bb5\u0bc7\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bc6\u0ba9\u0bcd\u0bb1\u0bbe\u0bb2\u0bcd, function-\u0b86\u0b95 pass \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bb2\u0bbe\u0bae\u0bcd:", "styles": {}}], "children": [], "position": 26}, {"id": "386b086e-3115-4b5d-9e5e-dcc70359ca8b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [value, setValue] = useState(() => {", "styles": {}}], "children": [], "position": 27}, {"id": "42ab2be3-99b5-4b76-91a5-2222328aae8f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return heavyComputation();", "styles": {}}], "children": [], "position": 28}, {"id": "e7e3c4c1-2c48-4133-8348-ff9dd9c84a78", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "});", "styles": {}}], "children": [], "position": 29}, {"id": "b7eb8e6c-9cf5-4e45-9f23-71c7cb0f18af", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\u0b95\u0bc1\u0bb1\u0bbf\u0baa\u0bcd\u0baa\u0bc1\u0b95\u0bb3\u0bcd (Notes)", "styles": {"bold": true}}], "children": [], "position": 30}, {"id": "cca84fdd-f2be-4da4-99d6-530180b3f999", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " \u0b8e\u0ba9\u0bcd\u0baa\u0ba4\u0bc1 class component-\u0b87\u0bb2\u0bcd \u0b89\u0bb3\u0bcd\u0bb3 ", "styles": {}}, {"type": "text", "text": "this.setState()", "styles": {"code": true}}, {"type": "text", "text": " \u0baa\u0bcb\u0bb2 state-\u0b90 merge \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bbe\u0ba4\u0bc1. \u0ba8\u0bc0\u0b99\u0bcd\u0b95\u0bb3\u0bcd object update \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bc1\u0bae\u0bcd \u0baa\u0bcb\u0ba4\u0bc1, \u0b85\u0ba4\u0bc8 \u0b95\u0bc8\u0baf\u0bc7\u0b9f\u0bc1 \u0bae\u0bc1\u0bb1\u0bc8\u0baf\u0bbf\u0bb2\u0bcd merge \u0b9a\u0bc6\u0baf\u0bcd\u0baf \u0bb5\u0bc7\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bcd:", "styles": {}}], "children": [], "position": 31}, {"id": "2c1febb7-7ab7-4856-9343-617c10ba7ea4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setUser(prevUser => ({", "styles": {}}], "children": [], "position": 32}, {"id": "cd86aacb-eef2-4ce0-9652-de1d8ab36f66", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "...prevUser,", "styles": {}}], "children": [], "position": 33}, {"id": "c5b97367-e3da-4965-9301-11d4dd0df24a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "name: \"Arun\"", "styles": {}}], "children": [], "position": 34}, {"id": "277c8c33-8d98-4f1d-975c-f6729ff6e7d8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}));\n", "styles": {}}], "children": [], "position": 35}, {"id": "da8af842-bf0d-464e-b227-a2753002f351", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b92\u0bb0\u0bc7 component-\u0b87\u0bb2\u0bcd \u0baa\u0bb2 ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " hook-\u0b95\u0bb3\u0bc8 \u0baa\u0baf\u0ba9\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bb2\u0bbe\u0bae\u0bcd.", "styles": {}}], "children": [], "position": 36}, {"id": "fe9097fa-d1f8-4f75-91ce-005a27592a53", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Common Use Cases (\u0baa\u0bca\u0ba4\u0bc1\u0bb5\u0bbe\u0b95 \u0baa\u0baf\u0ba9\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bc1\u0bae\u0bcd \u0b87\u0b9f\u0b99\u0bcd\u0b95\u0bb3\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 37}, {"id": "eef5f8e0-b459-4f78-ad58-771727d395f2", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Boolean value toggle \u0b9a\u0bc6\u0baf\u0bcd\u0baf:", "styles": {}}], "children": [], "position": 38}, {"id": "f8216be5-2514-4f8b-aa97-1cf26f9d6e98", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [isVisible, setIsVisible] = useState(false);\n", "styles": {}}], "children": [], "position": 39}, {"id": "55ad9c5a-4f27-412f-a813-18cc537a1ca6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Form input value-\u0b90 track \u0b9a\u0bc6\u0baf\u0bcd\u0baf:", "styles": {}}], "children": [], "position": 40}, {"id": "2a7c52ad-f5eb-4308-95fa-508a73bb20d3", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [name, setName] = useState('''');\n", "styles": {}}], "children": [], "position": 41}, {"id": "26303497-4613-4844-bc25-fdd3fc67cc08", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Counter, modal, tab switcher, etc \u0baa\u0bcb\u0ba9\u0bcd\u0bb1 UI state-\u0b90 \u0ba8\u0bbf\u0bb0\u0bcd\u0bb5\u0b95\u0bbf\u0b95\u0bcd\u0b95.", "styles": {}}], "children": [], "position": 42}, {"id": "8fb58ea7-e230-41a9-88b7-4574d795f727", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Import Path (\u0b8f\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0ba4\u0bbf \u0bb5\u0bb4\u0bbf)", "styles": {"bold": true}}], "children": [], "position": 43}, {"id": "bbb14db8-9942-46d4-9440-3e46aff54e9b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import { useState } from ''react'';", "styles": {}}], "children": [], "position": 44}, {"id": "f6965ff7-0759-481a-8f90-3d21c99ff4b7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 45}]', status = 'published', title = 'React JS', scheduled_publish_at = NULL WHERE id = 1
2025-05-16 20:32:03,430 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:32:03,443 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:32:03,446 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:32:03,472 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:32:03,477 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:32:03,788 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:32:03,792 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:32:19,524 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:32:19,524 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:32:19,532 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:32:19,538 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:32:19,542 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:32:19,548 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:32:19,955 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:32:19,965 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:32:23,311 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:32:23,315 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:32:23,645 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:32:23,645 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:32:23,648 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:32:23,662 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:32:33,819 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:32:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:02:33.816403+00:00'
        RETURNING id
        
2025-05-16 20:32:33,819 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:33:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:33:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:03:33.815679+00:00'
        RETURNING id
        
2025-05-16 20:33:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:34:33,818 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:34:33,818 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:04:33.815204+00:00'
        RETURNING id
        
2025-05-16 20:34:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:35:33,823 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:35:33,823 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:05:33.820315+00:00'
        RETURNING id
        
2025-05-16 20:35:33,824 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:36:33,827 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:36:33,827 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:06:33.815531+00:00'
        RETURNING id
        
2025-05-16 20:36:33,828 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:37:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:37:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:07:33.814620+00:00'
        RETURNING id
        
2025-05-16 20:37:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:37:40,497 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:37:40,500 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:38:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:38:33,821 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:08:33.817270+00:00'
        RETURNING id
        
2025-05-16 20:38:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:39:33,822 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:39:33,822 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:09:33.818881+00:00'
        RETURNING id
        
2025-05-16 20:39:33,822 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:39:51,223 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:39:51,227 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:39:51,227 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "ee05ae23-60d5-4245-af07-8bfb0cbb8703", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 1}, "content": [{"type": "text", "text": "React Hook: ", "styles": {"bold": true}}, {"type": "text", "text": "useState", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "cae9152b-8d5a-45ec-ab48-d7607041bcb9", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Overview ", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "aff7f7a3-f0d2-431e-a5f3-e66b015dd3ad", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " \u0b8e\u0ba9\u0bcd\u0baa\u0ba4\u0bc1 React-\u0b87\u0bb2\u0bcd \u0b89\u0bb3\u0bcd\u0bb3 \u0b92\u0bb0\u0bc1 ", "styles": {}}, {"type": "text", "text": "Hook", "styles": {"bold": true}}, {"type": "text", "text": " \u0b86\u0b95\u0bc1\u0bae\u0bcd. \u0b87\u0ba4\u0bc1 ", "styles": {}}, {"type": "text", "text": "functional component", "styles": {"bold": true}}, {"type": "text", "text": "-\u0b95\u0bb3\u0bbf\u0bb2\u0bcd ", "styles": {}}, {"type": "text", "text": "state", "styles": {"bold": true}}, {"type": "text", "text": " (\u0ba8\u0bbf\u0bb2\u0bc8\u0bae\u0bc8\u0baf\u0bc8) \u0ba8\u0bbf\u0bb0\u0bcd\u0bb5\u0b95\u0bbf\u0b95\u0bcd\u0b95 \u0b89\u0ba4\u0bb5\u0bc1\u0b95\u0bbf\u0bb1\u0ba4\u0bc1. \u0b87\u0ba4\u0bc1 \u0b87\u0bb0\u0ba3\u0bcd\u0b9f\u0bc1 \u0bae\u0ba4\u0bbf\u0baa\u0bcd\u0baa\u0bc1\u0b95\u0bb3\u0bc8 return \u0b9a\u0bc6\u0baf\u0bcd\u0b95\u0bbf\u0bb1\u0ba4\u0bc1:", "styles": {}}], "children": [], "position": 2}, {"id": "4200c68c-02a0-4901-96ae-cc7ebced90a1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0ba4\u0bb1\u0bcd\u0baa\u0bcb\u0ba4\u0bc8\u0baf state value", "styles": {}}], "children": [], "position": 3}, {"id": "ef323b2a-6da8-47fd-a49a-8e00fc32eef9", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b85\u0ba8\u0bcd\u0ba4 state-\u0b90 update \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bc1\u0bae\u0bcd function", "styles": {}}], "children": [], "position": 4}, {"id": "df91f9fd-fe8c-48e4-bf47-81466d7a4356", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Syntax (\u0bb5\u0b9f\u0bbf\u0bb5\u0bae\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 5}, {"id": "6abea82f-0aa6-4a46-a8ce-4159a1aff615", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [state, setState] = useState(initialState);\n", "styles": {}}], "children": [], "position": 6}, {"id": "3a5861a9-9178-469c-b471-c78378eea379", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Parameters (\u0b89\u0bb3\u0bcd\u0bb3\u0bc0\u0b9f\u0bc1\u0b95\u0bb3\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 7}, {"id": "545fa9c1-fc2f-4376-a57b-94427c0d7a5c", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "initialState\n", "styles": {"code": true}}, {"type": "text", "text": "(\u0b8f\u0ba4\u0bc7\u0ba9\u0bc1\u0bae\u0bcd value)", "styles": {"italic": true}}, {"type": "text", "text": " \u2013 \u0b86\u0bb0\u0bae\u0bcd\u0baa \u0ba8\u0bbf\u0bb2\u0bc8\u0baf\u0bbf\u0bb2\u0bcd \u0b87\u0bb0\u0bc1\u0b95\u0bcd\u0b95 \u0bb5\u0bc7\u0ba3\u0bcd\u0b9f\u0bbf\u0baf state value. \u0b87\u0ba4\u0bc1 \u0b92\u0bb0\u0bc1 value \u0b85\u0bb2\u0bcd\u0bb2\u0ba4\u0bc1 function \u0b86\u0b95 \u0b87\u0bb0\u0bc1\u0b95\u0bcd\u0b95\u0bb2\u0bbe\u0bae\u0bcd.", "styles": {}}], "children": [], "position": 8}, {"id": "463344ba-7d9f-47dd-bf21-0b6678266bea", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Returns (\u0ba4\u0bbf\u0bb0\u0bc1\u0bae\u0bcd\u0baa\u0bc1\u0bae\u0bcd \u0bae\u0ba4\u0bbf\u0baa\u0bcd\u0baa\u0bc1)", "styles": {"bold": true}}], "children": [], "position": 9}, {"id": "5f876a85-790c-414b-ad58-2a125f125f69", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b92\u0bb0\u0bc1 array:", "styles": {}}], "children": [{"id": "89a5c1a9-50ef-4750-81ac-6b22dedf2fa2", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "state", "styles": {"code": true}}, {"type": "text", "text": " \u2013 \u0ba4\u0bb1\u0bcd\u0baa\u0bcb\u0ba4\u0bc8\u0baf state value", "styles": {}}], "children": []}, {"id": "3a28fbf4-07c9-43f9-bb67-9c180671abc7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": " \u2013 state-\u0b90 \u0bae\u0bbe\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0bcd function", "styles": {}}], "children": []}], "position": 10}, {"id": "55bfb8e4-1729-4157-a6ef-647a43dcb263", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Usage Example ", "styles": {"bold": true}}], "children": [], "position": 11}, {"id": "3faffb37-3c9b-4941-9664-c046a07a48bc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import React, { useState } from ''react'';", "styles": {}}], "children": [], "position": 12}, {"id": "485a3a2f-9e4e-43f9-adba-8a55193456eb", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "function Example() {", "styles": {}}], "children": [], "position": 13}, {"id": "a839db09-e243-4bdf-a32b-64ee0ba8f464", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [count, setCount] = useState(0);", "styles": {}}], "children": [], "position": 14}, {"id": "4d4fa91a-59fa-4485-9305-e32c406a9ab7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return (", "styles": {}}], "children": [], "position": 15}, {"id": "67b05b51-35c0-466d-8194-5a7d41fcb4f2", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<div>", "styles": {}}], "children": [], "position": 16}, {"id": "0ca32820-ce46-4588-b76c-bd18cec84a81", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<p>You clicked {count} times</p>", "styles": {}}], "children": [], "position": 17}, {"id": "36c9d282-eedd-4c7d-aa10-00e6283a46bb", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<button onClick={() => setCount(count + 1)}>Click me</button>", "styles": {}}], "children": [], "position": 18}, {"id": "d31f5b6d-18b7-4345-9dd4-72d186a3f47f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</div>", "styles": {}}], "children": [], "position": 19}, {"id": "d48f8c56-9e2a-4707-8eb7-07f48e03412b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": ");", "styles": {}}], "children": [], "position": 20}, {"id": "4b163837-60a2-414d-b389-e86be39a4aa1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}\n", "styles": {}}], "children": [], "position": 21}, {"id": "1f3576a9-bc82-4dc4-8870-cd6459a2dbd4", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Functional Updates (function \u0bae\u0bc2\u0bb2\u0bae\u0bcd update \u0b9a\u0bc6\u0baf\u0bcd\u0bb5\u0ba4\u0bc1)", "styles": {"bold": true}}], "children": [], "position": 22}, {"id": "edded8c6-6c73-4c93-aae9-1dc2696b0453", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "State value \u0baa\u0bb4\u0bc8\u0baf \u0bae\u0ba4\u0bbf\u0baa\u0bcd\u0baa\u0bc8\u0baa\u0bcd \u0baa\u0bca\u0bb0\u0bc1\u0ba4\u0bcd\u0ba4\u0ba4\u0bc1 \u0b8e\u0ba9\u0bcd\u0bb1\u0bbe\u0bb2\u0bcd, function-\u0b90 pass \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bb2\u0bbe\u0bae\u0bcd:", "styles": {}}], "children": [], "position": 23}, {"id": "6cee4a93-9db4-4cf5-a0f1-a9e52e60ac41", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setCount(prevCount => prevCount + 1);\n", "styles": {}}], "children": [], "position": 24}, {"id": "13e9dd88-c1fa-478e-989b-cb13a3a251ad", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Lazy Initialization (\u0ba4\u0bbe\u0bae\u0ba4\u0bae\u0bbe\u0b95 \u0b86\u0bb0\u0bae\u0bcd\u0baa\u0bbf\u0b95\u0bcd\u0b95)", "styles": {"bold": true}}], "children": [], "position": 25}, {"id": "5474169d-5bc7-4d7a-9d72-2c12c8225a51", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Initial state value \u0b92\u0ba9\u0bcd\u0bb1\u0bc1 \u0baa\u0bc6\u0bb0\u0bbf\u0baf calculation-\u0b86\u0ba9\u0bbe\u0bb2\u0bcd \u0b95\u0bbf\u0b9f\u0bc8\u0b95\u0bcd\u0b95 \u0bb5\u0bc7\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bc6\u0ba9\u0bcd\u0bb1\u0bbe\u0bb2\u0bcd, function-\u0b86\u0b95 pass \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bb2\u0bbe\u0bae\u0bcd:", "styles": {}}], "children": [], "position": 26}, {"id": "386b086e-3115-4b5d-9e5e-dcc70359ca8b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [value, setValue] = useState(() => {", "styles": {}}], "children": [], "position": 27}, {"id": "42ab2be3-99b5-4b76-91a5-2222328aae8f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return heavyComputation();", "styles": {}}], "children": [], "position": 28}, {"id": "e7e3c4c1-2c48-4133-8348-ff9dd9c84a78", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "});", "styles": {}}], "children": [], "position": 29}, {"id": "b7eb8e6c-9cf5-4e45-9f23-71c7cb0f18af", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Notes", "styles": {"bold": true}}], "children": [], "position": 30}, {"id": "cca84fdd-f2be-4da4-99d6-530180b3f999", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " \u0b8e\u0ba9\u0bcd\u0baa\u0ba4\u0bc1 class component-\u0b87\u0bb2\u0bcd \u0b89\u0bb3\u0bcd\u0bb3 ", "styles": {}}, {"type": "text", "text": "this.setState()", "styles": {"code": true}}, {"type": "text", "text": " \u0baa\u0bcb\u0bb2 state-\u0b90 merge \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bbe\u0ba4\u0bc1. \u0ba8\u0bc0\u0b99\u0bcd\u0b95\u0bb3\u0bcd object update \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bc1\u0bae\u0bcd \u0baa\u0bcb\u0ba4\u0bc1, \u0b85\u0ba4\u0bc8 \u0b95\u0bc8\u0baf\u0bc7\u0b9f\u0bc1 \u0bae\u0bc1\u0bb1\u0bc8\u0baf\u0bbf\u0bb2\u0bcd merge \u0b9a\u0bc6\u0baf\u0bcd\u0baf \u0bb5\u0bc7\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bcd:", "styles": {}}], "children": [], "position": 31}, {"id": "2c1febb7-7ab7-4856-9343-617c10ba7ea4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setUser(prevUser => ({", "styles": {}}], "children": [], "position": 32}, {"id": "cd86aacb-eef2-4ce0-9652-de1d8ab36f66", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "...prevUser,", "styles": {}}], "children": [], "position": 33}, {"id": "c5b97367-e3da-4965-9301-11d4dd0df24a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "name: \"Arun\"", "styles": {}}], "children": [], "position": 34}, {"id": "277c8c33-8d98-4f1d-975c-f6729ff6e7d8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}));\n", "styles": {}}], "children": [], "position": 35}, {"id": "da8af842-bf0d-464e-b227-a2753002f351", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b92\u0bb0\u0bc7 component-\u0b87\u0bb2\u0bcd \u0baa\u0bb2 ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " hook-\u0b95\u0bb3\u0bc8 \u0baa\u0baf\u0ba9\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bb2\u0bbe\u0bae\u0bcd.", "styles": {}}], "children": [], "position": 36}, {"id": "fe9097fa-d1f8-4f75-91ce-005a27592a53", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Common Use Cases (\u0baa\u0bca\u0ba4\u0bc1\u0bb5\u0bbe\u0b95 \u0baa\u0baf\u0ba9\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bc1\u0bae\u0bcd \u0b87\u0b9f\u0b99\u0bcd\u0b95\u0bb3\u0bcd)", "styles": {"bold": true}}], "children": [], "position": 37}, {"id": "eef5f8e0-b459-4f78-ad58-771727d395f2", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Boolean value toggle \u0b9a\u0bc6\u0baf\u0bcd\u0baf:", "styles": {}}], "children": [], "position": 38}, {"id": "f8216be5-2514-4f8b-aa97-1cf26f9d6e98", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [isVisible, setIsVisible] = useState(false);\n", "styles": {}}], "children": [], "position": 39}, {"id": "55ad9c5a-4f27-412f-a813-18cc537a1ca6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Form input value-\u0b90 track \u0b9a\u0bc6\u0baf\u0bcd\u0baf:", "styles": {}}], "children": [], "position": 40}, {"id": "2a7c52ad-f5eb-4308-95fa-508a73bb20d3", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [name, setName] = useState('''');\n", "styles": {}}], "children": [], "position": 41}, {"id": "26303497-4613-4844-bc25-fdd3fc67cc08", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Counter, modal, tab switcher, etc \u0baa\u0bcb\u0ba9\u0bcd\u0bb1 UI state-\u0b90 \u0ba8\u0bbf\u0bb0\u0bcd\u0bb5\u0b95\u0bbf\u0b95\u0bcd\u0b95.", "styles": {}}], "children": [], "position": 42}, {"id": "8fb58ea7-e230-41a9-88b7-4574d795f727", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Import Path (\u0b8f\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0ba4\u0bbf \u0bb5\u0bb4\u0bbf)", "styles": {"bold": true}}], "children": [], "position": 43}, {"id": "bbb14db8-9942-46d4-9440-3e46aff54e9b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import { useState } from ''react'';", "styles": {}}], "children": [], "position": 44}, {"id": "f6965ff7-0759-481a-8f90-3d21c99ff4b7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 45}]', status = 'published', title = 'React JS', scheduled_publish_at = NULL WHERE id = 1
2025-05-16 20:39:51,228 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:39:51,238 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:39:51,241 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:39:51,266 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:39:51,269 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:39:51,483 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:39:51,486 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:39:56,134 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:39:56,134 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:39:56,139 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:39:56,141 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:39:56,143 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:39:56,145 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:39:56,852 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:39:56,864 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:39:59,218 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:39:59,222 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:39:59,545 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:39:59,545 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:39:59,548 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:39:59,548 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:40:29,958 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:40:29,961 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:40:33,255 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:40:33,259 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:40:33,265 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:40:33,269 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:40:33,818 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:40:33,819 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:10:33.816239+00:00'
        RETURNING id
        
2025-05-16 20:40:33,819 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:40:41,968 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:40:41,972 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:40:41,972 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "84d7bf26-8b69-4a29-a1e5-98cceca1d75c", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 1}, "content": [{"type": "text", "text": "React Hook: ", "styles": {"bold": true}}, {"type": "text", "text": "useState", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "d2c58ba8-c130-445d-971f-b89ed0fb293e", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Overview", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "10ec2eb6-3993-438b-9c0d-459899e62b13", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "The ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " Hook lets you add ", "styles": {}}, {"type": "text", "text": "state", "styles": {"bold": true}}, {"type": "text", "text": " to ", "styles": {}}, {"type": "text", "text": "functional components", "styles": {"bold": true}}, {"type": "text", "text": " in React. It returns a stateful value and a function to update it. Each call to ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " creates a single piece of state.", "styles": {}}], "children": [], "position": 2}, {"id": "2cb795a0-73e8-43c2-9149-3d1763cc10eb", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Syntax", "styles": {"bold": true}}], "children": [], "position": 3}, {"id": "fd110cb7-2c80-4ac7-ac8d-e55bba1863f5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [state, setState] = useState(initialState);", "styles": {}}], "children": [], "position": 4}, {"id": "e94188d6-a9a8-4ed8-bbb8-59d4f63a962b", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Parameters", "styles": {"bold": true}}], "children": [], "position": 5}, {"id": "c444e32d-d6ae-43da-9d1f-b2f256320901", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "initialState\n", "styles": {"code": true}}, {"type": "text", "text": "(any type)", "styles": {"italic": true}}, {"type": "text", "text": ": The initial value of the state. It can be a value or a function that returns a value (for lazy initialization).", "styles": {}}], "children": [], "position": 6}, {"id": "f9948500-9e68-41fd-8b6b-f01e97fdfd26", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Returns", "styles": {"bold": true}}], "children": [], "position": 7}, {"id": "df24fbcc-b0d7-44b7-bba0-fcd4f0ffa535", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "An array with two elements:", "styles": {}}], "children": [{"id": "e2d2a363-d21a-45d4-9210-0ab7dd755b16", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "start": 623}, "content": [{"type": "text", "text": "state", "styles": {"code": true}}, {"type": "text", "text": " \u2013 the current state value.", "styles": {}}], "children": []}, {"id": "fc9314e1-c984-4075-b38a-8dcdbbeb449d", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": " \u2013 a function that updates the state value.", "styles": {}}], "children": []}], "position": 8}, {"id": "5aa775e5-a4d4-435a-a3d5-dc4b31ff856f", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Usage Example", "styles": {"bold": true}}], "children": [], "position": 9}, {"id": "98c3e923-6e7b-47bb-bef7-19e632b8ecb3", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import React, { useState } from ''react'';", "styles": {}}], "children": [], "position": 10}, {"id": "852eac25-76a8-4348-be6a-9be09989e6ea", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "function Example() {", "styles": {}}], "children": [], "position": 11}, {"id": "2316fdb0-a943-41a2-9345-88ef865c5174", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [count, setCount] = useState(0);", "styles": {}}], "children": [], "position": 12}, {"id": "6676aa41-34eb-4153-814c-65b5e393199e", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return (", "styles": {}}], "children": [], "position": 13}, {"id": "705555f5-e5b3-4cec-bbdf-2697ec643906", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<div>", "styles": {}}], "children": [], "position": 14}, {"id": "3ee342ef-ade0-42ee-bdc1-4b943dbb7770", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<p>You clicked {count} times</p>", "styles": {}}], "children": [], "position": 15}, {"id": "37a2ea65-686b-4240-b9a4-5a0876139693", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<button onClick={() => setCount(count + 1)}>Click me</button>", "styles": {}}], "children": [], "position": 16}, {"id": "73dda938-c573-4820-80a9-cb8d24cea9d7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</div>", "styles": {}}], "children": [], "position": 17}, {"id": "1531d87f-1768-4c79-a1d1-1950525a8021", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": ");", "styles": {}}], "children": [], "position": 18}, {"id": "d1b74df0-e1da-4c3d-b361-df3955cb563d", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}\n", "styles": {}}], "children": [], "position": 19}, {"id": "43a95387-3c86-4d13-a0b0-b51260412743", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Functional Updates", "styles": {"bold": true}}], "children": [], "position": 20}, {"id": "e55577dd-6986-4e4e-9a3d-48d41ec8054f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "When the new state depends on the previous state, you can pass a function to ", "styles": {}}, {"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": ":", "styles": {}}], "children": [], "position": 21}, {"id": "2ff3bd88-a208-4f04-bf46-88a17a2a8dfa", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setCount(prevCount => prevCount + 1);\n", "styles": {}}], "children": [], "position": 22}, {"id": "e943656b-a513-4cb0-8fbd-d08de92a42ec", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Lazy Initialization", "styles": {"bold": true}}], "children": [], "position": 23}, {"id": "758723db-5745-4fc5-a05d-eb835738abbc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "If ", "styles": {}}, {"type": "text", "text": "initialState", "styles": {"code": true}}, {"type": "text", "text": " is the result of an expensive calculation, you can pass a function that returns the initial state:", "styles": {}}], "children": [], "position": 24}, {"id": "f9a6d624-3c57-47bb-a333-829b66958cc5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [state, setState] = useState(() => {", "styles": {}}], "children": [], "position": 25}, {"id": "8b4d6784-2366-44a5-8645-d2158145486f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return someExpensiveComputation();", "styles": {}}], "children": [], "position": 26}, {"id": "ef27d967-0382-44e8-bd00-ae0c75abef60", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "});", "styles": {}}], "children": [], "position": 27}, {"id": "ebec98bd-bd2c-486c-bf0c-61f14ddc8f7d", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Notes", "styles": {"bold": true}}], "children": [], "position": 28}, {"id": "022489d5-348f-4f13-9ea9-e7eb1e8514c6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " does not merge the state like ", "styles": {}}, {"type": "text", "text": "this.setState()", "styles": {"code": true}}, {"type": "text", "text": " in class components. If you''re using an object, you must merge it manually:", "styles": {}}], "children": [], "position": 29}, {"id": "f97a3ad3-7c80-4222-9c41-cbce5656cc3e", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setUser(prevUser => ({", "styles": {}}], "children": [], "position": 30}, {"id": "775e28be-e602-4df7-b96a-784a9ccd4e20", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "...prevUser,", "styles": {}}], "children": [], "position": 31}, {"id": "b8e7338a-a7c0-4719-ac46-883f7a4394ed", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "age: 25", "styles": {}}], "children": [], "position": 32}, {"id": "ad6f5e84-8c8c-4542-9cf1-4caf7f0695b1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}));\n", "styles": {}}], "children": [], "position": 33}, {"id": "fea7c7bc-3c52-4c81-9589-a2eb94536e8f", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "You can call ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " multiple times in a single component to manage multiple state variables.", "styles": {}}], "children": [], "position": 34}, {"id": "3271a97e-14d6-45bf-9f19-a9bd9c274fc5", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Common Use Cases", "styles": {"bold": true}}], "children": [], "position": 35}, {"id": "8a526ac7-c16c-4963-aec6-8cdcf1e8f4a6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Toggling boolean values:", "styles": {}}], "children": [], "position": 36}, {"id": "6a376bef-6775-4e5c-ae47-7026b268584f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [isVisible, setIsVisible] = useState(false);\n", "styles": {}}], "children": [], "position": 37}, {"id": "449c52b8-d224-44cd-9283-34d8bacde891", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Managing form inputs:", "styles": {}}], "children": [], "position": 38}, {"id": "d9b49cdf-d201-4782-b54c-2fd6104fa2c6", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [name, setName] = useState('''');\n", "styles": {}}], "children": [], "position": 39}, {"id": "09a0c577-5494-42e7-9e93-a826df40c9bd", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Tracking UI state like modals, tabs, counters, etc.", "styles": {}}], "children": [], "position": 40}, {"id": "69661993-3e77-4bbc-940a-05570174f1e3", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Import Path", "styles": {"bold": true}}], "children": [], "position": 41}, {"id": "9b058ec7-9ab7-4034-b3fc-be689fddd2e1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import { useState } from ''react'';", "styles": {}}], "children": [], "position": 42}, {"id": "b8f2baf4-8638-459a-93f0-d1810b318c0f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 43}]', status = 'published', title = 'React JS', scheduled_publish_at = NULL WHERE id = 6
2025-05-16 20:40:41,973 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:40:41,983 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:40:41,987 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:40:42,010 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:40:42,015 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:40:42,217 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:40:42,220 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:03,962 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:03,966 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:03,980 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:03,983 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:04,224 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:04,228 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:23,097 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:41:23,100 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:41:23,102 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:41:23,105 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:41:23,109 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:41:23,112 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:41:24,073 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:41:24,085 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:41:26,266 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:26,270 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:26,598 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:26,599 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:26,602 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:26,617 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:33,820 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:41:33,820 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:11:33.808206+00:00'
        RETURNING id
        
2025-05-16 20:41:33,821 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:41:42,371 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:42,374 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:56,456 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:56,460 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:41:56,460 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "84d7bf26-8b69-4a29-a1e5-98cceca1d75c", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 1}, "content": [{"type": "text", "text": "React Hook: ", "styles": {"bold": true}}, {"type": "text", "text": "useState", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "d2c58ba8-c130-445d-971f-b89ed0fb293e", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Overview", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "10ec2eb6-3993-438b-9c0d-459899e62b13", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "The ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " Hook lets you add ", "styles": {}}, {"type": "text", "text": "state", "styles": {"bold": true}}, {"type": "text", "text": " to ", "styles": {}}, {"type": "text", "text": "functional components", "styles": {"bold": true}}, {"type": "text", "text": " in React. It returns a stateful value and a function to update it. Each call to ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " creates a single piece of state.", "styles": {}}], "children": [], "position": 2}, {"id": "2cb795a0-73e8-43c2-9149-3d1763cc10eb", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Syntax", "styles": {"bold": true}}], "children": [], "position": 3}, {"id": "fd110cb7-2c80-4ac7-ac8d-e55bba1863f5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [state, setState] = useState(initialState);", "styles": {}}], "children": [], "position": 4}, {"id": "e94188d6-a9a8-4ed8-bbb8-59d4f63a962b", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Parameters", "styles": {"bold": true}}], "children": [], "position": 5}, {"id": "c444e32d-d6ae-43da-9d1f-b2f256320901", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "initialState\n", "styles": {"code": true}}, {"type": "text", "text": "(any type)", "styles": {"italic": true}}, {"type": "text", "text": ": The initial value of the state. It can be a value or a function that returns a value (for lazy initialization).", "styles": {}}], "children": [], "position": 6}, {"id": "f9948500-9e68-41fd-8b6b-f01e97fdfd26", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Returns", "styles": {"bold": true}}], "children": [], "position": 7}, {"id": "df24fbcc-b0d7-44b7-bba0-fcd4f0ffa535", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "An array with two elements:", "styles": {}}], "children": [{"id": "e2d2a363-d21a-45d4-9210-0ab7dd755b16", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "state", "styles": {"code": true}}, {"type": "text", "text": " \u2013 the current state value.", "styles": {}}], "children": []}, {"id": "fc9314e1-c984-4075-b38a-8dcdbbeb449d", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": " \u2013 a function that updates the state value.", "styles": {}}], "children": []}], "position": 8}, {"id": "5aa775e5-a4d4-435a-a3d5-dc4b31ff856f", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Usage Example", "styles": {"bold": true}}], "children": [], "position": 9}, {"id": "98c3e923-6e7b-47bb-bef7-19e632b8ecb3", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import React, { useState } from ''react'';", "styles": {}}], "children": [], "position": 10}, {"id": "852eac25-76a8-4348-be6a-9be09989e6ea", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "function Example() {", "styles": {}}], "children": [], "position": 11}, {"id": "2316fdb0-a943-41a2-9345-88ef865c5174", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [count, setCount] = useState(0);", "styles": {}}], "children": [], "position": 12}, {"id": "6676aa41-34eb-4153-814c-65b5e393199e", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return (", "styles": {}}], "children": [], "position": 13}, {"id": "705555f5-e5b3-4cec-bbdf-2697ec643906", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<div>", "styles": {}}], "children": [], "position": 14}, {"id": "3ee342ef-ade0-42ee-bdc1-4b943dbb7770", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<p>You clicked {count} times</p>", "styles": {}}], "children": [], "position": 15}, {"id": "37a2ea65-686b-4240-b9a4-5a0876139693", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<button onClick={() => setCount(count + 1)}>Click me</button>", "styles": {}}], "children": [], "position": 16}, {"id": "73dda938-c573-4820-80a9-cb8d24cea9d7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</div>", "styles": {}}], "children": [], "position": 17}, {"id": "1531d87f-1768-4c79-a1d1-1950525a8021", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": ");", "styles": {}}], "children": [], "position": 18}, {"id": "d1b74df0-e1da-4c3d-b361-df3955cb563d", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}\n", "styles": {}}], "children": [], "position": 19}, {"id": "43a95387-3c86-4d13-a0b0-b51260412743", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Functional Updates", "styles": {"bold": true}}], "children": [], "position": 20}, {"id": "e55577dd-6986-4e4e-9a3d-48d41ec8054f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "When the new state depends on the previous state, you can pass a function to ", "styles": {}}, {"type": "text", "text": "setState", "styles": {"code": true}}, {"type": "text", "text": ":", "styles": {}}], "children": [], "position": 21}, {"id": "2ff3bd88-a208-4f04-bf46-88a17a2a8dfa", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setCount(prevCount => prevCount + 1);\n", "styles": {}}], "children": [], "position": 22}, {"id": "e943656b-a513-4cb0-8fbd-d08de92a42ec", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Lazy Initialization", "styles": {"bold": true}}], "children": [], "position": 23}, {"id": "758723db-5745-4fc5-a05d-eb835738abbc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "If ", "styles": {}}, {"type": "text", "text": "initialState", "styles": {"code": true}}, {"type": "text", "text": " is the result of an expensive calculation, you can pass a function that returns the initial state:", "styles": {}}], "children": [], "position": 24}, {"id": "f9a6d624-3c57-47bb-a333-829b66958cc5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [state, setState] = useState(() => {", "styles": {}}], "children": [], "position": 25}, {"id": "8b4d6784-2366-44a5-8645-d2158145486f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "return someExpensiveComputation();", "styles": {}}], "children": [], "position": 26}, {"id": "ef27d967-0382-44e8-bd00-ae0c75abef60", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "});", "styles": {}}], "children": [], "position": 27}, {"id": "ebec98bd-bd2c-486c-bf0c-61f14ddc8f7d", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Notes", "styles": {"bold": true}}], "children": [], "position": 28}, {"id": "022489d5-348f-4f13-9ea9-e7eb1e8514c6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " does not merge the state like ", "styles": {}}, {"type": "text", "text": "this.setState()", "styles": {"code": true}}, {"type": "text", "text": " in class components. If you''re using an object, you must merge it manually:", "styles": {}}], "children": [], "position": 29}, {"id": "f97a3ad3-7c80-4222-9c41-cbce5656cc3e", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "setUser(prevUser => ({", "styles": {}}], "children": [], "position": 30}, {"id": "775e28be-e602-4df7-b96a-784a9ccd4e20", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "...prevUser,", "styles": {}}], "children": [], "position": 31}, {"id": "b8e7338a-a7c0-4719-ac46-883f7a4394ed", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "age: 25", "styles": {}}], "children": [], "position": 32}, {"id": "ad6f5e84-8c8c-4542-9cf1-4caf7f0695b1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "}));\n", "styles": {}}], "children": [], "position": 33}, {"id": "fea7c7bc-3c52-4c81-9589-a2eb94536e8f", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "You can call ", "styles": {}}, {"type": "text", "text": "useState", "styles": {"code": true}}, {"type": "text", "text": " multiple times in a single component to manage multiple state variables.", "styles": {}}], "children": [], "position": 34}, {"id": "3271a97e-14d6-45bf-9f19-a9bd9c274fc5", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Common Use Cases", "styles": {"bold": true}}], "children": [], "position": 35}, {"id": "8a526ac7-c16c-4963-aec6-8cdcf1e8f4a6", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Toggling boolean values:", "styles": {}}], "children": [], "position": 36}, {"id": "6a376bef-6775-4e5c-ae47-7026b268584f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [isVisible, setIsVisible] = useState(false);\n", "styles": {}}], "children": [], "position": 37}, {"id": "449c52b8-d224-44cd-9283-34d8bacde891", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Managing form inputs:", "styles": {}}], "children": [], "position": 38}, {"id": "d9b49cdf-d201-4782-b54c-2fd6104fa2c6", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "const [name, setName] = useState('''');\n", "styles": {}}], "children": [], "position": 39}, {"id": "09a0c577-5494-42e7-9e93-a826df40c9bd", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Tracking UI state like modals, tabs, counters, etc.", "styles": {}}], "children": [], "position": 40}, {"id": "69661993-3e77-4bbc-940a-05570174f1e3", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Import Path", "styles": {"bold": true}}], "children": [], "position": 41}, {"id": "9b058ec7-9ab7-4034-b3fc-be689fddd2e1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "import { useState } from ''react'';", "styles": {}}], "children": [], "position": 42}, {"id": "b8f2baf4-8638-459a-93f0-d1810b318c0f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 43}]', status = 'published', title = 'React JS', scheduled_publish_at = NULL WHERE id = 6
2025-05-16 20:41:56,461 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:41:56,472 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:56,475 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:56,500 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:56,504 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:41:56,714 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:41:56,718 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:42:01,658 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:42:01,658 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 20:42:01,666 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:42:01,666 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 20:42:01,672 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:42:01,685 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 20:42:02,454 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:42:02,463 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 20:42:05,746 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:42:05,750 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:42:06,076 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:42:06,077 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:42:06,096 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:42:06,096 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:42:33,817 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:42:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:12:33.814389+00:00'
        RETURNING id
        
2025-05-16 20:42:33,818 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:43:33,816 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:43:33,817 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:13:33.812342+00:00'
        RETURNING id
        
2025-05-16 20:43:33,817 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:43:55,907 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:43:55,911 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:43:55,926 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:43:55,929 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:43:56,153 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:43:56,156 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:44:33,816 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:44:33,816 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:14:33.812881+00:00'
        RETURNING id
        
2025-05-16 20:44:33,816 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:45:07,394 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 1 AND deleted_at IS NULL
        
2025-05-16 20:45:07,397 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 1
2025-05-16 20:45:33,821 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:45:33,821 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:15:33.818358+00:00'
        RETURNING id
        
2025-05-16 20:45:33,822 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:45:41,345 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:45:41,349 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:45:41,366 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:45:41,372 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:45:41,596 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 6 AND deleted_at IS NULL
        
2025-05-16 20:45:41,601 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 6
2025-05-16 20:46:33,813 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:46:33,813 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:16:33.810408+00:00'
        RETURNING id
        
2025-05-16 20:46:33,813 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:47:21,466 - api.utils.logging - INFO - Logging system initialized
2025-05-16 20:47:21,993 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-16 20:47:22,004 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-16 20:48:21,644 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:48:21,644 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:18:21.641244+00:00'
        RETURNING id
        
2025-05-16 20:48:21,645 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:49:21,636 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:49:21,636 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:19:21.632958+00:00'
        RETURNING id
        
2025-05-16 20:49:21,636 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:50:21,641 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:50:21,641 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:20:21.638152+00:00'
        RETURNING id
        
2025-05-16 20:50:21,642 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:51:21,637 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:51:21,637 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:21:21.633486+00:00'
        RETURNING id
        
2025-05-16 20:51:21,637 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:52:21,632 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:52:21,632 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:22:21.629108+00:00'
        RETURNING id
        
2025-05-16 20:52:21,633 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:53:21,633 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:53:21,634 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:23:21.631013+00:00'
        RETURNING id
        
2025-05-16 20:53:21,634 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:54:21,630 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:54:21,630 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:24:21.626898+00:00'
        RETURNING id
        
2025-05-16 20:54:21,630 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:55:21,641 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:55:21,642 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:25:21.639077+00:00'
        RETURNING id
        
2025-05-16 20:55:21,642 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:56:21,643 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:56:21,644 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:26:21.640999+00:00'
        RETURNING id
        
2025-05-16 20:56:21,644 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:57:21,630 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:57:21,630 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:27:21.627237+00:00'
        RETURNING id
        
2025-05-16 20:57:21,631 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:58:21,635 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:58:21,635 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:28:21.632610+00:00'
        RETURNING id
        
2025-05-16 20:58:21,636 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 20:59:21,641 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 20:59:21,641 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:29:21.638547+00:00'
        RETURNING id
        
2025-05-16 20:59:21,642 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:00:21,632 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:00:21,632 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:30:21.629144+00:00'
        RETURNING id
        
2025-05-16 21:00:21,633 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:01:21,633 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:01:21,633 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:31:21.630614+00:00'
        RETURNING id
        
2025-05-16 21:01:21,634 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:02:21,640 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:02:21,641 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:32:21.637828+00:00'
        RETURNING id
        
2025-05-16 21:02:21,641 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:03:21,636 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:03:21,637 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:33:21.633436+00:00'
        RETURNING id
        
2025-05-16 21:03:21,637 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:04:21,636 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:04:21,637 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:34:21.634275+00:00'
        RETURNING id
        
2025-05-16 21:04:21,637 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:05:21,634 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:05:21,634 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:35:21.631175+00:00'
        RETURNING id
        
2025-05-16 21:05:21,634 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:06:21,639 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:06:21,640 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:36:21.636913+00:00'
        RETURNING id
        
2025-05-16 21:06:21,640 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:07:21,638 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:07:21,638 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:37:21.634653+00:00'
        RETURNING id
        
2025-05-16 21:07:21,638 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:08:21,640 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:08:21,640 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:38:21.637706+00:00'
        RETURNING id
        
2025-05-16 21:08:21,641 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:08:59,426 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:08:59,567 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 21:08:59,576 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:08:59,584 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:08:59,592 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 21:08:59,603 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 21:08:59,607 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 21:08:59,607 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 21:09:21,641 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:09:21,641 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:39:21.638254+00:00'
        RETURNING id
        
2025-05-16 21:09:21,642 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:10:21,639 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:10:21,640 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:40:21.636258+00:00'
        RETURNING id
        
2025-05-16 21:10:21,640 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:11:21,651 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:11:21,653 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:41:21.648262+00:00'
        RETURNING id
        
2025-05-16 21:11:21,654 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:12:21,649 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:12:21,649 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:42:21.641692+00:00'
        RETURNING id
        
2025-05-16 21:12:21,650 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:12:31,411 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 21:12:31,411 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-16 21:12:31,417 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 21:12:31,428 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:12:31,448 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-16 21:12:31,455 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:12:36,090 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:12:36,114 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:12:36,237 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:12:36,252 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:12:36,267 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:12:36,291 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:12:36,317 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:12:36,343 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:12:36,347 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:12:36,354 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:12:36,364 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:12:45,109 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 21:12:45,114 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 21:12:48,553 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:12:48,563 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:12:48,570 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:12:48,570 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:12:48,588 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:12:48,600 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:12:49,044 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:12:49,058 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:12:50,698 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 21:12:50,702 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 21:12:51,024 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 21:12:51,024 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 21:12:51,028 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 21:12:51,032 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 21:13:13,626 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-16 21:13:13,630 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-16 21:13:21,637 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:13:21,638 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:43:21.634823+00:00'
        RETURNING id
        
2025-05-16 21:13:21,638 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:14:21,632 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:14:21,632 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:44:21.629478+00:00'
        RETURNING id
        
2025-05-16 21:14:21,633 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:15:13,501 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:15:13,512 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:15:13,594 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:15:13,602 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:15:13,610 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:15:13,633 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:15:13,649 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:15:13,661 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:15:13,668 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:15:13,675 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:15:13,690 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:15:17,769 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:15:17,783 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:15:17,835 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:15:17,835 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:15:17,853 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:15:17,860 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:15:17,864 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:15:17,903 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:15:17,925 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:15:17,932 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:15:17,939 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:15:21,643 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:15:21,643 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:45:21.640802+00:00'
        RETURNING id
        
2025-05-16 21:15:21,646 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:15:24,357 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:15:24,365 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 21:15:24,368 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:15:24,371 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:15:24,377 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 21:15:24,379 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 21:15:24,380 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 21:15:24,381 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 21:16:21,637 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:16:21,637 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:46:21.634702+00:00'
        RETURNING id
        
2025-05-16 21:16:21,638 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:16:47,282 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 21:16:47,286 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:16:47,290 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:16:47,295 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 21:16:47,299 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 21:16:47,300 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 21:16:47,301 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 21:16:47,307 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:16:56,162 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:16:56,177 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:16:56,238 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:16:56,259 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:16:56,271 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:16:56,306 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:16:56,320 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:16:56,331 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:16:56,339 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:16:56,346 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:16:56,360 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:17:00,686 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:17:00,689 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 21:17:00,695 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:17:00,695 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:17:00,702 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 21:17:00,705 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 21:17:00,706 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 21:17:00,707 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 21:17:21,633 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:17:21,633 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:47:21.629793+00:00'
        RETURNING id
        
2025-05-16 21:17:21,633 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:18:13,798 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:13,830 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 21:18:13,834 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:13,838 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:13,858 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 21:18:13,861 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 21:18:13,862 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 21:18:13,862 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 21:18:20,402 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:20,425 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 21:18:20,449 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:20,479 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 21:18:20,480 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 21:18:20,481 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 21:18:20,482 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 21:18:20,504 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:21,651 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-16 21:18:21,654 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-16 15:48:21.644910+00:00'
        RETURNING id
        
2025-05-16 21:18:21,661 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-16 21:18:23,865 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:23,882 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-16 21:18:23,891 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:23,899 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-16 21:18:23,901 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-16 21:18:23,902 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-16 21:18:23,903 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-16 21:18:23,931 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:23,957 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:23,988 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:24,039 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:18:24,055 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:18:24,066 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-16 21:18:24,080 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:18:24,080 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-16 21:18:24,094 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-16 21:18:24,102 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-16 21:18:24,111 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-16 21:18:24,125 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:49:08,695 - api.utils.logging - INFO - Logging system initialized
2025-05-17 10:49:09,753 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-17 10:49:09,764 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-17 10:49:23,810 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:49:23,815 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-17 10:49:23,817 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:49:23,820 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:49:23,823 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:49:23,825 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-17 10:49:23,826 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-17 10:49:23,827 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-17 10:49:41,571 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:49:41,583 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:49:41,645 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 10:49:41,659 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 10:49:41,677 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:49:41,705 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 10:49:41,721 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:49:41,740 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 10:49:41,752 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 10:49:41,762 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:49:41,774 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 10:50:02,956 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 10:50:03,017 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 10:50:03,033 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 10:50:03,038 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 10:50:03,067 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:50:03,090 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:50:04,041 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:50:04,062 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:50:06,755 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 10:50:06,764 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 10:50:07,129 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 10:50:07,131 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 10:50:07,152 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 10:50:07,157 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 10:50:08,952 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 10:50:08,964 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:20:08.945570+00:00'
        RETURNING id
        
2025-05-17 10:50:08,967 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 10:50:22,693 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 10:50:22,702 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 10:51:08,936 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 10:51:08,936 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:21:08.928739+00:00'
        RETURNING id
        
2025-05-17 10:51:08,939 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 10:52:08,939 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 10:52:08,939 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:22:08.932711+00:00'
        RETURNING id
        
2025-05-17 10:52:08,942 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 10:55:00,479 - api.utils.logging - INFO - Logging system initialized
2025-05-17 10:55:01,245 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-17 10:55:01,245 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-17 10:55:57,529 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:55:57,542 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-17 10:55:57,543 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:55:57,550 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:55:57,554 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:55:57,580 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:55:57,584 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-17 10:55:57,585 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-17 10:55:57,586 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-17 10:55:57,609 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:55:57,624 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:55:57,697 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:55:57,781 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 10:55:57,791 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 10:55:57,792 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:55:57,809 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 10:55:57,820 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:55:57,820 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 10:55:57,834 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:55:57,850 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 10:55:57,859 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 10:55:57,870 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:56:00,741 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 10:56:00,741 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:26:00.735812+00:00'
        RETURNING id
        
2025-05-17 10:56:00,744 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 10:56:35,304 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:56:35,312 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:56:35,362 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 10:56:35,386 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 10:56:35,397 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:56:35,411 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 10:56:35,424 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:56:35,437 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 10:56:35,445 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 10:56:35,454 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:56:35,465 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 10:56:48,464 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 10:56:48,485 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:56:48,490 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 10:56:48,506 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 10:56:48,524 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 10:56:48,534 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 10:56:48,548 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 10:56:48,549 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:56:48,563 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:56:48,600 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:57:00,744 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 10:57:00,745 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:27:00.738650+00:00'
        RETURNING id
        
2025-05-17 10:57:00,749 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 10:57:06,321 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:57:06,324 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-17 10:57:06,337 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:57:06,362 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-17 10:57:06,387 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-17 10:57:06,410 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:57:06,414 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 10:57:06,463 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-17 10:57:06,472 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-17 10:57:06,473 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-17 10:57:06,485 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-17 10:57:06,492 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-17 10:57:06,518 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:57:06,522 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-17 10:57:06,539 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-17 10:57:06,549 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 10:57:06,560 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 10:57:06,573 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:57:06,752 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-17 10:57:06,755 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-17 10:57:06,802 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-17 10:57:20,130 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-17 10:57:20,141 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-17 10:57:20,142 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:57:20,150 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-17 10:57:20,170 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-17 10:57:20,177 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-17 10:57:20,182 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-17 10:57:20,187 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-17 10:57:20,201 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:57:20,202 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:57:20,215 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-17 10:57:20,217 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-17 10:57:20,240 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-17 10:57:20,243 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-17 10:57:20,262 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:57:20,264 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:57:20,276 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-17 10:57:20,277 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-17 10:57:20,292 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-17 10:57:20,302 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-17 10:57:20,314 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-17 10:57:20,324 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-17 10:57:20,333 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:57:20,343 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-17 10:57:20,352 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-17 10:57:20,361 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-17 10:57:20,373 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-17 10:57:20,383 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-17 10:57:20,394 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:57:20,403 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-17 10:57:20,412 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-17 10:57:20,421 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-17 10:57:43,115 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:57:43,129 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-17 10:57:53,813 - api.utils.logging - INFO - Executing operation: SELECT slug FROM organizations WHERE id = 1
2025-05-17 10:57:53,822 - api.utils.logging - INFO - Executing operation: 
        SELECT name FROM cohorts WHERE id = 1 AND org_id = 1
        
2025-05-17 10:57:53,831 - api.utils.logging - INFO - Executing operation: 
        SELECT email FROM users u
        JOIN user_organizations uo ON u.id = uo.user_id
        WHERE uo.org_id = 1
        AND (uo.role = 'admin' OR uo.role = 'owner')
        AND u.email IN ('agiletribers@gmail.com')
        
2025-05-17 10:57:53,840 - api.utils.logging - INFO - Executing operation: SELECT * FROM users WHERE email = 'agiletribers@gmail.com'
2025-05-17 10:57:53,845 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 10:57:53,845 - api.utils.logging - INFO - Executing operation: 
        INSERT INTO users (email, default_dp_color, first_name, middle_name, last_name)
        VALUES ('agiletribers@gmail.com', '#18dfc3', NULL, NULL, NULL)
    
2025-05-17 10:57:53,847 - api.utils.logging - INFO - Executing operation: SELECT * FROM users WHERE email = 'agiletribers@gmail.com'
2025-05-17 10:57:53,853 - api.utils.logging - INFO - Executing operation: 
            SELECT 1 FROM user_cohorts WHERE user_id IN (2) AND cohort_id = 1
            
2025-05-17 10:57:53,854 - api.utils.logging - INFO - Executing operation: 
            INSERT INTO user_cohorts (user_id, cohort_id, role)
            VALUES (2, 1, 'learner')
            
2025-05-17 10:57:53,855 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 10:57:53,886 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-17 10:57:53,896 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-17 10:57:53,905 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-17 10:57:59,928 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:57:59,939 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-17 10:58:00,739 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 10:58:00,739 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:28:00.734076+00:00'
        RETURNING id
        
2025-05-17 10:58:00,740 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 10:58:04,708 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 10:58:04,709 - api.utils.logging - INFO - Executing operation: INSERT INTO course_cohorts (course_id, cohort_id) VALUES (1, 1)
2025-05-17 10:58:04,710 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 10:58:04,759 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-17 10:58:04,771 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-17 10:58:04,783 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:58:04,792 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-17 10:58:04,802 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-17 10:58:04,811 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-17 10:58:04,821 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-17 10:58:04,831 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-17 10:58:04,840 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
         AND ct.course_id = 2
2025-05-17 10:58:04,850 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL AND ct.course_id = 2 
        ORDER BY t.id, q.position ASC
        
2025-05-17 10:58:04,861 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT tc.user_id
        FROM task_completions tc
        JOIN course_tasks ct ON tc.task_id = ct.task_id
        WHERE tc.user_id IN (2) AND ct.course_id = 2
        ORDER BY tc.created_at ASC
        
2025-05-17 10:58:04,870 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT ch.user_id
        FROM chat_history ch
        JOIN questions q ON ch.question_id = q.id
        JOIN tasks t ON q.task_id = t.id
        JOIN course_tasks ct ON t.id = ct.task_id
        WHERE ch.user_id IN (2) AND ct.course_id = 2
        GROUP BY ch.user_id
        
2025-05-17 10:58:04,911 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-17 10:58:04,921 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-17 10:58:04,931 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:58:04,941 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-17 10:58:04,949 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-17 10:58:04,954 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-17 10:58:04,959 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-17 10:58:04,964 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-17 10:58:04,966 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-17 10:58:04,977 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-17 10:58:04,979 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
         AND ct.course_id = 2
2025-05-17 10:58:04,996 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-17 10:58:04,998 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL AND ct.course_id = 2 
        ORDER BY t.id, q.position ASC
        
2025-05-17 10:58:05,011 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-17 10:58:05,014 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT tc.user_id
        FROM task_completions tc
        JOIN course_tasks ct ON tc.task_id = ct.task_id
        WHERE tc.user_id IN (2) AND ct.course_id = 2
        ORDER BY tc.created_at ASC
        
2025-05-17 10:58:05,023 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT ch.user_id
        FROM chat_history ch
        JOIN questions q ON ch.question_id = q.id
        JOIN tasks t ON q.task_id = t.id
        JOIN course_tasks ct ON t.id = ct.task_id
        WHERE ch.user_id IN (2) AND ct.course_id = 2
        GROUP BY ch.user_id
        
2025-05-17 10:58:05,037 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-17 10:58:05,039 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-17 10:58:05,051 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-17 10:58:05,062 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 10:58:05,072 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-17 10:58:05,081 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-17 10:58:05,090 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-17 10:58:05,099 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-17 10:58:05,109 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-17 10:58:05,117 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
         AND ct.course_id = 2
2025-05-17 10:58:05,126 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL AND ct.course_id = 2 
        ORDER BY t.id, q.position ASC
        
2025-05-17 10:58:05,135 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT tc.user_id
        FROM task_completions tc
        JOIN course_tasks ct ON tc.task_id = ct.task_id
        WHERE tc.user_id IN (2) AND ct.course_id = 2
        ORDER BY tc.created_at ASC
        
2025-05-17 10:58:05,144 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT ch.user_id
        FROM chat_history ch
        JOIN questions q ON ch.question_id = q.id
        JOIN tasks t ON q.task_id = t.id
        JOIN course_tasks ct ON t.id = ct.task_id
        WHERE ch.user_id IN (2) AND ct.course_id = 2
        GROUP BY ch.user_id
        
2025-05-17 10:58:15,884 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 10:58:15,896 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:58:15,915 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 10:58:15,920 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 10:58:15,939 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 10:58:15,950 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:58:15,955 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 10:58:15,981 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 10:58:15,985 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 10:58:15,993 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 10:58:31,196 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 10:58:31,205 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 10:58:31,248 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 10:58:31,258 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 10:58:31,435 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 10:58:31,444 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 10:59:00,751 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 10:59:00,751 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:29:00.745287+00:00'
        RETURNING id
        
2025-05-17 10:59:00,752 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:00:00,738 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:00:00,739 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:30:00.732991+00:00'
        RETURNING id
        
2025-05-17 11:00:00,739 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:01:00,749 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:01:00,750 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:31:00.743999+00:00'
        RETURNING id
        
2025-05-17 11:01:00,751 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:01:24,642 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:01:24,652 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:01:24,652 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 11:01:24,655 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:01:24,664 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 11:01:24,676 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:01:24,693 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:01:24,703 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:01:24,714 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:02:00,747 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:02:00,748 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:32:00.741660+00:00'
        RETURNING id
        
2025-05-17 11:02:00,748 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:03:00,741 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:03:00,741 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:33:00.735645+00:00'
        RETURNING id
        
2025-05-17 11:03:00,742 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:03:01,830 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 11:03:01,843 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:03:01,853 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 11:03:01,855 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 11:03:01,870 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:03:01,881 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:03:01,885 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 11:03:01,912 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:03:01,917 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:03:01,934 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:03:05,749 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:03:05,754 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:03:05,762 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:03:05,763 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 11:03:05,763 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:03:05,775 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 11:03:05,778 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:03:05,787 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:03:05,799 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:03:54,941 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 11:03:54,956 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:03:54,971 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 11:03:54,984 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 11:03:54,997 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 11:03:55,009 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:03:55,021 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:03:55,035 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:03:55,048 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:03:55,070 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:04:00,752 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:04:00,753 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:34:00.746733+00:00'
        RETURNING id
        
2025-05-17 11:04:00,754 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:04:18,827 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 11:04:18,836 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:04:18,839 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:04:18,840 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 11:04:18,844 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:04:18,856 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:04:18,868 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:04:18,878 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:04:18,888 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:04:35,491 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:04:35,491 - api.utils.logging - INFO - Executing operation: UPDATE courses SET name = 'FRONTEND DEVELOPMENT' WHERE id = 3
2025-05-17 11:04:35,492 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:05:00,749 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:05:00,750 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:35:00.743364+00:00'
        RETURNING id
        
2025-05-17 11:05:00,750 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:05:25,297 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:05:25,306 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:05:29,101 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:05:29,110 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:05:29,125 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:05:29,139 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:05:47,776 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:05:47,785 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:05:47,799 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:05:47,810 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:06:00,738 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:06:00,739 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:36:00.733097+00:00'
        RETURNING id
        
2025-05-17 11:06:00,739 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:07:00,763 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:07:00,763 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:37:00.747899+00:00'
        RETURNING id
        
2025-05-17 11:07:00,764 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:08:00,744 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:08:00,744 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:38:00.739202+00:00'
        RETURNING id
        
2025-05-17 11:08:00,745 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:09:00,753 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:09:00,753 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:39:00.746520+00:00'
        RETURNING id
        
2025-05-17 11:09:00,754 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:09:12,021 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:09:12,029 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:10:00,739 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:10:00,739 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:40:00.733233+00:00'
        RETURNING id
        
2025-05-17 11:10:00,740 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:10:16,672 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:10:16,681 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:10:32,658 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:10:32,666 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:10:32,667 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "df3c55ba-ad2a-4cc7-a9b3-b07ac4f369a6", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "fb97e38d-ecad-459e-ad2a-e60fef8c7c35", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 1}, "content": [{"type": "text", "text": "Module 1: Introduction to Frontend Development", "styles": {}}], "children": [], "position": 1}, {"id": "2dd3a5a1-dbd6-46c8-95b5-7d7e4996a825", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83c\udfaf ", "styles": {}}, {"type": "text", "text": "Objective", "styles": {"bold": true}}, {"type": "text", "text": ":", "styles": {}}], "children": [], "position": 2}, {"id": "f0bb946a-2c06-4298-b59f-d66143f6fbc9", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Understand what frontend development is, how it fits into web development, and what skills, tools, and technologies are required to become a frontend developer.", "styles": {}}], "children": [], "position": 3}, {"id": "437be01f-40f0-4504-bd35-eb26a2434142", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83d\udd0d What is Frontend Development?", "styles": {}}], "children": [], "position": 4}, {"id": "1dc859db-dd3e-4b5d-b7f0-f223a72e39b6", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Frontend development focuses on the ", "styles": {}}, {"type": "text", "text": "user-facing part", "styles": {"bold": true}}, {"type": "text", "text": " of a website or web application \u2014 everything the user sees and interacts with directly in their browser.", "styles": {}}], "children": [], "position": 5}, {"id": "277aa486-1137-4933-908d-be28140ca5f9", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Examples:", "styles": {}}], "children": [{"id": "22508d37-f90e-4e55-9115-e1b4af5e5a88", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Webpage layout", "styles": {}}], "children": []}, {"id": "b3ca2149-3bd3-4f87-8d04-4935bb03d199", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Buttons and navigation", "styles": {}}], "children": []}, {"id": "2924c862-270c-4373-9335-7c6bc839af81", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Colors, fonts, animations", "styles": {}}], "children": []}, {"id": "ca88562e-493c-4a72-ae42-4d4f0750581b", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Interactive features (forms, sliders, etc.)", "styles": {}}], "children": []}], "position": 6}, {"id": "8bb282b5-96e3-48d8-812d-b3ade19c4a81", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83e\udde0 Frontend vs Backend", "styles": {}}], "children": [], "position": 7}, {"id": "5c1ae98b-8eba-49ee-bc1b-47a7a8f729e9", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "FrontendBackendRuns in the browserRuns on the serverHTML, CSS, JavaScriptPython, PHP, Node.js, ", "styles": {}}, {"type": "link", "href": "http://etc.Deals", "content": [{"type": "text", "text": "etc.Deals", "styles": {}}]}, {"type": "text", "text": " with UI/UXHandles database, logic, APIExamples: React, VueExamples: Express, Django, Laravel", "styles": {}}], "children": [], "position": 8}, {"id": "1b5605d8-8946-46ef-b8d3-92b8a6b9155a", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83d\udee0\ufe0f Core Technologies of Frontend", "styles": {}}], "children": [], "position": 9}, {"id": "21c6556c-9f03-4de3-bf00-5ee791a788b7", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "start": 1141}, "content": [{"type": "text", "text": "HTML", "styles": {"bold": true}}, {"type": "text", "text": " \u2013 Structure of the web page", "styles": {}}], "children": [], "position": 10}, {"id": "560d74c9-419a-4c45-b0a8-fde184ea7a95", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "CSS", "styles": {"bold": true}}, {"type": "text", "text": " \u2013 Styling and layout", "styles": {}}], "children": [], "position": 11}, {"id": "279159e9-1480-4566-a4f9-bee9dde9319d", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "JavaScript", "styles": {"bold": true}}, {"type": "text", "text": " \u2013 Interactivity and logic", "styles": {}}], "children": [], "position": 12}, {"id": "12fc3afb-ef68-492f-ad20-204709fac37b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "We''ll learn all three in upcoming modules.", "styles": {}}], "children": [], "position": 13}, {"id": "4c030acb-6281-4f6a-83aa-4eea0d8f0c2b", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83d\udcda Tools of a Frontend Developer", "styles": {}}], "children": [], "position": 14}, {"id": "f00900ca-e1fb-47d2-b097-0653c0da82a7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "ToolPurposeCode EditorVS Code is most popularBrowser DevToolsDebug, inspect, and test web pagesGit & GitHubVersion control and collaborationPackage Managersnpm/yarn for managing dependenciesBuild ToolsWebpack, Vite for bundling appsFrameworksReact, Vue, Angular (we\u2019ll use React)", "styles": {}}], "children": [], "position": 15}, {"id": "c19a2f20-2c61-43ed-a4af-ad90029af25f", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83d\udd04 How Frontend Communicates with Backend", "styles": {}}], "children": [], "position": 16}, {"id": "0b1ade7d-d927-4393-8ea9-aaed495d013e", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Frontend often sends/receives data using ", "styles": {}}, {"type": "text", "text": "APIs", "styles": {"bold": true}}, {"type": "text", "text": " (via HTTP requests), usually formatted as ", "styles": {}}, {"type": "text", "text": "JSON", "styles": {"bold": true}}, {"type": "text", "text": ". For example, logging in a user or fetching weather data.", "styles": {}}], "children": [], "position": 17}, {"id": "1968e3f2-42c3-416f-b1a7-c794039e1c05", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83e\udded Learning Roadmap Overview", "styles": {}}], "children": [], "position": 18}, {"id": "bf56899f-3c50-47a4-9b3a-ff68f7d2a1a2", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Here''s a simplified visual of what you''re going to learn:", "styles": {}}], "children": [], "position": 19}, {"id": "1ff372bd-a53d-4000-8483-35be0bd6208b", "type": "codeBlock", "props": {"language": "javascript"}, "content": [{"type": "text", "text": "HTML \u279d CSS \u279d JavaScript \u279d Git \u279d APIs \u279d React \u279d Deployment\n", "styles": {}}], "children": [], "position": 20}, {"id": "db9a102e-2688-4388-8180-f9d80932dd5f", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83e\uddd1\u200d\ud83d\udcbb Real-World Examples of Frontend", "styles": {}}], "children": [], "position": 21}, {"id": "c12258ed-2636-4b64-9fac-6729c328cbc1", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Gmail (interface)", "styles": {}}], "children": [], "position": 22}, {"id": "25529a82-e35a-4f00-8144-43cee1450794", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Amazon (product listing page)", "styles": {}}], "children": [], "position": 23}, {"id": "93f2c19a-fff7-44ef-85a5-6f70195d46c9", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "YouTube (video player, sidebar)", "styles": {}}], "children": [], "position": 24}, {"id": "fbaae928-e925-487c-9ed5-72868f54871c", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\u2705 Tasks & Exercises", "styles": {}}], "children": [], "position": 25}, {"id": "73d63ad3-5ab6-43d4-ba2f-e4d109dac393", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udd39 Task 1: Research and Write", "styles": {}}], "children": [], "position": 26}, {"id": "909582cf-0610-4d56-b79a-9c44cf11d214", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Write a 300-word summary in your own words:", "styles": {}}], "children": [], "position": 27}, {"id": "925ec795-9919-42bf-a946-15491f287b7f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u201cWhat is frontend development, and what does a frontend developer do?\u201d", "styles": {}}], "children": [], "position": 28}, {"id": "7adcd394-b91d-4416-a98c-4a9cb2201fd1", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udd39 Task 2: Explore DevTools", "styles": {}}], "children": [], "position": 29}, {"id": "53019c0c-1e1d-4ee6-b1ac-b834e33eadbf", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Open any website (like ", "styles": {}}, {"type": "link", "href": "http://google.com", "content": [{"type": "text", "text": "google.com", "styles": {}}]}, {"type": "text", "text": ")", "styles": {}}], "children": [], "position": 30}, {"id": "d10a77e1-2586-497e-8deb-91ee69794c16", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Right-click \u2192 \"Inspect\"", "styles": {}}], "children": [], "position": 31}, {"id": "201e3de6-5d9a-4bb4-81b4-691ca88f7d7a", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Explore the ", "styles": {}}, {"type": "text", "text": "Elements", "styles": {"bold": true}}, {"type": "text", "text": " and ", "styles": {}}, {"type": "text", "text": "Console", "styles": {"bold": true}}, {"type": "text", "text": " tabs", "styles": {}}], "children": [], "position": 32}, {"id": "f4d02aa0-7b84-4a04-9068-06c03c43fd18", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udd39 Task 3: Install Tools", "styles": {}}], "children": [], "position": 33}, {"id": "18e7c890-93c0-4491-8eaf-32eb37ab8311", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u2705 Install these:", "styles": {}}], "children": [], "position": 34}, {"id": "4b17e806-46d9-4262-afef-3adcfc210a24", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "VS Code", "styles": {}}], "children": [], "position": 35}, {"id": "73e0ec48-2164-4e44-9951-6686c8b9e429", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Google Chrome", "styles": {}}], "children": [], "position": 36}, {"id": "1e33b06b-b9f0-434d-9d0f-61f328878f00", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Git", "styles": {}}], "children": [], "position": 37}, {"id": "2d272952-5bcd-4197-bf80-049d8255cd6d", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Node.js and npm (verify using ", "styles": {}}, {"type": "text", "text": "node -v", "styles": {"code": true}}, {"type": "text", "text": " and ", "styles": {}}, {"type": "text", "text": "npm -v", "styles": {"code": true}}, {"type": "text", "text": " in terminal)", "styles": {}}], "children": [], "position": 38}, {"id": "7cbae448-7535-4e50-b509-5a1cf5433b99", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83d\udcd8 Resources", "styles": {}}], "children": [], "position": 39}, {"id": "a3113d45-a8d0-4215-a1fd-1f7b222a35d4", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcfa Videos:", "styles": {}}], "children": [], "position": 40}, {"id": "177f1135-c880-4f9d-8600-f99fc1187d87", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "link", "href": "https://www.youtube.com/watch?v=wbp0Rb-ZJak", "content": [{"type": "text", "text": "Frontend Developer Explained (Fireship)", "styles": {}}]}], "children": [], "position": 41}, {"id": "18b21037-54c0-4eda-afbf-7fdf2f0cc8fd", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "link", "href": "https://www.youtube.com/watch?v=UB1O30fR-EE", "content": [{"type": "text", "text": "HTML, CSS, JavaScript - Explained for Beginners", "styles": {}}]}], "children": [], "position": 42}, {"id": "58117090-f188-47f0-9a72-01c90965d8e7", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcc4 Articles:", "styles": {}}], "children": [], "position": 43}, {"id": "3f11d3bc-bd97-4491-a7f8-320afa722788", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "link", "href": "https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web", "content": [{"type": "text", "text": "MDN Web Docs: Introduction to Web Development", "styles": {}}]}], "children": [], "position": 44}, {"id": "2169373b-a4e8-4618-a36c-d12593a910f8", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83e\uddea Mini Project", "styles": {}}], "children": [], "position": 45}, {"id": "825d7f00-9118-4365-821a-c7fb6559c776", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Project", "styles": {"bold": true}}, {"type": "text", "text": ": Create a simple \u201cAbout Me\u201d webpage using plain HTML (we\u2019ll use CSS later).", "styles": {}}], "children": [], "position": 46}, {"id": "3845bf29-d699-48ff-99cf-15e949ed2e25", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Instructions", "styles": {"bold": true}}, {"type": "text", "text": ":", "styles": {}}], "children": [], "position": 47}, {"id": "9d4b4cce-fbe4-42e3-a1f8-7e95a2688d6b", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Add your name, photo (or image URL), and a paragraph about yourself.", "styles": {}}], "children": [], "position": 48}, {"id": "6007afa0-7c6e-437e-90d7-827635791317", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Save it as ", "styles": {}}, {"type": "text", "text": "index.html", "styles": {"code": true}}, {"type": "text", "text": " and open in browser.", "styles": {}}], "children": [], "position": 49}, {"id": "4ba2c9db-d4b5-4168-99e9-60d17208afea", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "\ud83c\udfc1 Recap", "styles": {}}], "children": [], "position": 50}, {"id": "f8331b36-f8ed-4984-856e-13a0d470b288", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u2705 You now understand:", "styles": {}}], "children": [], "position": 51}, {"id": "de21ba97-3af2-47ec-a3ea-9a5f151046cc", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "What frontend development is", "styles": {}}], "children": [], "position": 52}, {"id": "8d033cc4-1a92-4269-b4c1-1ea1dc848f2d", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Basic tools and workflow", "styles": {}}], "children": [], "position": 53}, {"id": "3d3c55f9-2212-4ecb-ac3c-a311fa1b6578", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "The technologies used in frontend", "styles": {}}], "children": [], "position": 54}, {"id": "eff59a7a-5d20-4721-b8ec-86117574c58b", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "What to expect going forward", "styles": {}}], "children": [], "position": 55}, {"id": "ea0ff7e3-ce95-41f6-bb66-9b5aed3961cc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 56}]', status = 'published', title = 'Module 1: Introduction to Frontend Development', scheduled_publish_at = NULL WHERE id = 4
2025-05-17 11:10:32,668 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:10:32,693 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:10:32,697 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:10:32,748 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:10:32,759 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:10:33,060 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:10:33,068 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:11:00,742 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:11:00,742 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:41:00.736063+00:00'
        RETURNING id
        
2025-05-17 11:11:00,743 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:11:26,152 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:11:26,165 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:11:26,178 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:11:26,188 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:11:26,202 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:11:26,212 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:00,753 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:12:00,753 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:42:00.747022+00:00'
        RETURNING id
        
2025-05-17 11:12:00,754 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:12:04,864 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:04,876 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:04,890 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:04,900 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:04,914 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:04,925 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:08,543 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:08,558 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:08,559 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:08,572 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:08,585 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:08,594 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:48,529 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:48,537 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:48,545 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:12:48,545 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 5)
2025-05-17 11:12:48,545 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 5
2025-05-17 11:12:48,549 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (5, 'objective', '[{"id": "996a5278-5e7f-4e0f-9e59-b42151a44276", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "e5232a53-6a69-4d75-afa2-23df1ef3b745", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "What does HTML stand for?", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "482ddd9e-5b98-49b7-9afb-d9cc99188d7a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) Hyper Trainer Marking Language\nB) Hyper Text Marketing Language\nC) Hyper Text Markup Language\nD) Hyper Text Marking Language", "styles": {}}], "children": [], "position": 2}, {"id": "bbb056a0-21a8-437b-9229-bfcafb702aa5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "ec951ec6-541c-4db7-8e5b-94c8523f0529", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "C) Hyper Text Markup Language", "styles": {}}], "children": [], "position": 0}, {"id": "92bff0fc-3897-4a33-8273-16ab187bdf40", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', 'text', 'exam', NULL, NULL, NULL, 0, 1, 0)
                
2025-05-17 11:12:48,552 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'draft', title = 'HTML MCQS', scheduled_publish_at = NULL WHERE id = 5
2025-05-17 11:12:48,552 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:12:48,586 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:48,591 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:49,801 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:49,817 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:49,819 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:49,840 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:49,855 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:49,868 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:52,747 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:52,758 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:52,768 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:12:52,769 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 5)
2025-05-17 11:12:52,769 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 5
2025-05-17 11:12:52,771 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (5, 'objective', '[{"id": "996a5278-5e7f-4e0f-9e59-b42151a44276", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "e5232a53-6a69-4d75-afa2-23df1ef3b745", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "What does HTML stand for?", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "482ddd9e-5b98-49b7-9afb-d9cc99188d7a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) Hyper Trainer Marking Language\nB) Hyper Text Marketing Language\nC) Hyper Text Markup Language\nD) Hyper Text Marking Language", "styles": {}}], "children": [], "position": 2}, {"id": "bbb056a0-21a8-437b-9229-bfcafb702aa5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "ec951ec6-541c-4db7-8e5b-94c8523f0529", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "C) Hyper Text Markup Language", "styles": {}}], "children": [], "position": 0}, {"id": "92bff0fc-3897-4a33-8273-16ab187bdf40", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', 'text', 'exam', NULL, NULL, NULL, 0, 1, 0)
                
2025-05-17 11:12:52,771 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'published', title = 'HTML MCQS', scheduled_publish_at = NULL WHERE id = 5
2025-05-17 11:12:52,772 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:12:52,797 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:52,802 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:52,871 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:54,969 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:54,981 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:54,987 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:54,998 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:55,011 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:55,022 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:59,955 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:59,968 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:12:59,975 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:12:59,985 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:12:59,998 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:00,016 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:00,740 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:13:00,740 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:43:00.735141+00:00'
        RETURNING id
        
2025-05-17 11:13:00,741 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:13:05,599 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:05,611 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:05,624 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:05,634 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:05,646 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:05,655 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:15,867 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:15,876 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:13:15,876 - api.utils.logging - INFO - Executing operation: 
                UPDATE questions SET blocks = '[{"id": "996a5278-5e7f-4e0f-9e59-b42151a44276", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "e5232a53-6a69-4d75-afa2-23df1ef3b745", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "What does HTML stand for?", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "482ddd9e-5b98-49b7-9afb-d9cc99188d7a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) Hyper Trainer Marking Language\nB) Hyper Text Marketing Language\nC) Hyper Text Markup Language\nD) Hyper Text Marking Language", "styles": {}}], "children": [], "position": 2}, {"id": "bbb056a0-21a8-437b-9229-bfcafb702aa5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', answer = '[{"id": "ec951ec6-541c-4db7-8e5b-94c8523f0529", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "C) Hyper Text Markup Language", "styles": {}}], "children": [], "position": 0}, {"id": "92bff0fc-3897-4a33-8273-16ab187bdf40", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', input_type = 'text', coding_language = NULL, context = NULL WHERE id = 4
                
2025-05-17 11:13:15,876 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET title = 'HTML MCQS', scheduled_publish_at = NULL WHERE id = 5
2025-05-17 11:13:15,877 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:13:15,881 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:15,887 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:15,927 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:15,944 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:15,959 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:15,969 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:15,981 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:15,991 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:18,451 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:18,467 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:18,467 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:18,475 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:18,560 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:18,580 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:25,757 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-17 11:13:25,766 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:13:25,767 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'quiz', 'New Quiz', 'draft')
2025-05-17 11:13:25,767 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-17 11:13:25,768 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 7, 3, 2)
2025-05-17 11:13:25,769 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:13:25,791 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 2 AND t.deleted_at IS NULL
            
2025-05-17 11:13:28,038 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:28,050 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:28,062 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:28,072 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:28,087 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:28,099 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:31,474 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:31,488 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:31,489 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:31,503 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:31,518 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:13:31,528 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:13:34,754 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:34,767 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:13:34,787 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:13:34,798 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:13:34,812 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:13:34,822 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:14:00,741 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:14:00,742 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:44:00.736554+00:00'
        RETURNING id
        
2025-05-17 11:14:00,742 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:14:47,866 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:14:47,874 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:14:47,882 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:14:47,882 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 7)
2025-05-17 11:14:47,883 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 7
2025-05-17 11:14:47,884 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (7, 'objective', '[{"id": "bc1f62f5-dd7a-49ee-97fc-44a57f79961a", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "2. Which tag is used to create a hyperlink in HTML?", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "15d58133-dc4b-4036-a3f3-d408eb444d45", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) ", "styles": {}}, {"type": "text", "text": "<link>\n", "styles": {"code": true}}, {"type": "text", "text": "B) ", "styles": {}}, {"type": "text", "text": "<a>\n", "styles": {"code": true}}, {"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "<href>\n", "styles": {"code": true}}, {"type": "text", "text": "D) ", "styles": {}}, {"type": "text", "text": "<hyper>", "styles": {"code": true}}], "children": [], "position": 1}, {"id": "6f06b484-08a7-468c-9ed9-c615bf403f1b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 2}]', '[{"id": "5c1c8169-5b52-4b42-89a8-2232aa18c5e4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Answer:", "styles": {"bold": true}}, {"type": "text", "text": " B) ", "styles": {}}, {"type": "text", "text": "<a>", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "4e708ac8-283a-4663-8de2-9b4f00dbdafd", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', 'text', 'exam', NULL, NULL, NULL, 0, 1, 0)
                
2025-05-17 11:14:47,886 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (7, 'objective', '[{"id": "f6d5e479-f999-4ce1-990a-97670e3d3d39", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "e54613f8-7638-4c5b-82d0-015050dd8ede", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "3. What is the correct HTML tag for inserting a line break?", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "3bf03ce0-b4fa-4a56-a6b2-7c07eb5e2972", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) ", "styles": {}}, {"type": "text", "text": "<lb>\n", "styles": {"code": true}}, {"type": "text", "text": "B) ", "styles": {}}, {"type": "text", "text": "<break>\n", "styles": {"code": true}}, {"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "<br>\n", "styles": {"code": true}}, {"type": "text", "text": "D) ", "styles": {}}, {"type": "text", "text": "<lnbr>", "styles": {"code": true}}], "children": [], "position": 2}, {"id": "d031b207-fdea-4770-8323-bde42d33aa2a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "8d83adbb-4c26-4a9c-9da9-ea5bdf29516a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "<br>", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "d696da0e-0b73-4594-9f0c-7fbc34af4791", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', 'text', 'exam', NULL, NULL, NULL, 1, 1, 0)
                
2025-05-17 11:14:47,887 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (7, 'objective', '[{"id": "716a6676-5c96-4114-80fb-78aa380951e1", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "974e6d68-c51b-493e-b8bb-7b776f389eb1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "4. Which of the following is the correct way to comment in HTML?", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "dfc5d9c2-1a78-450d-85d4-cac4915adee0", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) ", "styles": {}}, {"type": "text", "text": "// This is a comment\n", "styles": {"code": true}}, {"type": "text", "text": "B) ", "styles": {}}, {"type": "text", "text": "<!-- This is a comment -->\n", "styles": {"code": true}}, {"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "/* This is a comment */\n", "styles": {"code": true}}, {"type": "text", "text": "D) ", "styles": {}}, {"type": "text", "text": "# This is a comment", "styles": {"code": true}}], "children": [], "position": 2}, {"id": "c91ba17b-966c-4c91-aa99-e5b775391850", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "cad1a155-00a2-48be-99a6-3747915c7560", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Answer:", "styles": {"bold": true}}, {"type": "text", "text": " B) ", "styles": {}}, {"type": "text", "text": "<!-- This is a comment -->", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "4a0957f0-2c39-466c-aff4-b02e7f990cdc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', 'text', 'exam', NULL, NULL, NULL, 2, 1, 0)
                
2025-05-17 11:14:47,888 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'draft', title = 'New Quiz', scheduled_publish_at = NULL WHERE id = 7
2025-05-17 11:14:47,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:14:47,911 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:14:47,917 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:14:49,303 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:14:49,317 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:14:49,324 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:14:49,335 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:14:49,348 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:14:49,357 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:14:52,308 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:14:52,316 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:14:52,324 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:14:52,324 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 7)
2025-05-17 11:14:52,325 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 7
2025-05-17 11:14:52,326 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (7, 'objective', '[{"id": "bc1f62f5-dd7a-49ee-97fc-44a57f79961a", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "2. Which tag is used to create a hyperlink in HTML?", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "15d58133-dc4b-4036-a3f3-d408eb444d45", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) ", "styles": {}}, {"type": "text", "text": "<link>\n", "styles": {"code": true}}, {"type": "text", "text": "B) ", "styles": {}}, {"type": "text", "text": "<a>\n", "styles": {"code": true}}, {"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "<href>\n", "styles": {"code": true}}, {"type": "text", "text": "D) ", "styles": {}}, {"type": "text", "text": "<hyper>", "styles": {"code": true}}], "children": [], "position": 1}, {"id": "6f06b484-08a7-468c-9ed9-c615bf403f1b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 2}]', '[{"id": "5c1c8169-5b52-4b42-89a8-2232aa18c5e4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Answer:", "styles": {"bold": true}}, {"type": "text", "text": " B) ", "styles": {}}, {"type": "text", "text": "<a>", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "4e708ac8-283a-4663-8de2-9b4f00dbdafd", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', 'text', 'exam', NULL, NULL, NULL, 0, 1, 0)
                
2025-05-17 11:14:52,326 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (7, 'objective', '[{"id": "f6d5e479-f999-4ce1-990a-97670e3d3d39", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "e54613f8-7638-4c5b-82d0-015050dd8ede", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "3. What is the correct HTML tag for inserting a line break?", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "3bf03ce0-b4fa-4a56-a6b2-7c07eb5e2972", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) ", "styles": {}}, {"type": "text", "text": "<lb>\n", "styles": {"code": true}}, {"type": "text", "text": "B) ", "styles": {}}, {"type": "text", "text": "<break>\n", "styles": {"code": true}}, {"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "<br>\n", "styles": {"code": true}}, {"type": "text", "text": "D) ", "styles": {}}, {"type": "text", "text": "<lnbr>", "styles": {"code": true}}], "children": [], "position": 2}, {"id": "d031b207-fdea-4770-8323-bde42d33aa2a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "8d83adbb-4c26-4a9c-9da9-ea5bdf29516a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "<br>", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "d696da0e-0b73-4594-9f0c-7fbc34af4791", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', 'text', 'exam', NULL, NULL, NULL, 1, 1, 0)
                
2025-05-17 11:14:52,327 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (7, 'objective', '[{"id": "716a6676-5c96-4114-80fb-78aa380951e1", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "974e6d68-c51b-493e-b8bb-7b776f389eb1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "4. Which of the following is the correct way to comment in HTML?", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "dfc5d9c2-1a78-450d-85d4-cac4915adee0", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) ", "styles": {}}, {"type": "text", "text": "// This is a comment\n", "styles": {"code": true}}, {"type": "text", "text": "B) ", "styles": {}}, {"type": "text", "text": "<!-- This is a comment -->\n", "styles": {"code": true}}, {"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "/* This is a comment */\n", "styles": {"code": true}}, {"type": "text", "text": "D) ", "styles": {}}, {"type": "text", "text": "# This is a comment", "styles": {"code": true}}], "children": [], "position": 2}, {"id": "c91ba17b-966c-4c91-aa99-e5b775391850", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "cad1a155-00a2-48be-99a6-3747915c7560", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Answer:", "styles": {"bold": true}}, {"type": "text", "text": " B) ", "styles": {}}, {"type": "text", "text": "<!-- This is a comment -->", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "4a0957f0-2c39-466c-aff4-b02e7f990cdc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', 'text', 'exam', NULL, NULL, NULL, 2, 1, 0)
                
2025-05-17 11:14:52,327 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'published', title = 'New Quiz', scheduled_publish_at = NULL WHERE id = 7
2025-05-17 11:14:52,328 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:14:52,346 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:14:52,351 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:14:52,419 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:14:57,201 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-17 11:14:57,210 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:14:57,210 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'quiz', 'New Quiz', 'draft')
2025-05-17 11:14:57,211 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-17 11:14:57,211 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 8, 3, 3)
2025-05-17 11:14:57,212 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:14:57,239 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 3 AND t.deleted_at IS NULL
            
2025-05-17 11:14:58,637 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:14:58,650 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:14:58,656 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:14:58,667 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:14:58,680 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:14:58,690 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:15:00,749 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:15:00,749 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:45:00.744197+00:00'
        RETURNING id
        
2025-05-17 11:15:00,750 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:16:00,745 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:16:00,745 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:46:00.738880+00:00'
        RETURNING id
        
2025-05-17 11:16:00,745 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:16:33,110 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:33,118 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:33,127 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:16:33,127 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 8)
2025-05-17 11:16:33,127 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 8
2025-05-17 11:16:33,129 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (8, 'objective', '[{"id": "63144729-0d3b-485b-8e4a-2f942145a9c2", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "1. Create a Basic HTML Page with a Title and Paragraph", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "24be9d94-5bfe-4da3-b565-79b74d8c1076", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcdd Problem Statement:", "styles": {}}], "children": [], "position": 1}, {"id": "e36cf066-5814-43b7-99c2-222ab22fdcee", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Create an HTML document that displays the title \u201cWelcome Page\u201d on the browser tab. Inside the body, add a heading \u201cHello, User!\u201d and a paragraph that says \u201cThis is my first HTML page.\u201d", "styles": {}}], "children": [], "position": 2}, {"id": "77a0a10e-9b79-42c0-be3d-6c73cdb33cdf", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [], "children": [], "position": 3}, {"id": "cb78a60f-bd85-4283-84a3-376b155a0134", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 4}]', '[{"id": "8178a537-92aa-49ab-9c82-4d62c605c12b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<!DOCTYPE html>", "styles": {}}], "children": [], "position": 0}, {"id": "6e6315dd-8f9e-4691-9f7c-762e2ad4aebe", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<html>", "styles": {}}], "children": [], "position": 1}, {"id": "f86cd5a7-a0ec-400c-b671-3d9e38bf8dbd", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <head>", "styles": {}}], "children": [], "position": 2}, {"id": "51e378b9-29a6-43e5-901c-435a736a9319", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <title>Welcome Page</title>", "styles": {}}], "children": [], "position": 3}, {"id": "580e841e-e162-4229-b7d2-12cc113d82e4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </head>", "styles": {}}], "children": [], "position": 4}, {"id": "59ddf4a3-a3b4-4f05-8a04-b06aa8f08539", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <body>", "styles": {}}], "children": [], "position": 5}, {"id": "d29a2427-854d-425c-9c99-eb864ed4f2d8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <h1>Hello, User!</h1>", "styles": {}}], "children": [], "position": 6}, {"id": "843a3ca1-b252-4b27-a861-37884efc810b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <p>This is my first HTML page.</p>", "styles": {}}], "children": [], "position": 7}, {"id": "22407ab6-fd79-4ae7-819f-61978b092870", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </body>", "styles": {}}], "children": [], "position": 8}, {"id": "5cec157d-5c85-48fc-9133-f14bcd0f505a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</html>", "styles": {}}], "children": [], "position": 9}, {"id": "d9cdacb0-6a85-412e-a069-338c58fbb923", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 10}]', 'code', 'exam', '["html"]', NULL, NULL, 0, 1, 0)
                
2025-05-17 11:16:33,130 - api.utils.logging - INFO - Executing operation: 
                        INSERT INTO scorecards (org_id, title, criteria) VALUES (1, 'Written Communication', '[{"name": "Relevance", "description": "How relevant is the content to the task?", "min_score": 1.0, "max_score": 5.0}, {"name": "Grammar", "description": "How grammatically correct is the content? Check for grammar, punctuation, syntax and tense errors.", "min_score": 1.0, "max_score": 5.0}, {"name": "Clarity", "description": "How clear is the content? Check for structure, organization, and readability.", "min_score": 1.0, "max_score": 5.0}]')
                        
2025-05-17 11:16:33,130 - api.utils.logging - INFO - Executing operation: 
                    INSERT INTO question_scorecards (question_id, scorecard_id) VALUES (11, 1)
                    
2025-05-17 11:16:33,131 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'draft', title = 'CODE QUESTION', scheduled_publish_at = NULL WHERE id = 8
2025-05-17 11:16:33,131 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:16:33,153 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:33,158 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:16:35,159 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:16:35,178 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:16:35,179 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:35,190 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:16:35,203 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:35,212 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:16:53,698 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:53,710 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:53,720 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:16:53,720 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 8)
2025-05-17 11:16:53,721 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 8
2025-05-17 11:16:53,722 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (8, 'objective', '[{"id": "63144729-0d3b-485b-8e4a-2f942145a9c2", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "1. Create a Basic HTML Page with a Title and Paragraph", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "24be9d94-5bfe-4da3-b565-79b74d8c1076", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcdd Problem Statement:", "styles": {}}], "children": [], "position": 1}, {"id": "e36cf066-5814-43b7-99c2-222ab22fdcee", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Create an HTML document that displays the title \u201cWelcome Page\u201d on the browser tab. Inside the body, add a heading \u201cHello, User!\u201d and a paragraph that says \u201cThis is my first HTML page.\u201d", "styles": {}}], "children": [], "position": 2}, {"id": "77a0a10e-9b79-42c0-be3d-6c73cdb33cdf", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [], "children": [], "position": 3}, {"id": "cb78a60f-bd85-4283-84a3-376b155a0134", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 4}]', '[{"id": "8178a537-92aa-49ab-9c82-4d62c605c12b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<!DOCTYPE html>", "styles": {}}], "children": [], "position": 0}, {"id": "6e6315dd-8f9e-4691-9f7c-762e2ad4aebe", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<html>", "styles": {}}], "children": [], "position": 1}, {"id": "f86cd5a7-a0ec-400c-b671-3d9e38bf8dbd", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <head>", "styles": {}}], "children": [], "position": 2}, {"id": "51e378b9-29a6-43e5-901c-435a736a9319", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <title>Welcome Page</title>", "styles": {}}], "children": [], "position": 3}, {"id": "580e841e-e162-4229-b7d2-12cc113d82e4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </head>", "styles": {}}], "children": [], "position": 4}, {"id": "59ddf4a3-a3b4-4f05-8a04-b06aa8f08539", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <body>", "styles": {}}], "children": [], "position": 5}, {"id": "d29a2427-854d-425c-9c99-eb864ed4f2d8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <h1>Hello, User!</h1>", "styles": {}}], "children": [], "position": 6}, {"id": "843a3ca1-b252-4b27-a861-37884efc810b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <p>This is my first HTML page.</p>", "styles": {}}], "children": [], "position": 7}, {"id": "22407ab6-fd79-4ae7-819f-61978b092870", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </body>", "styles": {}}], "children": [], "position": 8}, {"id": "5cec157d-5c85-48fc-9133-f14bcd0f505a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</html>", "styles": {}}], "children": [], "position": 9}, {"id": "d9cdacb0-6a85-412e-a069-338c58fbb923", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 10}]', 'code', 'exam', '["html"]', NULL, NULL, 0, 1, 0)
                
2025-05-17 11:16:53,722 - api.utils.logging - INFO - Executing operation: 
                    INSERT INTO question_scorecards (question_id, scorecard_id) VALUES (12, 1)
                    
2025-05-17 11:16:53,723 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (8, 'objective', '[{"id": "9440a4d0-5927-4e4f-b1c0-11fd35ae57fc", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "3. Create an Unordered List of Your Favorite Fruits", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "7f0b5173-846e-4add-a770-85bb7ab4ac0d", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcdd Problem Statement:", "styles": {}}], "children": [], "position": 1}, {"id": "6c644369-acd0-4181-a947-c284b8b4733c", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Make a web page with a heading \u201cMy Favorite Fruits\u201d and an unordered list that includes: Apple, Banana, Mango.", "styles": {}}], "children": [], "position": 2}, {"id": "f339674e-6ac7-49c9-8802-7220e74ed10b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "920f77d5-7464-4700-938a-a1191eddaf4f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<!DOCTYPE html>", "styles": {}}], "children": [], "position": 0}, {"id": "3b905c13-484c-4973-aad1-c6b6a80b3c7c", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<html>", "styles": {}}], "children": [], "position": 1}, {"id": "c8de5e26-2be3-4ad1-a0dd-664d84476528", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <body>", "styles": {}}], "children": [], "position": 2}, {"id": "32fe7ada-360b-4481-9bad-c28768f87e09", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <h2>My Favorite Fruits</h2>", "styles": {}}], "children": [], "position": 3}, {"id": "40e0a2dc-1e87-40aa-bd2a-c49d3b567fbf", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <ul>", "styles": {}}], "children": [], "position": 4}, {"id": "929a867d-9f8c-45e4-85a1-50a6ca396eae", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <li>Apple</li>", "styles": {}}], "children": [], "position": 5}, {"id": "a887fcea-982c-4565-8fb9-a23711f55b41", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <li>Banana</li>", "styles": {}}], "children": [], "position": 6}, {"id": "b5215429-2971-4c5c-b3a8-a2ea20037639", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <li>Mango</li>", "styles": {}}], "children": [], "position": 7}, {"id": "cf79a708-1663-43ec-aba6-890f607a7610", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    </ul>", "styles": {}}], "children": [], "position": 8}, {"id": "0b44474a-1f8f-4424-9943-18295a7e0711", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </body>", "styles": {}}], "children": [], "position": 9}, {"id": "f1b039f7-97c5-4c84-afa2-13c92b3c061b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</html>", "styles": {}}], "children": [], "position": 10}, {"id": "731b10c4-e277-4171-839b-2a4b64c62a31", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 11}]', 'code', 'exam', '["html"]', NULL, NULL, 1, 1, 0)
                
2025-05-17 11:16:53,724 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'draft', title = 'CODE QUESTION', scheduled_publish_at = NULL WHERE id = 8
2025-05-17 11:16:53,724 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:16:53,798 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:53,802 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:16:55,935 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:16:55,960 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:16:55,973 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:55,982 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:16:55,997 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:16:56,005 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:17:00,746 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:17:00,746 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:47:00.740167+00:00'
        RETURNING id
        
2025-05-17 11:17:00,747 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:17:15,736 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:17:15,744 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:17:15,752 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:17:15,752 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 8)
2025-05-17 11:17:15,753 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 8
2025-05-17 11:17:15,753 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (8, 'objective', '[{"id": "63144729-0d3b-485b-8e4a-2f942145a9c2", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "1. Create a Basic HTML Page with a Title and Paragraph", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "24be9d94-5bfe-4da3-b565-79b74d8c1076", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcdd Problem Statement:", "styles": {}}], "children": [], "position": 1}, {"id": "e36cf066-5814-43b7-99c2-222ab22fdcee", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Create an HTML document that displays the title \u201cWelcome Page\u201d on the browser tab. Inside the body, add a heading \u201cHello, User!\u201d and a paragraph that says \u201cThis is my first HTML page.\u201d", "styles": {}}], "children": [], "position": 2}, {"id": "77a0a10e-9b79-42c0-be3d-6c73cdb33cdf", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [], "children": [], "position": 3}, {"id": "cb78a60f-bd85-4283-84a3-376b155a0134", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 4}]', '[{"id": "8178a537-92aa-49ab-9c82-4d62c605c12b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<!DOCTYPE html>", "styles": {}}], "children": [], "position": 0}, {"id": "6e6315dd-8f9e-4691-9f7c-762e2ad4aebe", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<html>", "styles": {}}], "children": [], "position": 1}, {"id": "f86cd5a7-a0ec-400c-b671-3d9e38bf8dbd", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <head>", "styles": {}}], "children": [], "position": 2}, {"id": "51e378b9-29a6-43e5-901c-435a736a9319", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <title>Welcome Page</title>", "styles": {}}], "children": [], "position": 3}, {"id": "580e841e-e162-4229-b7d2-12cc113d82e4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </head>", "styles": {}}], "children": [], "position": 4}, {"id": "59ddf4a3-a3b4-4f05-8a04-b06aa8f08539", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <body>", "styles": {}}], "children": [], "position": 5}, {"id": "d29a2427-854d-425c-9c99-eb864ed4f2d8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <h1>Hello, User!</h1>", "styles": {}}], "children": [], "position": 6}, {"id": "843a3ca1-b252-4b27-a861-37884efc810b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <p>This is my first HTML page.</p>", "styles": {}}], "children": [], "position": 7}, {"id": "22407ab6-fd79-4ae7-819f-61978b092870", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </body>", "styles": {}}], "children": [], "position": 8}, {"id": "5cec157d-5c85-48fc-9133-f14bcd0f505a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</html>", "styles": {}}], "children": [], "position": 9}, {"id": "d9cdacb0-6a85-412e-a069-338c58fbb923", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 10}]', 'code', 'exam', '["html"]', NULL, NULL, 0, 1, 0)
                
2025-05-17 11:17:15,754 - api.utils.logging - INFO - Executing operation: 
                    INSERT INTO question_scorecards (question_id, scorecard_id) VALUES (14, 1)
                    
2025-05-17 11:17:15,754 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (8, 'objective', '[{"id": "9440a4d0-5927-4e4f-b1c0-11fd35ae57fc", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "3. Create an Unordered List of Your Favorite Fruits", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "7f0b5173-846e-4add-a770-85bb7ab4ac0d", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcdd Problem Statement:", "styles": {}}], "children": [], "position": 1}, {"id": "6c644369-acd0-4181-a947-c284b8b4733c", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Make a web page with a heading \u201cMy Favorite Fruits\u201d and an unordered list that includes: Apple, Banana, Mango.", "styles": {}}], "children": [], "position": 2}, {"id": "f339674e-6ac7-49c9-8802-7220e74ed10b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "920f77d5-7464-4700-938a-a1191eddaf4f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<!DOCTYPE html>", "styles": {}}], "children": [], "position": 0}, {"id": "3b905c13-484c-4973-aad1-c6b6a80b3c7c", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<html>", "styles": {}}], "children": [], "position": 1}, {"id": "c8de5e26-2be3-4ad1-a0dd-664d84476528", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <body>", "styles": {}}], "children": [], "position": 2}, {"id": "32fe7ada-360b-4481-9bad-c28768f87e09", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <h2>My Favorite Fruits</h2>", "styles": {}}], "children": [], "position": 3}, {"id": "40e0a2dc-1e87-40aa-bd2a-c49d3b567fbf", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <ul>", "styles": {}}], "children": [], "position": 4}, {"id": "929a867d-9f8c-45e4-85a1-50a6ca396eae", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <li>Apple</li>", "styles": {}}], "children": [], "position": 5}, {"id": "a887fcea-982c-4565-8fb9-a23711f55b41", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <li>Banana</li>", "styles": {}}], "children": [], "position": 6}, {"id": "b5215429-2971-4c5c-b3a8-a2ea20037639", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <li>Mango</li>", "styles": {}}], "children": [], "position": 7}, {"id": "cf79a708-1663-43ec-aba6-890f607a7610", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    </ul>", "styles": {}}], "children": [], "position": 8}, {"id": "0b44474a-1f8f-4424-9943-18295a7e0711", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </body>", "styles": {}}], "children": [], "position": 9}, {"id": "f1b039f7-97c5-4c84-afa2-13c92b3c061b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</html>", "styles": {}}], "children": [], "position": 10}, {"id": "731b10c4-e277-4171-839b-2a4b64c62a31", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 11}]', 'code', 'exam', '["html"]', NULL, NULL, 1, 1, 0)
                
2025-05-17 11:17:15,764 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (8, 'objective', '[{"id": "60839656-d07b-4ef0-bec9-782225ba4a60", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "4. Create a Simple Form for Login", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "b1e44607-c41a-4d6e-badd-c382225d2c57", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcdd Problem Statement:", "styles": {}}], "children": [], "position": 1}, {"id": "046ee07d-333e-49ac-8db7-0ccd6a4c62c9", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Design a login form that asks for the user\u2019s email and password. Include a submit button.", "styles": {}}], "children": [], "position": 2}, {"id": "4c1e1614-95a8-4ebd-82b5-2de06b2c63ff", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "9aa3ddd3-9fae-4c4b-9366-79bc7b949d52", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<!DOCTYPE html>", "styles": {}}], "children": [], "position": 0}, {"id": "107bd3ca-5fc6-4fb5-b434-8f9dee60497e", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<html>", "styles": {}}], "children": [], "position": 1}, {"id": "0f172ac3-4f76-41d0-8f9c-7420305b74dc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <body>", "styles": {}}], "children": [], "position": 2}, {"id": "1707ce1b-b32c-4b01-ba74-35f91e522062", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <h2>Login Form</h2>", "styles": {}}], "children": [], "position": 3}, {"id": "93e03eff-4db8-4051-9528-10d27108da46", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <form action=\"/login\" method=\"post\">", "styles": {}}], "children": [], "position": 4}, {"id": "79c462f7-fbf6-4d1f-a1d3-0bd2ac558520", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <label>Email:</label><br>", "styles": {}}], "children": [], "position": 5}, {"id": "1df4c0e4-eed0-4704-95da-81826777df3c", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <input type=\"email\" name=\"email\"><br><br>", "styles": {}}], "children": [], "position": 6}, {"id": "55d8eec1-2c66-49b4-ac78-3357ce130479", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <label>Password:</label><br>", "styles": {}}], "children": [], "position": 7}, {"id": "e3c95cba-e119-4ae4-97ce-29c95e126b92", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <input type=\"password\" name=\"password\"><br><br>", "styles": {}}], "children": [], "position": 8}, {"id": "d88e30c1-7e1b-419a-ab68-241d214be615", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <input type=\"submit\" value=\"Login\">", "styles": {}}], "children": [], "position": 9}, {"id": "461099e8-a622-4dcb-a2a6-422a1e235d00", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    </form>", "styles": {}}], "children": [], "position": 10}, {"id": "861f4067-4251-4610-a7fe-3717d0e9406a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </body>", "styles": {}}], "children": [], "position": 11}, {"id": "d8a1162d-f63d-4b08-b6ec-b78047da2657", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</html>", "styles": {}}], "children": [], "position": 12}, {"id": "e85725ff-43ee-4927-a218-3ca3b2f3dee8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 13}]', 'code', 'exam', '["html"]', NULL, NULL, 2, 1, 0)
                
2025-05-17 11:17:15,765 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'draft', title = 'CODE QUESTION', scheduled_publish_at = NULL WHERE id = 8
2025-05-17 11:17:15,765 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:17:15,793 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:17:15,799 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:17:17,703 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:17:17,730 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:17:17,730 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:17:17,750 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:17:17,848 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:17:17,857 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:17:21,235 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:17:21,248 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:17:21,262 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:17:21,263 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 8)
2025-05-17 11:17:21,263 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 8
2025-05-17 11:17:21,264 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (8, 'objective', '[{"id": "63144729-0d3b-485b-8e4a-2f942145a9c2", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "1. Create a Basic HTML Page with a Title and Paragraph", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "24be9d94-5bfe-4da3-b565-79b74d8c1076", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcdd Problem Statement:", "styles": {}}], "children": [], "position": 1}, {"id": "e36cf066-5814-43b7-99c2-222ab22fdcee", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Create an HTML document that displays the title \u201cWelcome Page\u201d on the browser tab. Inside the body, add a heading \u201cHello, User!\u201d and a paragraph that says \u201cThis is my first HTML page.\u201d", "styles": {}}], "children": [], "position": 2}, {"id": "77a0a10e-9b79-42c0-be3d-6c73cdb33cdf", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [], "children": [], "position": 3}, {"id": "cb78a60f-bd85-4283-84a3-376b155a0134", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 4}]', '[{"id": "8178a537-92aa-49ab-9c82-4d62c605c12b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<!DOCTYPE html>", "styles": {}}], "children": [], "position": 0}, {"id": "6e6315dd-8f9e-4691-9f7c-762e2ad4aebe", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<html>", "styles": {}}], "children": [], "position": 1}, {"id": "f86cd5a7-a0ec-400c-b671-3d9e38bf8dbd", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <head>", "styles": {}}], "children": [], "position": 2}, {"id": "51e378b9-29a6-43e5-901c-435a736a9319", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <title>Welcome Page</title>", "styles": {}}], "children": [], "position": 3}, {"id": "580e841e-e162-4229-b7d2-12cc113d82e4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </head>", "styles": {}}], "children": [], "position": 4}, {"id": "59ddf4a3-a3b4-4f05-8a04-b06aa8f08539", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <body>", "styles": {}}], "children": [], "position": 5}, {"id": "d29a2427-854d-425c-9c99-eb864ed4f2d8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <h1>Hello, User!</h1>", "styles": {}}], "children": [], "position": 6}, {"id": "843a3ca1-b252-4b27-a861-37884efc810b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <p>This is my first HTML page.</p>", "styles": {}}], "children": [], "position": 7}, {"id": "22407ab6-fd79-4ae7-819f-61978b092870", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </body>", "styles": {}}], "children": [], "position": 8}, {"id": "5cec157d-5c85-48fc-9133-f14bcd0f505a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</html>", "styles": {}}], "children": [], "position": 9}, {"id": "d9cdacb0-6a85-412e-a069-338c58fbb923", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 10}]', 'code', 'exam', '["html"]', NULL, NULL, 0, 1, 0)
                
2025-05-17 11:17:21,265 - api.utils.logging - INFO - Executing operation: 
                    INSERT INTO question_scorecards (question_id, scorecard_id) VALUES (17, 1)
                    
2025-05-17 11:17:21,265 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (8, 'objective', '[{"id": "9440a4d0-5927-4e4f-b1c0-11fd35ae57fc", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "3. Create an Unordered List of Your Favorite Fruits", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "7f0b5173-846e-4add-a770-85bb7ab4ac0d", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcdd Problem Statement:", "styles": {}}], "children": [], "position": 1}, {"id": "6c644369-acd0-4181-a947-c284b8b4733c", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Make a web page with a heading \u201cMy Favorite Fruits\u201d and an unordered list that includes: Apple, Banana, Mango.", "styles": {}}], "children": [], "position": 2}, {"id": "f339674e-6ac7-49c9-8802-7220e74ed10b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "920f77d5-7464-4700-938a-a1191eddaf4f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<!DOCTYPE html>", "styles": {}}], "children": [], "position": 0}, {"id": "3b905c13-484c-4973-aad1-c6b6a80b3c7c", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<html>", "styles": {}}], "children": [], "position": 1}, {"id": "c8de5e26-2be3-4ad1-a0dd-664d84476528", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <body>", "styles": {}}], "children": [], "position": 2}, {"id": "32fe7ada-360b-4481-9bad-c28768f87e09", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <h2>My Favorite Fruits</h2>", "styles": {}}], "children": [], "position": 3}, {"id": "40e0a2dc-1e87-40aa-bd2a-c49d3b567fbf", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <ul>", "styles": {}}], "children": [], "position": 4}, {"id": "929a867d-9f8c-45e4-85a1-50a6ca396eae", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <li>Apple</li>", "styles": {}}], "children": [], "position": 5}, {"id": "a887fcea-982c-4565-8fb9-a23711f55b41", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <li>Banana</li>", "styles": {}}], "children": [], "position": 6}, {"id": "b5215429-2971-4c5c-b3a8-a2ea20037639", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <li>Mango</li>", "styles": {}}], "children": [], "position": 7}, {"id": "cf79a708-1663-43ec-aba6-890f607a7610", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    </ul>", "styles": {}}], "children": [], "position": 8}, {"id": "0b44474a-1f8f-4424-9943-18295a7e0711", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </body>", "styles": {}}], "children": [], "position": 9}, {"id": "f1b039f7-97c5-4c84-afa2-13c92b3c061b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</html>", "styles": {}}], "children": [], "position": 10}, {"id": "731b10c4-e277-4171-839b-2a4b64c62a31", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 11}]', 'code', 'exam', '["html"]', NULL, NULL, 1, 1, 0)
                
2025-05-17 11:17:21,266 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (8, 'objective', '[{"id": "60839656-d07b-4ef0-bec9-782225ba4a60", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "4. Create a Simple Form for Login", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "b1e44607-c41a-4d6e-badd-c382225d2c57", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "\ud83d\udcdd Problem Statement:", "styles": {}}], "children": [], "position": 1}, {"id": "046ee07d-333e-49ac-8db7-0ccd6a4c62c9", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Design a login form that asks for the user\u2019s email and password. Include a submit button.", "styles": {}}], "children": [], "position": 2}, {"id": "4c1e1614-95a8-4ebd-82b5-2de06b2c63ff", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', '[{"id": "9aa3ddd3-9fae-4c4b-9366-79bc7b949d52", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<!DOCTYPE html>", "styles": {}}], "children": [], "position": 0}, {"id": "107bd3ca-5fc6-4fb5-b434-8f9dee60497e", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "<html>", "styles": {}}], "children": [], "position": 1}, {"id": "0f172ac3-4f76-41d0-8f9c-7420305b74dc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  <body>", "styles": {}}], "children": [], "position": 2}, {"id": "1707ce1b-b32c-4b01-ba74-35f91e522062", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <h2>Login Form</h2>", "styles": {}}], "children": [], "position": 3}, {"id": "93e03eff-4db8-4051-9528-10d27108da46", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    <form action=\"/login\" method=\"post\">", "styles": {}}], "children": [], "position": 4}, {"id": "79c462f7-fbf6-4d1f-a1d3-0bd2ac558520", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <label>Email:</label><br>", "styles": {}}], "children": [], "position": 5}, {"id": "1df4c0e4-eed0-4704-95da-81826777df3c", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <input type=\"email\" name=\"email\"><br><br>", "styles": {}}], "children": [], "position": 6}, {"id": "55d8eec1-2c66-49b4-ac78-3357ce130479", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <label>Password:</label><br>", "styles": {}}], "children": [], "position": 7}, {"id": "e3c95cba-e119-4ae4-97ce-29c95e126b92", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <input type=\"password\" name=\"password\"><br><br>", "styles": {}}], "children": [], "position": 8}, {"id": "d88e30c1-7e1b-419a-ab68-241d214be615", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "      <input type=\"submit\" value=\"Login\">", "styles": {}}], "children": [], "position": 9}, {"id": "461099e8-a622-4dcb-a2a6-422a1e235d00", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "    </form>", "styles": {}}], "children": [], "position": 10}, {"id": "861f4067-4251-4610-a7fe-3717d0e9406a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "  </body>", "styles": {}}], "children": [], "position": 11}, {"id": "d8a1162d-f63d-4b08-b6ec-b78047da2657", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "</html>", "styles": {}}], "children": [], "position": 12}, {"id": "e85725ff-43ee-4927-a218-3ca3b2f3dee8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 13}]', 'code', 'exam', '["html"]', NULL, NULL, 2, 1, 0)
                
2025-05-17 11:17:21,277 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'published', title = 'CODE QUESTION', scheduled_publish_at = NULL WHERE id = 8
2025-05-17 11:17:21,277 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:17:21,302 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:17:21,307 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:17:21,372 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:17:25,097 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:17:25,108 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:17:25,121 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:17:25,132 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:17:25,149 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:17:25,158 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 5 ORDER BY position ASC
            
2025-05-17 11:17:32,395 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:17:32,395 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks SET deleted_at = '2025-05-17 11:17:32.389439' WHERE id = 5 AND deleted_at IS NULL
        
2025-05-17 11:17:32,396 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:17:33,634 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:17:33,648 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:17:33,661 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:17:33,670 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:17:33,684 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:17:33,693 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:17:37,129 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:17:37,161 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:17:37,191 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:17:37,202 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:17:37,216 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:17:37,226 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:18:00,739 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:18:00,739 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:48:00.734333+00:00'
        RETURNING id
        
2025-05-17 11:18:00,740 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:18:09,469 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:18:09,486 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:18:09,487 - api.utils.logging - INFO - Executing operation: 
                UPDATE questions SET blocks = '[{"id": "bc1f62f5-dd7a-49ee-97fc-44a57f79961a", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "1. Which tag is used to create a hyperlink in HTML?", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "15d58133-dc4b-4036-a3f3-d408eb444d45", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) ", "styles": {}}, {"type": "text", "text": "<link>\n", "styles": {"code": true}}, {"type": "text", "text": "B) ", "styles": {}}, {"type": "text", "text": "<a>\n", "styles": {"code": true}}, {"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "<href>\n", "styles": {"code": true}}, {"type": "text", "text": "D) ", "styles": {}}, {"type": "text", "text": "<hyper>", "styles": {"code": true}}], "children": [], "position": 1}, {"id": "6f06b484-08a7-468c-9ed9-c615bf403f1b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 2}]', answer = '[{"id": "5c1c8169-5b52-4b42-89a8-2232aa18c5e4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Answer:", "styles": {"bold": true}}, {"type": "text", "text": " B) ", "styles": {}}, {"type": "text", "text": "<a>", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "4e708ac8-283a-4663-8de2-9b4f00dbdafd", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', input_type = 'text', coding_language = NULL, context = NULL WHERE id = 8
                
2025-05-17 11:18:09,487 - api.utils.logging - INFO - Executing operation: 
                UPDATE questions SET blocks = '[{"id": "f6d5e479-f999-4ce1-990a-97670e3d3d39", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "e54613f8-7638-4c5b-82d0-015050dd8ede", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "2. What is the correct HTML tag for inserting a line break?", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "3bf03ce0-b4fa-4a56-a6b2-7c07eb5e2972", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) ", "styles": {}}, {"type": "text", "text": "<lb>\n", "styles": {"code": true}}, {"type": "text", "text": "B) ", "styles": {}}, {"type": "text", "text": "<break>\n", "styles": {"code": true}}, {"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "<br>\n", "styles": {"code": true}}, {"type": "text", "text": "D) ", "styles": {}}, {"type": "text", "text": "<lnbr>", "styles": {"code": true}}], "children": [], "position": 2}, {"id": "d031b207-fdea-4770-8323-bde42d33aa2a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', answer = '[{"id": "8d83adbb-4c26-4a9c-9da9-ea5bdf29516a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "<br>", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "d696da0e-0b73-4594-9f0c-7fbc34af4791", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', input_type = 'text', coding_language = NULL, context = NULL WHERE id = 9
                
2025-05-17 11:18:09,488 - api.utils.logging - INFO - Executing operation: 
                UPDATE questions SET blocks = '[{"id": "716a6676-5c96-4114-80fb-78aa380951e1", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [], "children": [], "position": 0}, {"id": "974e6d68-c51b-493e-b8bb-7b776f389eb1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "3. Which of the following is the correct way to comment in HTML?", "styles": {"bold": true}}], "children": [], "position": 1}, {"id": "dfc5d9c2-1a78-450d-85d4-cac4915adee0", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "A) ", "styles": {}}, {"type": "text", "text": "// This is a comment\n", "styles": {"code": true}}, {"type": "text", "text": "B) ", "styles": {}}, {"type": "text", "text": "<!-- This is a comment -->\n", "styles": {"code": true}}, {"type": "text", "text": "C) ", "styles": {}}, {"type": "text", "text": "/* This is a comment */\n", "styles": {"code": true}}, {"type": "text", "text": "D) ", "styles": {}}, {"type": "text", "text": "# This is a comment", "styles": {"code": true}}], "children": [], "position": 2}, {"id": "c91ba17b-966c-4c91-aa99-e5b775391850", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 3}]', answer = '[{"id": "cad1a155-00a2-48be-99a6-3747915c7560", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Answer:", "styles": {"bold": true}}, {"type": "text", "text": " B) ", "styles": {}}, {"type": "text", "text": "<!-- This is a comment -->", "styles": {"code": true}}], "children": [], "position": 0}, {"id": "4a0957f0-2c39-466c-aff4-b02e7f990cdc", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', input_type = 'text', coding_language = NULL, context = NULL WHERE id = 10
                
2025-05-17 11:18:09,497 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET title = 'New Quiz', scheduled_publish_at = NULL WHERE id = 7
2025-05-17 11:18:09,498 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:18:09,520 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:18:09,526 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:18:09,584 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:18:09,600 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:18:09,614 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:18:09,626 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:18:09,643 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:18:09,653 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:18:12,099 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:18:12,111 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:18:12,117 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:18:12,127 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:18:12,141 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:18:12,150 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:18:15,468 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:18:15,481 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:18:15,482 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:18:15,493 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:18:15,508 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 8 AND deleted_at IS NULL
        
2025-05-17 11:18:15,518 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 8 ORDER BY position ASC
            
2025-05-17 11:18:56,286 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-17 11:18:56,294 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:18:56,294 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'quiz', 'New Quiz', 'draft')
2025-05-17 11:18:56,295 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-17 11:18:56,296 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 9, 3, 4)
2025-05-17 11:18:56,296 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:18:56,322 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 4 AND t.deleted_at IS NULL
            
2025-05-17 11:18:59,295 - api.utils.logging - INFO - Executing operation: SELECT task_id, milestone_id, ordering FROM course_tasks WHERE course_id = 3 AND task_id IN (8, 9)
2025-05-17 11:18:59,308 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:18:59,308 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 4 WHERE id = 8
2025-05-17 11:18:59,308 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 3 WHERE id = 9
2025-05-17 11:18:59,308 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:19:00,503 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:19:00,522 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:19:00,535 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 9 AND deleted_at IS NULL
        
2025-05-17 11:19:00,547 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 9 ORDER BY position ASC
            
2025-05-17 11:19:00,560 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 9 AND deleted_at IS NULL
        
2025-05-17 11:19:00,571 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 9 ORDER BY position ASC
            
2025-05-17 11:19:00,750 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:19:00,750 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:49:00.744618+00:00'
        RETURNING id
        
2025-05-17 11:19:00,751 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:19:26,657 - api.utils.logging - INFO - Executing operation: SELECT task_id, milestone_id, ordering FROM course_tasks WHERE course_id = 3 AND task_id IN (8, 9)
2025-05-17 11:19:26,671 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:19:26,671 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 3 WHERE id = 8
2025-05-17 11:19:26,671 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 4 WHERE id = 9
2025-05-17 11:19:26,672 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:19:28,323 - api.utils.logging - INFO - Executing operation: SELECT task_id, milestone_id, ordering FROM course_tasks WHERE course_id = 3 AND task_id IN (9, 8)
2025-05-17 11:19:28,336 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:19:28,337 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 4 WHERE id = 8
2025-05-17 11:19:28,337 - api.utils.logging - INFO - Executing operation: UPDATE course_tasks SET ordering = 3 WHERE id = 9
2025-05-17 11:19:28,337 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:19:35,768 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:19:35,768 - api.utils.logging - INFO - Executing operation: UPDATE milestones SET name = 'PP332211SPRINT I' WHERE id = 3
2025-05-17 11:19:35,769 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:19:37,927 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 11:19:37,943 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:19:37,944 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 11:19:37,956 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 11:19:37,970 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 11:19:37,986 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:19:38,002 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:19:38,003 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:19:38,018 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:19:38,047 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:19:42,726 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-17 11:19:42,740 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:19:42,746 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-17 11:19:42,776 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:19:42,801 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:19:42,830 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-17 11:19:42,834 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:19:42,847 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:19:42,880 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-17 11:19:42,880 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-17 11:19:42,910 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-17 11:19:42,916 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-17 11:19:42,936 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:19:42,940 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-17 11:19:42,959 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:19:42,961 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-17 11:19:42,970 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:19:42,971 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-17 11:19:42,985 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:19:43,005 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:19:43,009 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 1
2025-05-17 11:19:43,040 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 1 ORDER BY cm.ordering
2025-05-17 11:19:43,053 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 1 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:19:43,126 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-17 11:19:43,135 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-17 11:19:43,136 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-17 11:19:43,164 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-17 11:19:43,168 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-17 11:19:43,182 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-17 11:19:43,193 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-17 11:19:43,231 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-17 11:19:43,243 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-17 11:20:00,749 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:20:00,749 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:50:00.743672+00:00'
        RETURNING id
        
2025-05-17 11:20:00,750 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:24:20,624 - api.utils.logging - INFO - Logging system initialized
2025-05-17 11:24:21,294 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-17 11:24:21,299 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-17 11:24:31,298 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:24:31,307 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:24:31,310 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-17 11:24:31,315 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:24:31,320 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:24:31,322 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-17 11:24:31,323 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-17 11:24:31,323 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-17 11:24:59,113 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:24:59,149 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:24:59,246 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:24:59,264 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:24:59,284 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:24:59,315 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 11:24:59,333 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:24:59,345 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:24:59,407 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-17 11:24:59,409 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:24:59,420 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:25:20,887 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:25:20,892 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:55:20.881399+00:00'
        RETURNING id
        
2025-05-17 11:25:20,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:25:21,716 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-17 11:25:21,724 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:25:21,724 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'learning_material', 'New Learning Material', 'draft')
2025-05-17 11:25:21,726 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-17 11:25:21,726 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 10, 3, 5)
2025-05-17 11:25:21,727 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:25:21,750 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 5 AND t.deleted_at IS NULL
            
2025-05-17 11:25:24,248 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 10 AND deleted_at IS NULL
        
2025-05-17 11:25:24,257 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 10
2025-05-17 11:25:33,789 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-17 11:25:33,796 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:25:33,796 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'quiz', 'New Quiz', 'draft')
2025-05-17 11:25:33,797 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-17 11:25:33,797 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 11, 3, 6)
2025-05-17 11:25:33,798 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:25:33,817 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 6 AND t.deleted_at IS NULL
            
2025-05-17 11:25:37,278 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:25:37,291 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:25:37,295 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 11 AND deleted_at IS NULL
        
2025-05-17 11:25:37,305 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 11 ORDER BY position ASC
            
2025-05-17 11:25:37,320 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 11 AND deleted_at IS NULL
        
2025-05-17 11:25:37,331 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 11 ORDER BY position ASC
            
2025-05-17 11:26:20,870 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:26:20,871 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:56:20.864982+00:00'
        RETURNING id
        
2025-05-17 11:26:20,872 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:26:49,334 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 11 AND deleted_at IS NULL
        
2025-05-17 11:26:49,344 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 11 AND deleted_at IS NULL
        
2025-05-17 11:26:49,353 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:26:49,353 - api.utils.logging - INFO - Executing operation: DELETE FROM question_scorecards WHERE question_id IN (SELECT id FROM questions WHERE task_id = 11)
2025-05-17 11:26:49,354 - api.utils.logging - INFO - Executing operation: DELETE FROM questions WHERE task_id = 11
2025-05-17 11:26:49,357 - api.utils.logging - INFO - Executing operation: 
                INSERT INTO questions (task_id, type, blocks, answer, input_type, response_type, coding_language, generation_model, context, position, max_attempts, is_feedback_shown) VALUES (11, 'objective', '[{"id": "c385f220-e18f-4814-8f39-88559cf56f06", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "print hello world", "styles": {}}], "children": [], "position": 0}, {"id": "90e6d2c1-1c91-4a0b-86ed-d0cc416d23d7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 1}]', NULL, 'code', 'chat', '["html"]', NULL, NULL, 0, NULL, 1)
                
2025-05-17 11:26:49,358 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET status = 'draft', title = 'New Quiz', scheduled_publish_at = NULL WHERE id = 11
2025-05-17 11:26:49,359 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:26:49,388 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 11 AND deleted_at IS NULL
        
2025-05-17 11:26:49,394 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 11 ORDER BY position ASC
            
2025-05-17 11:27:10,609 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:27:10,609 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:27:10,630 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:27:10,637 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:27:10,646 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:27:10,655 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:27:11,727 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:27:11,743 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:27:16,293 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:27:16,305 - api.utils.logging - INFO - Executing operation: SELECT id, title, criteria FROM scorecards WHERE org_id = 1
2025-05-17 11:27:16,318 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 11 AND deleted_at IS NULL
        
2025-05-17 11:27:16,328 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 11 ORDER BY position ASC
            
2025-05-17 11:27:16,344 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 11 AND deleted_at IS NULL
        
2025-05-17 11:27:16,354 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 11 ORDER BY position ASC
            
2025-05-17 11:27:20,874 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:27:20,874 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:57:20.867771+00:00'
        RETURNING id
        
2025-05-17 11:27:20,877 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:27:40,524 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:27:40,533 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:27:41,998 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-17 11:27:42,000 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:27:42,021 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:27:42,030 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, uc.role
            FROM cohorts c
            JOIN user_cohorts uc ON c.id = uc.cohort_id
            WHERE uc.user_id = 1 AND c.org_id = 1
2025-05-17 11:27:42,054 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE slug = 'agiletribers'
2025-05-17 11:27:42,110 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:27:42,121 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:27:42,163 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-17 11:27:42,182 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (1) AND task_id IS NOT NULL
        
2025-05-17 11:27:42,193 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (1) AND question_id IS NOT NULL
        
2025-05-17 11:27:42,205 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-17 11:27:42,215 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-17 11:27:42,228 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-17 11:27:42,230 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-17 11:27:42,247 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:27:42,258 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-17 11:27:42,270 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-17 11:27:42,282 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:27:42,293 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 1
2025-05-17 11:27:42,303 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 1 ORDER BY cm.ordering
2025-05-17 11:27:42,312 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 1 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-17 11:27:42,389 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-17 11:27:42,397 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-17 11:27:42,425 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-17 11:27:42,452 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-17 11:27:42,453 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-17 11:27:42,467 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-17 11:27:42,482 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-17 11:27:42,524 - api.utils.logging - INFO - Executing operation: 
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM chat_history
    WHERE user_id = 1 AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    UNION
    
    SELECT MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
    FROM task_completions
    WHERE user_id = 1 AND task_id IN (
        SELECT task_id FROM course_tasks 
        WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
    )
    GROUP BY DATE(datetime(created_at, '+5 hours', '+30 minutes'))
    
    ORDER BY created_at DESC
    
2025-05-17 11:27:42,535 - api.utils.logging - INFO - Executing operation: 
    WITH chat_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM chat_history
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days') 
        AND question_id IN (
            SELECT question_id 
            FROM questions 
            WHERE task_id IN (
                SELECT task_id 
                FROM course_tasks 
                WHERE course_id IN (
                    SELECT course_id 
                    FROM course_cohorts 
                    WHERE cohort_id = 1
                )
            )
        )
        GROUP BY activity_date
    ),
    task_activity AS (
        SELECT DATE(datetime(created_at, '+5 hours', '+30 minutes')) as activity_date, COUNT(*) as count
        FROM task_completions
        WHERE user_id = 1 
        AND DATE(datetime(created_at, '+5 hours', '+30 minutes')) >= DATE(datetime('now', '+5 hours', '+30 minutes'), '-3 days')
        AND task_id IN (
            SELECT task_id 
            FROM course_tasks 
            WHERE course_id IN (
                SELECT course_id 
                FROM course_cohorts 
                WHERE cohort_id = 1
            )
        )
        GROUP BY activity_date
    )
    SELECT activity_date, count FROM chat_activity
    UNION
    SELECT activity_date, count FROM task_activity
    ORDER BY activity_date
    
2025-05-17 11:28:20,873 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:28:20,873 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:58:20.867307+00:00'
        RETURNING id
        
2025-05-17 11:28:20,874 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:29:09,564 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:29:09,572 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:29:19,902 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:29:19,910 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:29:20,248 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:29:20,256 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:29:20,862 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:29:20,863 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 05:59:20.857234+00:00'
        RETURNING id
        
2025-05-17 11:29:20,864 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:29:43,371 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-17 11:29:43,380 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-17 11:30:20,872 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:30:20,872 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 06:00:20.865130+00:00'
        RETURNING id
        
2025-05-17 11:30:20,876 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:31:11,968 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-17 11:31:11,977 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-17 11:31:20,874 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:31:20,874 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 06:01:20.869028+00:00'
        RETURNING id
        
2025-05-17 11:31:20,875 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:31:54,988 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:31:55,000 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:31:55,002 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-17 11:31:55,009 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:31:55,018 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:31:55,021 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-17 11:31:55,021 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-17 11:31:55,022 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-17 11:32:01,970 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:32:01,997 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:32:02,041 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 11:32:02,055 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:32:02,068 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-17 11:32:02,085 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 11:32:02,099 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-17 11:32:02,112 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:32:02,128 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-17 11:32:02,143 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:32:02,158 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-17 11:32:02,186 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-17 11:32:20,872 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:32:20,872 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 06:02:20.866218+00:00'
        RETURNING id
        
2025-05-17 11:32:20,882 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:33:20,867 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:33:20,868 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 06:03:20.860899+00:00'
        RETURNING id
        
2025-05-17 11:33:20,868 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:34:20,877 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:34:20,877 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 06:04:20.871477+00:00'
        RETURNING id
        
2025-05-17 11:34:20,878 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-17 11:35:20,867 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-17 11:35:20,867 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-17 06:05:20.861214+00:00'
        RETURNING id
        
2025-05-17 11:35:20,868 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 09:52:15,585 - api.utils.logging - INFO - Logging system initialized
2025-05-19 09:52:16,776 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-19 09:52:16,778 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-19 09:52:55,351 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 09:52:55,354 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 09:52:55,357 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 09:52:55,359 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 09:52:55,360 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 09:52:55,361 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 09:52:55,362 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 09:52:55,374 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 09:53:12,447 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 09:53:12,454 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 09:53:12,500 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 09:53:12,509 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 09:53:12,533 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 09:53:12,552 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 09:53:12,564 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 09:53:12,580 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 09:53:12,593 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 09:53:12,601 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 09:53:12,611 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 09:53:15,867 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 09:53:15,868 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:23:15.862625+00:00'
        RETURNING id
        
2025-05-19 09:53:15,871 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 09:53:23,522 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 09:53:23,529 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 09:53:42,466 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 09:53:42,470 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 09:53:42,473 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 09:53:42,476 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 09:53:42,478 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 09:53:42,485 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 09:53:43,228 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 09:53:43,238 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 09:53:46,022 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 09:53:46,027 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 09:53:46,364 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 09:53:46,373 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 09:53:46,377 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 09:53:46,389 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 09:54:15,867 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 09:54:15,868 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:24:15.862842+00:00'
        RETURNING id
        
2025-05-19 09:54:15,870 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 09:55:15,857 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 09:55:15,858 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:25:15.853811+00:00'
        RETURNING id
        
2025-05-19 09:55:15,858 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 09:56:15,871 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 09:56:15,871 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:26:15.866380+00:00'
        RETURNING id
        
2025-05-19 09:56:15,872 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 09:57:15,865 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 09:57:15,865 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:27:15.860286+00:00'
        RETURNING id
        
2025-05-19 09:57:15,866 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 09:58:15,862 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 09:58:15,862 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:28:15.855921+00:00'
        RETURNING id
        
2025-05-19 09:58:15,864 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 09:59:15,868 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 09:59:15,869 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:29:15.865156+00:00'
        RETURNING id
        
2025-05-19 09:59:15,869 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:00:15,871 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:00:15,872 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:30:15.859855+00:00'
        RETURNING id
        
2025-05-19 10:00:15,872 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:01:15,880 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:01:15,880 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:31:15.875768+00:00'
        RETURNING id
        
2025-05-19 10:01:15,881 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:02:15,870 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:02:15,871 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:32:15.866827+00:00'
        RETURNING id
        
2025-05-19 10:02:15,872 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:03:15,870 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:03:15,871 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:33:15.866383+00:00'
        RETURNING id
        
2025-05-19 10:03:15,871 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:04:15,862 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:04:15,862 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:34:15.858524+00:00'
        RETURNING id
        
2025-05-19 10:04:15,863 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:04:36,926 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:04:36,932 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:04:36,961 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:04:36,971 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:04:37,159 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:04:37,165 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:05:15,864 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:05:15,872 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:35:15.860813+00:00'
        RETURNING id
        
2025-05-19 10:05:15,873 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:06:04,596 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-19 10:06:04,603 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-19 10:06:09,041 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:06:09,056 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:06:09,076 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:06:09,080 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:06:09,083 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:06:09,095 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:06:15,859 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:06:15,859 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:36:15.855220+00:00'
        RETURNING id
        
2025-05-19 10:06:15,859 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:06:42,872 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-19 10:06:42,880 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-19 10:07:04,300 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:07:04,307 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:07:04,625 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:07:04,635 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:07:04,637 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:07:04,644 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:07:15,862 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:07:15,862 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:37:15.858936+00:00'
        RETURNING id
        
2025-05-19 10:07:15,863 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:07:24,417 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 10 AND deleted_at IS NULL
        
2025-05-19 10:07:24,422 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 10
2025-05-19 10:08:13,294 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 10 AND deleted_at IS NULL
        
2025-05-19 10:08:13,302 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:08:13,304 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Learning Material Editor!", "type": "text", "styles": {}}], "id": "346ae060-0694-4c86-852b-782b366fe114", "position": 0}, {"type": "paragraph", "content": [{"text": "This is where you will create your learning material. You can either modify this template or remove it entirely to start from scratch.", "type": "text", "styles": {}}], "id": "4e794517-3686-47d0-a22f-b1aa952aeb46", "position": 1}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "7bd2c888-fc3c-4793-abd2-bed500e1f9e8", "position": 2}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Key Features", "type": "text", "styles": {}}], "id": "9d0c5e3e-bff8-4d74-bae0-a25f5ad372a6", "position": 3}, {"type": "bulletListItem", "content": [{"text": "Add new blocks by clicking the + icon that appears between blocks", "type": "text", "styles": {}}], "id": "7b8eb71b-ce38-4d2a-90d8-e8db9c4518e7", "position": 4}, {"type": "bulletListItem", "content": [{"text": "Reorder blocks using the side menu (hover near the left edge of any block and drag the button with 6 dots to reorder)", "type": "text", "styles": {}}], "id": "c0f94c11-050b-4b97-bc4f-1444a6686ce9", "position": 5}, {"type": "bulletListItem", "content": [{"text": "Format text using the toolbar that appears when you select text", "type": "text", "styles": {}}], "id": "cf61f6b4-eca3-402d-ae04-57d64211842d", "position": 6}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "099dc662-dc2e-474c-942e-d2ed7f95e57b", "position": 7}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "id": "4441c7e1-2ffe-45d9-9933-dd38f278ad0b", "position": 8}, {"type": "paragraph", "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "id": "75a0c6bf-d11f-429f-90f6-09aed199a91a", "position": 9}, {"type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "id": "a203fd05-41c3-4a8e-90b1-658c92e6e9f8", "position": 10}, {"type": "bulletListItem", "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "id": "b126781f-66d3-4062-830d-62aa960139e8", "position": 11}, {"type": "numberedListItem", "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "id": "d2b555c3-a8cb-47c1-9ec2-d2411798b3fe", "position": 12}, {"type": "checkListItem", "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "id": "00911231-22fb-4d9d-b62b-5615db7f6e6f", "position": 13}, {"type": "paragraph", "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "id": "72802a3c-92a7-4379-9fcc-e56aecc48358", "position": 14}, {"type": "paragraph", "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "id": "cb87ed55-5346-4351-862e-bf153c5b160d", "position": 15}, {"type": "paragraph", "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "id": "fa69474b-379e-46c1-aea9-a12e235236fa", "position": 16}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "feffd1b3-49bb-48eb-b707-a1407b9ce3aa", "position": 17}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "id": "91e3e1b2-da16-47c5-8e9c-6aea62ada295", "position": 18}, {"type": "paragraph", "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "id": "058f33d7-1f73-44e6-96a1-fd3128bdc797", "position": 19}, {"type": "bulletListItem", "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "id": "3e477ad1-fad5-420c-80a7-1776f1fdfcc7", "position": 20}, {"type": "bulletListItem", "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "id": "ab2fbf10-f7b1-4880-a6b8-4f4942f5e4ca", "position": 21}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "ea5535e7-f418-4a99-a092-b443b93665a3", "position": 22}, {"type": "paragraph", "content": [{"text": "Here are examples of nested content:", "type": "text", "styles": {}}], "id": "d8e7101c-143f-4a08-8c95-c879ec37eda7", "position": 23}, {"type": "paragraph", "content": [{"text": "Nested Lists Example", "type": "text", "styles": {"bold": true}}], "id": "b8f10ba6-d000-4f10-ae22-dfd44fae1e8f", "position": 24}, {"type": "bulletListItem", "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "id": "992ab355-ca42-4948-9bf6-b98871bccb40", "position": 25}, {"type": "bulletListItem", "content": [{"text": "Main topic 2", "type": "text", "styles": {}}], "id": "9441a438-c66d-44da-80d7-404ca9d5b096", "position": 26}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "bf2030c4-db35-4ebb-bd6f-e1cf3ded58d5", "position": 27}, {"type": "paragraph", "content": [{"text": "Nested Numbered Lists", "type": "text", "styles": {"bold": true}}], "id": "1e1ff8a5-af61-4ca4-9ef1-02b1273d6125", "position": 28}, {"type": "numberedListItem", "content": [{"text": "First step", "type": "text", "styles": {}}], "children": [{"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.1 (indented with Tab)", "type": "text", "styles": {}}]}, {"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.2", "type": "text", "styles": {}}]}], "id": "388de196-6b53-4dc3-9d57-b32534fd7580", "position": 29}, {"type": "numberedListItem", "content": [{"text": "Second step", "type": "text", "styles": {}}], "id": "6a4a40d6-453e-4b70-b098-443dfa16944c", "position": 30}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "5bb4e1cb-04e7-49e9-a9a9-a448f8eb4f27", "position": 31}, {"type": "paragraph", "content": [{"text": "Tips for working with nested content:", "type": "text", "styles": {"bold": true}}], "id": "21155648-b203-4803-ab22-3cc83770d896", "position": 32}, {"type": "bulletListItem", "content": [{"text": "To unnest/outdent an item, press Shift+Tab", "type": "text", "styles": {}}], "id": "ed1dae24-9e77-4f2d-aedd-073722abaec1", "position": 33}, {"type": "bulletListItem", "content": [{"text": "You can mix bullet and numbered lists in your nesting hierarchy", "type": "text", "styles": {}}], "id": "514b4e48-7b3e-4ccd-ae0e-89191ef30eed", "position": 34}, {"type": "bulletListItem", "content": [{"text": "Nesting helps create a clear organizational structure for complex topics", "type": "text", "styles": {}}], "id": "7821e935-a942-452f-8961-122c5442dfe4", "position": 35}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "9221f6c1-70df-47fe-9d33-f40ee0d45897", "position": 36}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Publishing Your Content", "type": "text", "styles": {}}], "id": "7848a272-800b-44fc-abdf-13e7ee2eb45b", "position": 37}, {"type": "paragraph", "content": [{"text": "When you are ready to make your content available to learners, click the Publish button. You can always edit and republish your content later.", "type": "text", "styles": {}}], "id": "096c0039-445b-49c8-8abe-84d892ccfa7e", "position": 38}, {"type": "paragraph", "content": [{"text": "Feel free to delete or modify this template to create your own learning material!", "type": "text", "styles": {}}], "id": "13bdb6f6-3ecd-4db1-a83f-22b00b5078db", "position": 39}]', status = 'draft', title = 'Module 1: Introduction to Frontend Development', scheduled_publish_at = NULL WHERE id = 10
2025-05-19 10:08:13,305 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:08:13,321 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 10 AND deleted_at IS NULL
        
2025-05-19 10:08:13,325 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 10
2025-05-19 10:08:15,872 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:08:15,872 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:38:15.858447+00:00'
        RETURNING id
        
2025-05-19 10:08:15,875 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:08:17,103 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:08:17,108 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:08:19,736 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:08:19,742 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:08:19,754 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 10:08:19,758 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:08:19,761 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 10:08:19,763 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 10:08:19,763 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 10:08:19,763 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 10:08:22,271 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:08:22,283 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:08:22,327 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:08:22,333 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:08:22,337 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:08:22,356 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:08:22,357 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:08:22,365 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:08:22,374 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:08:22,379 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:08:22,400 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:08:24,485 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 10 AND deleted_at IS NULL
        
2025-05-19 10:08:24,490 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 10
2025-05-19 10:08:24,499 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 10 AND deleted_at IS NULL
        
2025-05-19 10:08:24,504 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 10
2025-05-19 10:09:15,860 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:09:15,860 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:39:15.856675+00:00'
        RETURNING id
        
2025-05-19 10:09:15,861 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:10:15,870 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:10:15,870 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:40:15.866360+00:00'
        RETURNING id
        
2025-05-19 10:10:15,871 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:11:15,857 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:11:15,857 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:41:15.853165+00:00'
        RETURNING id
        
2025-05-19 10:11:15,858 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:11:50,701 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 10 AND deleted_at IS NULL
        
2025-05-19 10:11:50,706 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:11:50,706 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "13749787-6a55-4575-8ad8-70d50e3f00a3", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0baa\u0bbe\u0b95\u0bae\u0bcd 1: \u0bae\u0bc1\u0ba9\u0bcd\u0bae\u0bca\u0bb4\u0bbf \u0b89\u0bb3\u0bcd\u0bb3\u0b9f\u0b95\u0bcd\u0b95\u0bae\u0bcd", "styles": {"bold": true}}], "children": [], "position": 0}, {"id": "b63c9383-373c-4cc4-8ad0-41c5ee9c5954", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\ud83c\udfaf \u0b87\u0bb2\u0b95\u0bcd\u0b95\u0bae\u0bcd:\n\u0bae\u0bc1\u0ba9\u0bcd\u0bae\u0bca\u0bb4\u0bbf \u0bae\u0bc7\u0bae\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bae\u0bcd \u0b8e\u0ba9\u0bcd\u0ba9\u0bc1\u0bae\u0bcd \u0b8e\u0ba9\u0bcd\u0ba9 \u0b8e\u0ba9\u0bcd\u0baa\u0ba4\u0bc8 \u0baa\u0bc1\u0bb0\u0bbf\u0ba8\u0bcd\u0ba4\u0bc1\u0b95\u0bca\u0bb3\u0bcd\u0bb3, \u0b85\u0ba4\u0bc1 \u0bb5\u0bb2\u0bc8 \u0bae\u0bc7\u0bae\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0ba4\u0bcd\u0ba4\u0bbf\u0bb2\u0bcd \u0b8e\u0baa\u0bcd\u0baa\u0b9f\u0bbf \u0b87\u0bb0\u0bc1\u0b95\u0bcd\u0b95\u0bbf\u0bb1\u0ba4\u0bc1 \u0b8e\u0ba9\u0bcd\u0baa\u0ba4\u0bc8 \u0baa\u0bc1\u0bb0\u0bbf\u0ba8\u0bcd\u0ba4\u0bc1\u0b95\u0bca\u0bb3\u0bcd\u0bb3, \u0b85\u0baa\u0bcd\u0baa\u0bcb\u0ba4\u0bc1 \u0b89\u0b99\u0bcd\u0b95\u0bb3\u0bc1\u0b95\u0bcd\u0b95\u0bc1 \u0ba4\u0bc7\u0bb5\u0bc8\u0baa\u0bcd\u0baa\u0b9f\u0bc1\u0bae\u0bcd \u0b95\u0bb1\u0bcd\u0baa\u0bbf\u0b95\u0bb3\u0bcd, \u0b95\u0bb0\u0bc1\u0bb5\u0bbf\u0b95\u0bb3\u0bcd \u0bae\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0bcd \u0ba4\u0bca\u0bb4\u0bbf\u0bb2\u0bcd\u0ba8\u0bc1\u0b9f\u0bcd\u0baa\u0b99\u0bcd\u0b95\u0bb3\u0bc8\u0baa\u0bcd \u0baa\u0bbe\u0bb0\u0bcd\u0b95\u0bcd\u0b95\u0bbf\u0ba9\u0bcd\u0bb1\u0bcb\u0bae\u0bcd.", "styles": {}}], "children": [], "position": 1}, {"id": "30fd8e1d-71c6-4d62-8f7b-c87e13f53f32", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\ud83d\udd0d \u0bae\u0bc1\u0ba9\u0bcd\u0bae\u0bca\u0bb4\u0bbf \u0bae\u0bc7\u0bae\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bae\u0bcd \u0b8e\u0ba9\u0bcd\u0ba9?", "styles": {}}], "children": [], "position": 2}, {"id": "2f9d0c73-4c53-4255-b7b9-2b504c71c371", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0bae\u0bc1\u0ba9\u0bcd\u0bae\u0bca\u0bb4\u0bbf \u0bae\u0bc7\u0bae\u0bcd\u0baa\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bae\u0bcd \u0b8e\u0ba9\u0bcd\u0baa\u0ba4\u0bc1 \u0bb5\u0bb2\u0bc8 \u0baa\u0b95\u0bcd\u0b95\u0b99\u0bcd\u0b95\u0bb3\u0bbf\u0ba9\u0bcd \u0baa\u0baf\u0ba9\u0bbe\u0bb3\u0bb0\u0bcd \u0b8e\u0ba4\u0bc8\u0baa\u0bcd \u0baa\u0bbe\u0bb0\u0bcd\u0b95\u0bcd\u0b95\u0bc1\u0bae\u0bcd \u0bae\u0bc1\u0ba9\u0bc8\u0baf\u0ba4\u0bcd\u0ba4\u0bbf\u0ba9\u0bcd \u0baa\u0b95\u0bc1\u0ba4\u0bbf\u0baf\u0bbf\u0ba9\u0bc8\u0baf\u0bc1\u0bae\u0bcd \u0baa\u0ba3\u0bcd\u0baa\u0bc1\u0baa\u0bcd\u0baa\u0bbf\u0bb0\u0bbf\u0bb5\u0bbf\u0ba9\u0bc8\u0baf\u0bc1\u0bae\u0bcd \u0b85\u0bae\u0bc8\u0baa\u0bcd\u0baa\u0ba4\u0bc1 \u2014 \u0baa\u0baf\u0ba9\u0bbe\u0bb3\u0bb0\u0bcd \u0b89\u0ba3\u0bcd\u0bae\u0bc8\u0baf\u0bbf\u0bb2\u0bcd \u0baa\u0bbe\u0bb0\u0bcd\u0b95\u0bcd\u0b95\u0bc1\u0bae\u0bcd \u0bae\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0bcd \u0ba8\u0bc7\u0bb0\u0bbe\u0b95 \u0ba4\u0bca\u0b9f\u0bb0\u0bcd\u0baa\u0bc1 \u0b95\u0bca\u0bb3\u0bcd\u0bb3\u0bc1\u0bae\u0bcd \u0b8e\u0bb2\u0bcd\u0bb2\u0bbe\u0bb5\u0bb1\u0bcd\u0bb1\u0bc8\u0baf\u0bc1\u0bae\u0bcd.", "styles": {}}], "children": [], "position": 3}, {"id": "5e509689-030e-4b9e-b414-6199d40e9e56", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b8e\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bc1\u0b95\u0bcd\u0b95\u0bbe\u0b9f\u0bcd\u0b9f\u0bc1:", "styles": {}}], "children": [], "position": 4}, {"id": "e9ee7a32-a56a-4470-b602-70c74bcabfeb", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0bb5\u0bb2\u0bc8 \u0baa\u0b95\u0bcd\u0b95 \u0b85\u0bae\u0bc8\u0baa\u0bcd\u0baa\u0bc1", "styles": {}}], "children": [], "position": 5}, {"id": "b1f3325a-a491-43f5-b4af-a9ec5d603a0a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0baa\u0bca\u0ba4\u0bc1\u0bb5\u0bbe\u0ba9 \u0bae\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0bcd \u0bb5\u0bb4\u0b99\u0bcd\u0b95\u0bb2\u0bcd\u0b95\u0bb3\u0bcd", "styles": {}}], "children": [], "position": 6}, {"id": "b9624ef8-56d7-440a-81a7-ff0eb2869ba4", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0ba8\u0bbf\u0bb1\u0bae\u0bcd, \u0b8e\u0bb4\u0bc1\u0ba4\u0bcd\u0ba4\u0bc1\u0bb0\u0bc1\u0b95\u0bcd\u0b95\u0bb3\u0bcd, \u0b85\u0ba9\u0bbf\u0bae\u0bc7\u0bb7\u0ba9\u0bcd\u0b95\u0bb3\u0bcd", "styles": {}}], "children": [], "position": 7}, {"id": "7160f7af-78cf-47f4-b9fc-297c18c1f9e2", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b87\u0ba3\u0bc8\u0baf \u0b85\u0bae\u0bc8\u0baa\u0bcd\u0baa\u0bc1\u0b95\u0bb3\u0bcd (\u0baa\u0b9f\u0bbf\u0bb5\u0b99\u0bcd\u0b95\u0bb3\u0bcd, \u0bb8\u0bcd\u0bb2\u0bc8\u0b9f\u0bcd\u0b9f\u0bb0\u0bcd\u0b95\u0bb3\u0bcd \u0baa\u0bcb\u0ba9\u0bcd\u0bb1\u0bb5\u0bc8)", "styles": {}}], "children": [], "position": 8}, {"id": "2af7d707-75c5-4c85-b56a-e9e63f8662b8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\ud83e\udde0 \u0bae\u0bc1\u0ba9\u0bcd\u0bae\u0bca\u0bb4\u0bbf vs \u0baa\u0bbf\u0ba9\u0bcd\u0bae\u0bca\u0bb4\u0bbf", "styles": {}}], "children": [], "position": 9}, {"id": "bfd5dbe2-665c-44f6-bcf7-b1a9e6495cb8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0bae\u0bc1\u0ba9\u0bcd\u0bae\u0bca\u0bb4\u0bbf \u0baa\u0bbf\u0ba9\u0bcd\u0bae\u0bca\u0bb4\u0bbf", "styles": {}}], "children": [], "position": 10}, {"id": "8385c38e-28cd-4ad6-8e21-fa5c14a6c79b", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b89\u0bb2\u0bbe\u0bb5\u0bbf\u0bb2\u0bcd \u0b87\u0baf\u0b99\u0bcd\u0b95\u0bc1\u0b95\u0bbf\u0ba9\u0bcd\u0bb1\u0ba4\u0bc1 \u0b9a\u0bb0\u0bcd\u0bb5\u0bb0\u0bbf\u0bb2\u0bcd \u0b87\u0baf\u0b99\u0bcd\u0b95\u0bc1\u0b95\u0bbf\u0bb1\u0ba4\u0bc1", "styles": {}}], "children": [], "position": 11}, {"id": "c3b25b44-5744-4708-a332-2382c9a71764", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "HTML, CSS, JavaScript \u0baa\u0bc8\u0ba4\u0ba9\u0bcd, PHP, Node.js \u0baa\u0bcb\u0ba9\u0bcd\u0bb1\u0bb5\u0bc8", "styles": {}}], "children": [], "position": 12}, {"id": "f4481b24-a39b-41ac-bdd3-1f619a175627", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0baa\u0baf\u0ba9\u0bbe\u0bb3\u0bb0\u0bcd \u0b87\u0ba9\u0bcd\u0b9f\u0bb0\u0bcd\u0b83\u0baa\u0bc7\u0bb8\u0bcd \u0bae\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0bcd \u0b85\u0ba9\u0bc1\u0baa\u0bb5\u0bae\u0bcd \u0ba4\u0bb0\u0bc1\u0b95\u0bbf\u0bb1\u0ba4\u0bc1 \u0ba4\u0bb0\u0bb5\u0bc1 \u0ba4\u0bb3\u0bb0\u0bcd\u0ba4\u0bcd\u0ba4\u0bc1\u0bae\u0bcd \u0baa\u0ba4\u0bbf\u0bb5\u0bc1\u0b95\u0bb3\u0bcd, \u0baa\u0bbe\u0bb0\u0bcd\u0b95\u0bcd\u0b95, \u0b8f\u0baa\u0bbf\u0b90\u0b95\u0bb3\u0bcd \u0bae\u0bb1\u0bcd\u0bb1\u0bc1\u0bae\u0bcd \u0bae\u0bc1\u0b9f\u0bbf\u0bb5\u0bc1 \u0bae\u0bbe\u0bb1\u0bcd\u0bb1\u0bc1\u0b95\u0bb3\u0bc1\u0bae\u0bcd", "styles": {}}], "children": [], "position": 13}, {"id": "92d9aa8f-feef-46cb-b098-91b6b3eb7e35", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b8e\u0b9f\u0bc1\u0ba4\u0bcd\u0ba4\u0bc1\u0b95\u0bcd\u0b95\u0bbe\u0b9f\u0bcd\u0b9f\u0bc1\u0b95\u0bb3\u0bcd:", "styles": {}}], "children": [], "position": 14}, {"id": "84cd4b04-7b35-4373-aa82-b563f5d19003", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0bb0\u0bbf\u0baf\u0bbe\u0b95\u0bcd\u0b9f\u0bcd, \u0bb5\u0bc1\u0baf\u0bc1 \u0baa\u0bcb\u0ba9\u0bcd\u0bb1\u0bb5\u0bc8\u0b95\u0bb3\u0bcd", "styles": {}}], "children": [], "position": 15}, {"id": "795be7f1-2538-4b3e-8c09-78d0ec04b702", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "\u0b8e\u0b95\u0bcd\u0bb8\u0bcd\u0baa\u0bbf\u0bb0\u0bb8\u0bcd, \u0b9f\u0bcd\u0b9c\u0bbe\u0b99\u0bcd\u0b95\u0bcb, \u0bb2\u0bbe\u0bb0\u0bb5\u0bc7\u0bb2\u0bcd \u0baa\u0bcb\u0ba9\u0bcd\u0bb1\u0bb5\u0bc8", "styles": {}}], "children": [], "position": 16}, {"id": "7fd2c5e7-2a44-49f4-8e19-75f0ccddb9b7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 17}]', status = 'published', title = 'Module 1: Introduction to Frontend Development(Tamil)', scheduled_publish_at = NULL WHERE id = 10
2025-05-19 10:11:50,707 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:11:50,719 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 10 AND deleted_at IS NULL
        
2025-05-19 10:11:50,724 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 10
2025-05-19 10:11:54,262 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 10:11:54,265 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:11:54,268 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 10:11:54,269 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 10:11:54,270 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 10:11:54,270 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:11:54,270 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 10:11:54,276 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:11:56,355 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:11:56,363 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:11:56,393 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:11:56,402 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:11:56,409 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:11:56,418 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:11:56,427 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:11:56,436 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:11:56,443 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:11:56,450 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:11:56,462 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:12:02,312 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:12:02,319 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:12:02,323 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:12:02,327 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:12:02,333 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:12:02,340 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:12:03,018 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:12:03,034 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:12:15,865 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:12:15,865 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:42:15.861439+00:00'
        RETURNING id
        
2025-05-19 10:12:15,865 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:13:15,867 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:13:15,867 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:43:15.863419+00:00'
        RETURNING id
        
2025-05-19 10:13:15,867 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:13:36,646 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:13:36,653 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:13:36,692 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:13:36,705 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:13:36,713 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:13:36,724 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:13:36,735 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:13:36,744 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:13:36,751 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:13:36,758 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:13:36,769 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:14:15,861 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:14:15,862 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:44:15.858385+00:00'
        RETURNING id
        
2025-05-19 10:14:15,872 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:14:23,834 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:14:23,850 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:14:23,852 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:14:23,862 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:14:23,864 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:14:23,876 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:14:24,712 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:14:24,723 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:15:11,108 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:15:11,116 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:15:11,124 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:15:11,139 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:15:11,147 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:15:11,155 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:15:11,168 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:15:11,192 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:15:11,216 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:15:11,227 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:15:11,237 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:15:11,249 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:15:15,865 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:15:15,865 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:45:15.861201+00:00'
        RETURNING id
        
2025-05-19 10:15:15,865 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:16:15,859 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:16:15,859 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:46:15.855153+00:00'
        RETURNING id
        
2025-05-19 10:16:15,860 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:17:15,857 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:17:15,858 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:47:15.853907+00:00'
        RETURNING id
        
2025-05-19 10:17:15,858 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:18:15,865 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:18:15,865 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:48:15.861963+00:00'
        RETURNING id
        
2025-05-19 10:18:15,865 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:19:15,861 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:19:15,861 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:49:15.857158+00:00'
        RETURNING id
        
2025-05-19 10:19:15,862 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:20:15,866 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:20:15,866 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:50:15.861413+00:00'
        RETURNING id
        
2025-05-19 10:20:15,866 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:21:15,857 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:21:15,857 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:51:15.853007+00:00'
        RETURNING id
        
2025-05-19 10:21:15,858 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:22:15,866 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:22:15,866 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:52:15.861564+00:00'
        RETURNING id
        
2025-05-19 10:22:15,866 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:23:15,860 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:23:15,860 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:53:15.855890+00:00'
        RETURNING id
        
2025-05-19 10:23:15,861 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:24:15,871 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:24:15,871 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 04:54:15.867183+00:00'
        RETURNING id
        
2025-05-19 10:24:15,872 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:29:58,737 - api.utils.logging - INFO - Logging system initialized
2025-05-19 10:29:59,977 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-19 10:29:59,977 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-19 10:30:00,133 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:30:00,757 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:30:00,774 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:30:00,859 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:30:00,861 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:30:00,906 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:30:00,907 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:30:00,932 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:30:00,956 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:30:00,977 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:30:00,990 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:30:01,002 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:30:58,991 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:30:58,991 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:00:58.986271+00:00'
        RETURNING id
        
2025-05-19 10:30:58,993 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:31:58,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:31:58,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:01:58.985053+00:00'
        RETURNING id
        
2025-05-19 10:31:58,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:32:39,948 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:32:39,951 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:32:39,967 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:32:39,969 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:32:39,978 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:32:39,999 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:32:40,709 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:32:40,722 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:32:43,157 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:32:43,163 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:32:43,493 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:32:43,497 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:32:43,504 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:32:43,511 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:32:58,976 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:32:58,976 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:02:58.971927+00:00'
        RETURNING id
        
2025-05-19 10:32:58,976 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:32:59,427 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:32:59,432 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:41:45,930 - api.utils.logging - INFO - Logging system initialized
2025-05-19 10:41:46,470 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-19 10:41:46,490 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-19 10:41:46,692 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:46,700 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:46,720 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:48,791 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-19 10:41:48,797 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-19 10:41:48,801 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:48,816 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-19 10:41:48,824 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-19 10:41:48,824 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-19 10:41:48,833 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 10:41:48,846 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-19 10:41:48,868 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:48,877 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 10:41:50,634 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:41:50,643 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:41:50,647 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:41:50,647 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:50,652 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:41:50,663 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:41:50,684 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:41:50,693 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:41:50,700 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:41:52,419 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:41:52,422 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:41:52,432 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:41:52,437 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:41:54,431 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-19 10:41:54,438 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:54,440 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-19 10:41:54,453 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-19 10:41:54,461 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-19 10:41:54,466 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-19 10:41:54,474 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-19 10:41:54,482 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 10:41:54,490 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 10:41:54,504 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:56,096 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:41:56,101 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:41:56,105 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:41:56,106 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:56,108 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:41:56,122 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:41:56,123 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:41:56,130 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:41:56,139 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:41:57,625 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:41:57,630 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:41:57,636 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:41:57,637 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:41:57,648 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:41:57,658 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:41:58,349 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:41:58,360 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:42:00,447 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:42:00,452 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:42:00,779 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:42:00,782 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:42:00,793 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:42:00,801 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:42:46,128 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:42:46,128 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:12:46.124312+00:00'
        RETURNING id
        
2025-05-19 10:42:46,130 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:52:08,717 - api.utils.logging - INFO - Logging system initialized
2025-05-19 10:52:09,220 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-19 10:52:09,231 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-19 10:52:18,038 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:52:18,045 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:52:18,050 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 10:52:18,055 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:52:18,060 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 10:52:18,061 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 10:52:18,062 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 10:52:18,062 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 10:52:31,082 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:52:31,090 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:52:31,133 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:52:31,152 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:52:31,165 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:52:31,182 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:52:31,192 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:52:31,203 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:52:31,210 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:52:31,216 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:52:31,226 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:52:38,706 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:52:38,711 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:52:49,483 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:52:49,485 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:52:49,503 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:52:49,505 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:52:49,514 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:52:49,515 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:52:50,223 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:52:50,235 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:53:08,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:53:08,888 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:23:08.882472+00:00'
        RETURNING id
        
2025-05-19 10:53:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:54:08,892 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:54:08,893 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:24:08.887467+00:00'
        RETURNING id
        
2025-05-19 10:54:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:55:08,898 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:55:08,898 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:25:08.893282+00:00'
        RETURNING id
        
2025-05-19 10:55:08,899 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:56:08,907 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:56:08,908 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:26:08.896461+00:00'
        RETURNING id
        
2025-05-19 10:56:08,912 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:56:38,870 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:56:38,876 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:56:39,221 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:56:39,224 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:56:39,235 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:56:39,238 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:57:05,586 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:57:05,599 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:57:05,666 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:57:05,704 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:57:05,723 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:57:05,744 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:57:05,760 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 10:57:05,778 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 10:57:05,791 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 10:57:05,808 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 10:57:05,828 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 10:57:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:57:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:27:08.891208+00:00'
        RETURNING id
        
2025-05-19 10:57:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:57:33,415 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:57:33,422 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:57:34,434 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:57:34,442 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:57:34,460 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 10:57:34,469 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 10:58:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:58:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:28:08.882579+00:00'
        RETURNING id
        
2025-05-19 10:58:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 10:59:08,885 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 10:59:08,885 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:29:08.881660+00:00'
        RETURNING id
        
2025-05-19 10:59:08,894 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:00:08,885 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:00:08,886 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:30:08.882645+00:00'
        RETURNING id
        
2025-05-19 11:00:08,886 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:01:08,897 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:01:08,897 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:31:08.891269+00:00'
        RETURNING id
        
2025-05-19 11:01:08,897 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:02:08,908 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:02:08,908 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:32:08.901747+00:00'
        RETURNING id
        
2025-05-19 11:02:08,910 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:03:08,901 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:03:08,902 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:33:08.895920+00:00'
        RETURNING id
        
2025-05-19 11:03:08,903 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:04:08,900 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:04:08,909 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:34:08.895620+00:00'
        RETURNING id
        
2025-05-19 11:04:08,910 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:05:08,899 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:05:08,899 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:35:08.891837+00:00'
        RETURNING id
        
2025-05-19 11:05:08,900 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:06:08,908 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:06:08,908 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:36:08.900890+00:00'
        RETURNING id
        
2025-05-19 11:06:08,910 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:07:08,897 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:07:08,897 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:37:08.890510+00:00'
        RETURNING id
        
2025-05-19 11:07:08,898 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:08:08,901 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:08:08,901 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:38:08.894408+00:00'
        RETURNING id
        
2025-05-19 11:08:08,902 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:08:26,159 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:08:26,170 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:08:29,767 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:08:29,773 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:09:08,893 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:09:08,893 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:39:08.887221+00:00'
        RETURNING id
        
2025-05-19 11:09:08,894 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:10:08,904 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:10:08,904 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:40:08.894539+00:00'
        RETURNING id
        
2025-05-19 11:10:08,905 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:11:08,890 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:11:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:41:08.884973+00:00'
        RETURNING id
        
2025-05-19 11:11:08,892 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:12:08,897 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:12:08,897 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:42:08.892097+00:00'
        RETURNING id
        
2025-05-19 11:12:08,898 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:13:08,888 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:13:08,889 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:43:08.882511+00:00'
        RETURNING id
        
2025-05-19 11:13:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:14:08,902 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:14:08,902 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:44:08.896292+00:00'
        RETURNING id
        
2025-05-19 11:14:08,903 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:15:08,891 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:15:08,892 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:45:08.882817+00:00'
        RETURNING id
        
2025-05-19 11:15:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:16:08,890 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:16:08,890 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:46:08.884957+00:00'
        RETURNING id
        
2025-05-19 11:16:08,891 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:17:08,901 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:17:08,901 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:47:08.894509+00:00'
        RETURNING id
        
2025-05-19 11:17:08,902 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:18:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:18:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:48:08.890204+00:00'
        RETURNING id
        
2025-05-19 11:18:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:19:08,888 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:19:08,888 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:49:08.884424+00:00'
        RETURNING id
        
2025-05-19 11:19:08,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:19:54,093 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:19:54,098 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:20:07,052 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:20:07,067 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:20:07,142 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:20:07,582 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:20:07,591 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-19 11:20:07,614 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-19 11:20:07,619 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-19 11:20:07,646 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-19 11:20:07,653 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-19 11:20:07,676 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-19 11:20:07,684 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 11:20:07,699 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 11:20:07,729 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:20:08,890 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:20:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:50:08.885640+00:00'
        RETURNING id
        
2025-05-19 11:20:08,894 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:20:10,130 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 11:20:10,139 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 11:20:10,142 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 11:20:10,156 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 11:20:10,169 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:20:10,185 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 11:20:10,187 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 11:20:10,194 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 11:20:10,202 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 11:20:16,822 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:20:16,822 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:20:16,827 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:20:16,828 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:20:19,959 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:20:19,964 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:20:19,972 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:20:19,978 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:21:08,891 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:21:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:51:08.887102+00:00'
        RETURNING id
        
2025-05-19 11:21:08,891 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:22:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:22:08,896 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:52:08.891795+00:00'
        RETURNING id
        
2025-05-19 11:22:08,897 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:23:08,888 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:23:08,888 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:53:08.883914+00:00'
        RETURNING id
        
2025-05-19 11:23:08,891 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:24:08,888 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:24:08,889 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:54:08.884305+00:00'
        RETURNING id
        
2025-05-19 11:24:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:25:08,901 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:25:08,902 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:55:08.896582+00:00'
        RETURNING id
        
2025-05-19 11:25:08,903 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:26:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:26:08,894 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:56:08.890365+00:00'
        RETURNING id
        
2025-05-19 11:26:08,901 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:27:08,899 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:27:08,900 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:57:08.896126+00:00'
        RETURNING id
        
2025-05-19 11:27:08,900 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:27:52,187 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:27:52,192 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:27:52,211 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:27:52,216 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:27:58,760 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:27:58,768 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:27:58,782 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:27:58,791 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:06,040 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:06,044 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:06,053 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:06,058 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:08,890 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:28:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:58:08.886499+00:00'
        RETURNING id
        
2025-05-19 11:28:08,891 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:28:15,064 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:15,070 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:15,080 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:15,087 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:20,740 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:20,749 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:20,762 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:20,769 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:27,055 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:27,060 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:27,071 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:27,077 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:33,057 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:33,062 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:33,072 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:33,077 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:36,755 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:36,762 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:36,797 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:36,804 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:44,058 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:44,063 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:44,071 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:44,077 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:48,752 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:48,757 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:28:48,765 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:28:48,771 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:29:08,898 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:29:08,899 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 05:59:08.895085+00:00'
        RETURNING id
        
2025-05-19 11:29:08,899 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:30:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:30:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:00:08.890136+00:00'
        RETURNING id
        
2025-05-19 11:30:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:31:08,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:31:08,886 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:01:08.882790+00:00'
        RETURNING id
        
2025-05-19 11:31:08,887 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:32:08,902 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:32:08,902 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:02:08.898134+00:00'
        RETURNING id
        
2025-05-19 11:32:08,902 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:33:08,908 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:33:08,908 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:03:08.903875+00:00'
        RETURNING id
        
2025-05-19 11:33:08,909 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:33:36,408 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:33:36,420 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:33:36,461 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 11:33:36,472 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 11:33:36,482 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 11:33:36,501 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 11:33:36,512 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:33:36,523 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 11:33:36,533 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 11:33:36,541 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 11:33:36,555 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 11:33:39,220 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:33:39,227 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:34:08,887 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:34:08,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:04:08.882591+00:00'
        RETURNING id
        
2025-05-19 11:34:08,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:35:08,889 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:35:08,889 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:05:08.885017+00:00'
        RETURNING id
        
2025-05-19 11:35:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:36:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:36:08,894 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:06:08.890240+00:00'
        RETURNING id
        
2025-05-19 11:36:08,894 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:37:08,898 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:37:08,898 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:07:08.894728+00:00'
        RETURNING id
        
2025-05-19 11:37:08,899 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:38:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:38:08,894 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:08:08.890678+00:00'
        RETURNING id
        
2025-05-19 11:38:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:39:08,898 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:39:08,898 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:09:08.895154+00:00'
        RETURNING id
        
2025-05-19 11:39:08,899 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:40:08,891 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:40:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:10:08.887582+00:00'
        RETURNING id
        
2025-05-19 11:40:08,891 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:41:08,887 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:41:08,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:11:08.883819+00:00'
        RETURNING id
        
2025-05-19 11:41:08,887 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:42:08,892 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:42:08,892 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:12:08.888360+00:00'
        RETURNING id
        
2025-05-19 11:42:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:43:08,889 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:43:08,889 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:13:08.885486+00:00'
        RETURNING id
        
2025-05-19 11:43:08,889 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:44:08,899 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:44:08,899 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:14:08.894104+00:00'
        RETURNING id
        
2025-05-19 11:44:08,899 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:45:08,897 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:45:08,897 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:15:08.891366+00:00'
        RETURNING id
        
2025-05-19 11:45:08,900 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:46:08,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:46:08,886 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:16:08.882420+00:00'
        RETURNING id
        
2025-05-19 11:46:08,887 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:47:08,888 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:47:08,888 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:17:08.882448+00:00'
        RETURNING id
        
2025-05-19 11:47:08,892 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:48:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:48:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:18:08.890270+00:00'
        RETURNING id
        
2025-05-19 11:48:08,897 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:48:56,192 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:48:56,201 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:48:56,236 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:48:56,244 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:49:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:49:08,894 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:19:08.888933+00:00'
        RETURNING id
        
2025-05-19 11:49:08,897 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:49:10,082 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:49:10,086 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:49:10,098 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:49:10,104 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:49:19,995 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:49:19,999 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:49:20,012 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:49:20,020 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:49:20,762 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:49:20,769 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:49:20,868 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:49:20,874 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:49:25,066 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:49:25,071 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:49:25,081 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:49:25,088 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:49:43,642 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:49:43,653 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:49:43,719 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 11:49:43,743 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 11:49:43,757 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 11:49:43,775 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 11:49:43,787 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 11:49:43,797 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 11:49:43,808 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 11:49:43,816 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 11:49:43,831 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 11:49:46,144 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:49:46,149 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:50:08,887 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:50:08,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:20:08.883955+00:00'
        RETURNING id
        
2025-05-19 11:50:08,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:50:15,172 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:50:15,177 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:50:15,746 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:50:15,751 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:50:23,737 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:50:23,743 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:50:23,754 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:50:23,760 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:50:26,994 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:50:26,999 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:50:27,010 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:50:27,016 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:50:39,815 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:50:39,819 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:50:39,828 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 11:50:39,833 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 11:51:08,891 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:51:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:21:08.887508+00:00'
        RETURNING id
        
2025-05-19 11:51:08,892 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:52:08,889 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:52:08,890 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:22:08.885667+00:00'
        RETURNING id
        
2025-05-19 11:52:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:53:08,892 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:53:08,892 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:23:08.888443+00:00'
        RETURNING id
        
2025-05-19 11:53:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:54:08,901 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:54:08,902 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:24:08.896266+00:00'
        RETURNING id
        
2025-05-19 11:54:08,905 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:55:08,899 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:55:08,899 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:25:08.894245+00:00'
        RETURNING id
        
2025-05-19 11:55:08,902 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:56:08,901 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:56:08,902 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:26:08.893801+00:00'
        RETURNING id
        
2025-05-19 11:56:08,905 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:57:08,887 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:57:08,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:27:08.881879+00:00'
        RETURNING id
        
2025-05-19 11:57:08,887 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:58:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:58:08,896 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:28:08.892173+00:00'
        RETURNING id
        
2025-05-19 11:58:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 11:59:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 11:59:08,894 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:29:08.890118+00:00'
        RETURNING id
        
2025-05-19 11:59:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:00:08,903 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:00:08,905 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:30:08.891485+00:00'
        RETURNING id
        
2025-05-19 12:00:08,905 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:01:08,893 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:01:08,893 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:31:08.889269+00:00'
        RETURNING id
        
2025-05-19 12:01:08,894 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:02:08,900 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:02:08,900 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:32:08.895754+00:00'
        RETURNING id
        
2025-05-19 12:02:08,901 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:03:08,890 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:03:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:33:08.887752+00:00'
        RETURNING id
        
2025-05-19 12:03:08,891 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:03:33,876 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:03:33,895 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:03:36,085 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:03:36,095 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:03:50,656 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:03:50,663 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:03:50,705 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:03:50,718 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:03:50,729 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:03:50,752 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:03:50,762 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:03:50,773 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:03:50,781 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:03:50,789 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:03:50,802 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:04:08,891 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:04:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:34:08.887407+00:00'
        RETURNING id
        
2025-05-19 12:04:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:05:08,892 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:05:08,893 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:35:08.889105+00:00'
        RETURNING id
        
2025-05-19 12:05:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:06:08,890 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:06:08,890 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:36:08.887096+00:00'
        RETURNING id
        
2025-05-19 12:06:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:07:08,892 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:07:08,892 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:37:08.886898+00:00'
        RETURNING id
        
2025-05-19 12:07:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:07:21,595 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:07:21,608 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-19 12:08:08,901 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:08:08,901 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:38:08.897055+00:00'
        RETURNING id
        
2025-05-19 12:08:08,902 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:09:08,897 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:09:08,898 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:39:08.885557+00:00'
        RETURNING id
        
2025-05-19 12:09:08,902 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:10:08,905 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:10:08,905 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:40:08.896644+00:00'
        RETURNING id
        
2025-05-19 12:10:08,908 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:11:08,902 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:11:08,903 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:41:08.893433+00:00'
        RETURNING id
        
2025-05-19 12:11:08,906 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:12:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:12:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:42:08.891465+00:00'
        RETURNING id
        
2025-05-19 12:12:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:13:08,898 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:13:08,899 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:43:08.893757+00:00'
        RETURNING id
        
2025-05-19 12:13:08,899 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:14:08,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:14:08,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:44:08.883037+00:00'
        RETURNING id
        
2025-05-19 12:14:08,887 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:15:08,899 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:15:08,899 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:45:08.895493+00:00'
        RETURNING id
        
2025-05-19 12:15:08,900 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:16:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:16:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:46:08.890392+00:00'
        RETURNING id
        
2025-05-19 12:16:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:17:08,885 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:17:08,885 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:47:08.881892+00:00'
        RETURNING id
        
2025-05-19 12:17:08,886 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:18:08,889 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:18:08,889 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:48:08.885499+00:00'
        RETURNING id
        
2025-05-19 12:18:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:19:08,896 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:19:08,896 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:49:08.883741+00:00'
        RETURNING id
        
2025-05-19 12:19:08,897 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:20:08,889 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:20:08,889 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:50:08.884540+00:00'
        RETURNING id
        
2025-05-19 12:20:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:21:08,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:21:08,886 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:51:08.883119+00:00'
        RETURNING id
        
2025-05-19 12:21:08,887 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:22:08,887 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:22:08,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:52:08.884074+00:00'
        RETURNING id
        
2025-05-19 12:22:08,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:23:08,891 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:23:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:53:08.887557+00:00'
        RETURNING id
        
2025-05-19 12:23:08,891 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:24:08,892 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:24:08,893 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:54:08.881772+00:00'
        RETURNING id
        
2025-05-19 12:24:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:25:08,890 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:25:08,890 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:55:08.886148+00:00'
        RETURNING id
        
2025-05-19 12:25:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:26:08,892 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:26:08,892 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:56:08.888785+00:00'
        RETURNING id
        
2025-05-19 12:26:08,892 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:27:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:27:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:57:08.891802+00:00'
        RETURNING id
        
2025-05-19 12:27:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:28:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:28:08,896 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:58:08.892721+00:00'
        RETURNING id
        
2025-05-19 12:28:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:29:08,892 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:29:08,892 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 06:59:08.881677+00:00'
        RETURNING id
        
2025-05-19 12:29:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:30:08,893 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:30:08,893 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:00:08.890472+00:00'
        RETURNING id
        
2025-05-19 12:30:08,894 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:31:08,892 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:31:08,892 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:01:08.888993+00:00'
        RETURNING id
        
2025-05-19 12:31:08,892 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:32:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:32:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:02:08.891890+00:00'
        RETURNING id
        
2025-05-19 12:32:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:33:08,889 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:33:08,889 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:03:08.886370+00:00'
        RETURNING id
        
2025-05-19 12:33:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:34:08,898 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:34:08,898 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:04:08.895009+00:00'
        RETURNING id
        
2025-05-19 12:34:08,899 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:35:08,905 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:35:08,905 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:05:08.902280+00:00'
        RETURNING id
        
2025-05-19 12:35:08,906 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:36:08,898 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:36:08,898 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:06:08.886426+00:00'
        RETURNING id
        
2025-05-19 12:36:08,898 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:37:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:37:08,894 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:07:08.891223+00:00'
        RETURNING id
        
2025-05-19 12:37:08,894 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:38:08,887 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:38:08,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:08:08.884177+00:00'
        RETURNING id
        
2025-05-19 12:38:08,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:39:08,890 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:39:08,890 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:09:08.887102+00:00'
        RETURNING id
        
2025-05-19 12:39:08,891 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:40:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:40:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:10:08.892766+00:00'
        RETURNING id
        
2025-05-19 12:40:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:40:51,703 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:40:51,719 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:40:51,765 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:40:51,773 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:40:51,781 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:40:51,795 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:40:51,805 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:40:51,814 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:40:51,820 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:40:51,826 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:40:51,838 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:41:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:41:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:11:08.891502+00:00'
        RETURNING id
        
2025-05-19 12:41:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:42:00,912 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:42:00,924 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:42:00,959 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-19 12:42:00,967 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-19 12:42:00,973 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-19 12:42:00,985 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:42:00,992 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-19 12:42:00,998 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-19 12:42:01,004 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-19 12:42:01,019 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-19 12:42:01,034 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:42:01,042 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-19 12:42:01,052 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 12:42:01,065 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-19 12:42:01,071 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-19 12:42:01,077 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:42:01,082 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-19 12:42:01,085 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-19 12:42:01,089 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-19 12:42:01,099 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-19 12:42:01,104 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-19 12:42:01,109 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
         AND ct.course_id = 2
2025-05-19 12:42:01,114 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL AND ct.course_id = 2 
        ORDER BY t.id, q.position ASC
        
2025-05-19 12:42:01,118 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT tc.user_id
        FROM task_completions tc
        JOIN course_tasks ct ON tc.task_id = ct.task_id
        WHERE tc.user_id IN (2) AND ct.course_id = 2
        ORDER BY tc.created_at ASC
        
2025-05-19 12:42:01,122 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT ch.user_id
        FROM chat_history ch
        JOIN questions q ON ch.question_id = q.id
        JOIN tasks t ON q.task_id = t.id
        JOIN course_tasks ct ON t.id = ct.task_id
        WHERE ch.user_id IN (2) AND ct.course_id = 2
        GROUP BY ch.user_id
        
2025-05-19 12:42:01,159 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 12:42:01,160 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-19 12:42:01,171 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-19 12:42:01,175 - api.utils.logging - INFO - Executing operation: 
    SELECT 
        u.id,
        u.email,
        u.first_name,
        u.middle_name,
        u.last_name,
        GROUP_CONCAT(t.created_at) as created_ats
    FROM users u
    LEFT JOIN (
        -- Chat history interactions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM chat_history
        WHERE 1=1  AND question_id IN (SELECT id FROM questions WHERE task_id IN (SELECT task_id FROM course_tasks WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)))
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        UNION
        
        -- Task completions
        SELECT user_id, MAX(datetime(created_at, '+5 hours', '+30 minutes')) as created_at
        FROM task_completions
        WHERE 1=1  AND task_id IN (
            SELECT task_id FROM course_tasks 
            WHERE course_id IN (SELECT course_id FROM course_cohorts WHERE cohort_id = 1)
        )
        GROUP BY user_id, DATE(datetime(created_at, '+5 hours', '+30 minutes'))
        
        ORDER BY created_at DESC, user_id
    ) t ON u.id = t.user_id
    WHERE u.id IN (
        -- Users who are in the cohort as learners
        SELECT user_id FROM user_cohorts WHERE cohort_id = 1 and role = 'learner'
       
    )
    GROUP BY u.id, u.email, u.first_name, u.middle_name, u.last_name
    
2025-05-19 12:42:01,180 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-19 12:42:01,186 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:42:01,189 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-19 12:42:01,191 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-19 12:42:01,194 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-19 12:42:01,196 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-19 12:42:01,199 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
        
2025-05-19 12:42:01,201 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-19 12:42:01,205 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL 
        ORDER BY t.id, q.position ASC
        
2025-05-19 12:42:01,206 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-19 12:42:01,212 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-19 12:42:01,214 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name 
        FROM courses c
        JOIN course_cohorts cc ON c.id = cc.course_id
        WHERE cc.cohort_id = 1
        
2025-05-19 12:42:01,216 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
         AND ct.course_id = 2
2025-05-19 12:42:01,221 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL AND ct.course_id = 2 
        ORDER BY t.id, q.position ASC
        
2025-05-19 12:42:01,225 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT tc.user_id
        FROM task_completions tc
        JOIN course_tasks ct ON tc.task_id = ct.task_id
        WHERE tc.user_id IN (2) AND ct.course_id = 2
        ORDER BY tc.created_at ASC
        
2025-05-19 12:42:01,230 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT ch.user_id
        FROM chat_history ch
        JOIN questions q ON ch.question_id = q.id
        JOIN tasks t ON q.task_id = t.id
        JOIN course_tasks ct ON t.id = ct.task_id
        WHERE ch.user_id IN (2) AND ct.course_id = 2
        GROUP BY ch.user_id
        
2025-05-19 12:42:01,237 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 2
2025-05-19 12:42:01,242 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 2 ORDER BY cm.ordering
2025-05-19 12:42:01,246 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 2 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:42:01,251 - api.utils.logging - INFO - Executing operation: SELECT * FROM cohorts WHERE id = 1
2025-05-19 12:42:01,255 - api.utils.logging - INFO - Executing operation: 
        SELECT 
            g.id,
            g.name,
            GROUP_CONCAT(COALESCE(u.id, '')) as user_ids,
            GROUP_CONCAT(COALESCE(u.email, '')) as user_emails,
            GROUP_CONCAT(COALESCE(uc.role, '')) as user_roles
        FROM groups g
        LEFT JOIN user_groups ug ON g.id = ug.group_id 
        LEFT JOIN users u ON ug.user_id = u.id
        LEFT JOIN user_cohorts uc ON uc.user_id = u.id AND uc.cohort_id = g.cohort_id
        WHERE g.cohort_id = 1
        GROUP BY g.id, g.name
        ORDER BY g.id
        
2025-05-19 12:42:01,259 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT u.id, u.email, uc.role
        FROM users u
        JOIN user_cohorts uc ON u.id = uc.user_id 
        WHERE uc.cohort_id = 1
        ORDER BY uc.role
        
2025-05-19 12:42:01,264 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, task_id 
        FROM task_completions
        WHERE user_id in (2) AND task_id IS NOT NULL
        
2025-05-19 12:42:01,268 - api.utils.logging - INFO - Executing operation: 
        SELECT user_id, question_id 
        FROM task_completions
        WHERE user_id in (2) AND question_id IS NOT NULL
        
2025-05-19 12:42:01,272 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'learning_material' AND t.status = 'published' AND t.scheduled_publish_at IS NULL
         AND ct.course_id = 2
2025-05-19 12:42:01,276 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT t.id as task_id, q.id as question_id
        FROM tasks t
        JOIN course_tasks ct ON t.id = ct.task_id
        JOIN course_cohorts cc ON ct.course_id = cc.course_id
        LEFT JOIN questions q ON t.id = q.task_id AND q.deleted_at IS NULL
        WHERE cc.cohort_id = 1 AND t.deleted_at IS NULL AND t.type = 'quiz' AND t.status = 'published' AND t.scheduled_publish_at IS NULL AND ct.course_id = 2 
        ORDER BY t.id, q.position ASC
        
2025-05-19 12:42:01,280 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT tc.user_id
        FROM task_completions tc
        JOIN course_tasks ct ON tc.task_id = ct.task_id
        WHERE tc.user_id IN (2) AND ct.course_id = 2
        ORDER BY tc.created_at ASC
        
2025-05-19 12:42:01,284 - api.utils.logging - INFO - Executing operation: 
        SELECT DISTINCT ch.user_id
        FROM chat_history ch
        JOIN questions q ON ch.question_id = q.id
        JOIN tasks t ON q.task_id = t.id
        JOIN course_tasks ct ON t.id = ct.task_id
        WHERE ch.user_id IN (2) AND ct.course_id = 2
        GROUP BY ch.user_id
        
2025-05-19 12:42:08,898 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:42:08,899 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:12:08.895797+00:00'
        RETURNING id
        
2025-05-19 12:42:08,900 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:42:19,427 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:42:19,433 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 12:42:19,436 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:42:19,439 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:42:19,444 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 12:42:19,445 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 12:42:19,445 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 12:42:19,446 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 12:43:08,902 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:43:08,902 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:13:08.891065+00:00'
        RETURNING id
        
2025-05-19 12:43:08,903 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:44:08,888 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:44:08,888 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:14:08.885085+00:00'
        RETURNING id
        
2025-05-19 12:44:08,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:45:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:45:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:15:08.892544+00:00'
        RETURNING id
        
2025-05-19 12:45:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:46:08,893 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:46:08,893 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:16:08.890420+00:00'
        RETURNING id
        
2025-05-19 12:46:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:47:08,888 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:47:08,888 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:17:08.885452+00:00'
        RETURNING id
        
2025-05-19 12:47:08,889 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:48:08,891 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:48:08,892 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:18:08.888436+00:00'
        RETURNING id
        
2025-05-19 12:48:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:48:11,575 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:48:11,579 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 12:48:11,583 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:48:11,585 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:48:11,588 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 12:48:11,590 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 12:48:11,590 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 12:48:11,591 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 12:48:20,559 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:48:20,565 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:48:20,604 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:48:20,611 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:48:20,619 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:48:20,638 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:48:20,647 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:48:20,656 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:48:20,661 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:48:20,666 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:48:20,677 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:49:08,893 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:49:08,893 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:19:08.889901+00:00'
        RETURNING id
        
2025-05-19 12:49:08,894 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:49:46,745 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:49:46,752 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:49:46,781 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:49:46,788 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:49:46,796 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:49:46,806 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:49:46,815 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:49:46,826 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:49:46,833 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:49:46,840 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:49:46,850 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:50:08,897 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:50:08,898 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:20:08.894689+00:00'
        RETURNING id
        
2025-05-19 12:50:08,898 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:51:08,891 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:51:08,891 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:21:08.886734+00:00'
        RETURNING id
        
2025-05-19 12:51:08,892 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:51:53,708 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:51:53,718 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 12:51:53,724 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:51:53,729 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 12:51:53,730 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 12:51:53,730 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 12:51:53,731 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 12:51:53,738 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:51:53,745 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:51:53,754 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:51:53,798 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:51:53,798 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:51:53,809 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:51:53,811 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:51:53,818 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:51:53,828 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:51:53,832 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:51:53,838 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:51:53,845 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:51:58,214 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:51:58,221 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:51:58,221 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:51:58,232 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:51:58,232 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:51:58,239 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:51:58,664 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:51:58,678 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:52:02,025 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:52:02,036 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:52:02,102 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:52:02,114 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:52:02,122 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:52:02,136 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:52:02,145 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 12:52:02,154 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 12:52:02,160 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 12:52:02,167 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 12:52:02,177 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 12:52:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:52:08,895 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:22:08.890980+00:00'
        RETURNING id
        
2025-05-19 12:52:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:53:08,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:53:08,886 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:23:08.883230+00:00'
        RETURNING id
        
2025-05-19 12:53:08,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:54:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:54:08,894 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:24:08.891148+00:00'
        RETURNING id
        
2025-05-19 12:54:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:55:08,893 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:55:08,893 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:25:08.889747+00:00'
        RETURNING id
        
2025-05-19 12:55:08,893 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:56:08,887 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:56:08,887 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:26:08.884316+00:00'
        RETURNING id
        
2025-05-19 12:56:08,888 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:57:08,895 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:57:08,896 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:27:08.892462+00:00'
        RETURNING id
        
2025-05-19 12:57:08,904 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:58:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:58:08,894 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:28:08.891166+00:00'
        RETURNING id
        
2025-05-19 12:58:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:58:21,458 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:58:21,458 - api.utils.logging - INFO - Executing operation: UPDATE courses SET name = 'FRONTEND DEVELOPMENT' WHERE id = 3
2025-05-19 12:58:21,459 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 12:58:23,128 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 12:58:23,132 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 12:58:25,577 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 12:58:25,580 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 12:58:25,590 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-19 12:58:25,593 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-19 12:59:08,897 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 12:59:08,898 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:29:08.894410+00:00'
        RETURNING id
        
2025-05-19 12:59:08,898 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:00:08,896 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:00:08,896 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:30:08.892748+00:00'
        RETURNING id
        
2025-05-19 13:00:08,896 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:01:08,906 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:01:08,906 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:31:08.902877+00:00'
        RETURNING id
        
2025-05-19 13:01:08,906 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:02:08,901 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:02:08,901 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:32:08.898022+00:00'
        RETURNING id
        
2025-05-19 13:02:08,901 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:03:08,894 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:03:08,894 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:33:08.888007+00:00'
        RETURNING id
        
2025-05-19 13:03:08,895 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:03:13,973 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:13,981 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 13:03:13,984 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:13,986 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:13,992 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 13:03:13,993 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 13:03:13,994 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 13:03:13,995 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 13:03:16,026 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:16,036 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:16,490 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 13:03:16,490 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 13:03:16,497 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 13:03:16,499 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:16,500 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 13:03:16,503 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 13:03:16,512 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 13:03:16,517 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 13:03:16,522 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 13:03:21,636 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-19 13:03:21,641 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:03:21,641 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'learning_material', 'New Learning Material', 'draft')
2025-05-19 13:03:21,642 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-19 13:03:21,643 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 12, 3, 7)
2025-05-19 13:03:21,643 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:03:21,658 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 7 AND t.deleted_at IS NULL
            
2025-05-19 13:03:22,383 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 12 AND deleted_at IS NULL
        
2025-05-19 13:03:22,383 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 12 AND deleted_at IS NULL
        
2025-05-19 13:03:22,387 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 12
2025-05-19 13:03:22,401 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 12
2025-05-19 13:03:27,816 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:27,821 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:27,831 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 13:03:27,835 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:27,838 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 13:03:27,839 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 13:03:27,839 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 13:03:27,840 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 13:03:31,572 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:31,580 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:31,602 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 13:03:31,658 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 13:03:31,664 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 13:03:31,664 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:03:31,667 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 13:03:31,668 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 13:03:31,676 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 13:03:31,680 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 13:03:31,685 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 13:03:36,682 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:03:36,682 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks SET deleted_at = '2025-05-19 13:03:36.679023' WHERE id = 12 AND deleted_at IS NULL
        
2025-05-19 13:03:36,682 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:03:48,925 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-19 13:03:48,928 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:03:48,928 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'learning_material', 'New Learning Material', 'draft')
2025-05-19 13:03:48,929 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-19 13:03:48,930 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 13, 3, 8)
2025-05-19 13:03:48,930 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:03:48,938 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 8 AND t.deleted_at IS NULL
            
2025-05-19 13:04:08,900 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:04:08,901 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:34:08.897975+00:00'
        RETURNING id
        
2025-05-19 13:04:08,902 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:05:08,886 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:05:08,886 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:35:08.883953+00:00'
        RETURNING id
        
2025-05-19 13:05:08,887 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:06:08,889 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:06:08,889 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 07:36:08.886129+00:00'
        RETURNING id
        
2025-05-19 13:06:08,890 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:52:28,291 - api.utils.logging - INFO - Logging system initialized
2025-05-19 13:52:29,096 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-19 13:52:29,096 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-19 13:52:58,902 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:58,917 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 13:52:58,922 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:58,926 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 13:52:58,927 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 13:52:58,928 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 13:52:58,928 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 13:52:58,939 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:58,952 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:58,964 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:58,985 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:59,016 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 13:52:59,022 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 13:52:59,031 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 13:52:59,047 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 13:52:59,056 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:59,067 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 13:52:59,073 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 13:52:59,078 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 13:52:59,090 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 13:52:59,097 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:59,382 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:59,390 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:59,431 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:59,472 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 13:52:59,476 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 13:52:59,478 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 13:52:59,484 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 13:52:59,489 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 13:52:59,494 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 13:52:59,502 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 13:52:59,507 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 13:52:59,512 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 13:53:28,472 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:53:28,473 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:23:28.469174+00:00'
        RETURNING id
        
2025-05-19 13:53:28,475 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:54:28,475 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:54:28,475 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:24:28.472287+00:00'
        RETURNING id
        
2025-05-19 13:54:28,476 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:55:28,475 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:55:28,476 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:25:28.472503+00:00'
        RETURNING id
        
2025-05-19 13:55:28,476 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:56:28,462 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:56:28,462 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:26:28.459098+00:00'
        RETURNING id
        
2025-05-19 13:56:28,462 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:57:28,483 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:57:28,483 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:27:28.479975+00:00'
        RETURNING id
        
2025-05-19 13:57:28,484 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:58:28,465 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:58:28,465 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:28:28.462432+00:00'
        RETURNING id
        
2025-05-19 13:58:28,466 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 13:59:28,484 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 13:59:28,484 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:29:28.472512+00:00'
        RETURNING id
        
2025-05-19 13:59:28,484 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 14:00:28,473 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 14:00:28,473 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:30:28.470282+00:00'
        RETURNING id
        
2025-05-19 14:00:28,473 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 14:01:28,472 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 14:01:28,472 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:31:28.469773+00:00'
        RETURNING id
        
2025-05-19 14:01:28,473 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 14:02:28,483 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 14:02:28,483 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:32:28.480407+00:00'
        RETURNING id
        
2025-05-19 14:02:28,484 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 14:03:28,468 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 14:03:28,468 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:33:28.465176+00:00'
        RETURNING id
        
2025-05-19 14:03:28,469 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 14:04:28,478 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 14:04:28,478 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 08:34:28.474857+00:00'
        RETURNING id
        
2025-05-19 14:04:28,478 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 16:56:12,815 - api.utils.logging - INFO - Logging system initialized
2025-05-19 16:56:13,309 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-19 16:56:13,328 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-19 16:56:34,428 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:56:34,432 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-19 16:56:34,439 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:56:34,439 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:56:34,460 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-19 16:56:34,462 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-19 16:56:34,463 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-19 16:56:34,464 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-19 16:56:47,818 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:56:47,824 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:56:47,863 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 16:56:47,872 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 16:56:47,883 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 16:56:47,900 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 16:56:47,908 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:56:47,915 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 16:56:47,918 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 16:56:47,923 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 16:56:47,930 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 16:57:07,780 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:57:07,797 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:57:07,848 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 16:57:07,862 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 16:57:07,875 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 16:57:07,890 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 16:57:07,902 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:57:07,917 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 16:57:07,926 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 16:57:07,935 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 16:57:07,953 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 16:57:11,196 - api.utils.logging - INFO - Executing operation: SELECT org_id FROM courses WHERE id = 3
2025-05-19 16:57:11,199 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 16:57:11,199 - api.utils.logging - INFO - Executing operation: INSERT INTO tasks (org_id, type, title, status) VALUES (1, 'learning_material', 'New Learning Material', 'draft')
2025-05-19 16:57:11,201 - api.utils.logging - INFO - Executing operation: SELECT COALESCE(MAX(ordering), -1) FROM course_tasks WHERE course_id = 3 AND milestone_id = 3
2025-05-19 16:57:11,201 - api.utils.logging - INFO - Executing operation: INSERT INTO course_tasks (course_id, task_id, milestone_id, ordering) VALUES (3, 14, 3, 9)
2025-05-19 16:57:11,201 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 16:57:11,218 - api.utils.logging - INFO - Executing operation: 
            SELECT COUNT(*) FROM course_tasks ct
            INNER JOIN tasks t ON ct.task_id = t.id
            WHERE ct.course_id = 3 AND ct.milestone_id = 3 AND ct.ordering < 9 AND t.deleted_at IS NULL
            
2025-05-19 16:57:12,983 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 16:57:12,985 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:27:12.980084+00:00'
        RETURNING id
        
2025-05-19 16:57:12,987 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 16:57:13,947 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:57:13,956 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:57:13,998 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 16:57:14,013 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 16:57:14,029 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 16:57:14,041 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 16:57:14,058 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 16:57:14,069 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 16:57:14,081 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 16:57:14,089 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 16:57:14,097 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 16:57:16,752 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 16:57:16,755 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 16:57:17,057 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 16:57:17,062 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 16:57:50,863 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 16:57:50,863 - api.utils.logging - INFO - Executing operation: UPDATE milestones SET name = 'PP332211SPRINT I' WHERE id = 3
2025-05-19 16:57:50,863 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 16:57:52,364 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 16:57:52,367 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 16:57:52,371 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 16:57:52,375 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 16:58:12,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 16:58:12,987 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:28:12.985105+00:00'
        RETURNING id
        
2025-05-19 16:58:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 16:59:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 16:59:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:29:12.986382+00:00'
        RETURNING id
        
2025-05-19 16:59:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:00:12,990 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:00:12,990 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:30:12.986858+00:00'
        RETURNING id
        
2025-05-19 17:00:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:01:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:01:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:31:12.978911+00:00'
        RETURNING id
        
2025-05-19 17:01:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:02:12,984 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:02:12,985 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:32:12.980423+00:00'
        RETURNING id
        
2025-05-19 17:02:12,985 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:03:12,975 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:03:12,975 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:33:12.972835+00:00'
        RETURNING id
        
2025-05-19 17:03:12,975 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:03:29,041 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:03:29,046 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:03:30,072 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:03:30,079 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:03:32,781 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:03:32,786 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:03:33,986 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:03:33,992 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:04:12,978 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:04:12,978 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:34:12.975267+00:00'
        RETURNING id
        
2025-05-19 17:04:12,979 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:04:14,061 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:04:14,064 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:04:20,060 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:04:20,063 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:04:22,922 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:04:22,926 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:04:32,095 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:04:32,099 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:05:12,984 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:05:12,984 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:35:12.981382+00:00'
        RETURNING id
        
2025-05-19 17:05:12,985 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:06:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:06:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:36:12.979156+00:00'
        RETURNING id
        
2025-05-19 17:06:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:07:12,990 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:07:12,990 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:37:12.987611+00:00'
        RETURNING id
        
2025-05-19 17:07:12,991 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:08:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:08:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:38:12.984270+00:00'
        RETURNING id
        
2025-05-19 17:08:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:09:12,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:09:12,987 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:39:12.983273+00:00'
        RETURNING id
        
2025-05-19 17:09:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:10:12,980 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:10:12,980 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:40:12.976707+00:00'
        RETURNING id
        
2025-05-19 17:10:12,980 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:11:12,983 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:11:12,984 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:41:12.980481+00:00'
        RETURNING id
        
2025-05-19 17:11:12,984 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:11:24,166 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:11:24,173 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:11:24,174 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Learning Material Editor!", "type": "text", "styles": {}}], "id": "1259e338-c126-439c-9a6c-d252170649c2", "position": 0}, {"type": "paragraph", "content": [{"text": "This is where you will create your learning material. You can either modify this template or remove it entirely to start from scratch.", "type": "text", "styles": {}}], "id": "238d410d-4061-4c1b-9772-09ac9bcc5fd5", "position": 1}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "e0b33e0c-1975-41ea-875b-d7058a025e30", "position": 2}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Key Features", "type": "text", "styles": {}}], "id": "5e1adf1b-fd7a-4f5d-a337-33eabe747691", "position": 3}, {"type": "bulletListItem", "content": [{"text": "Add new blocks by clicking the + icon that appears between blocks", "type": "text", "styles": {}}], "id": "f6e45ef5-f889-447a-865d-8d3042da1e4a", "position": 4}, {"type": "bulletListItem", "content": [{"text": "Reorder blocks using the side menu (hover near the left edge of any block and drag the button with 6 dots to reorder)", "type": "text", "styles": {}}], "id": "5dc517b5-77f2-49e4-a711-b285a99dde55", "position": 5}, {"type": "bulletListItem", "content": [{"text": "Format text using the toolbar that appears when you select text", "type": "text", "styles": {}}], "id": "abeb7ae1-6f69-44d5-9ec7-cf3f5f772bd8", "position": 6}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "076ef1e2-8002-4bae-80a0-04fd76af961d", "position": 7}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "id": "4f707ef9-45cf-4311-8299-ed634612b81c", "position": 8}, {"type": "paragraph", "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "id": "00c87f1e-30bc-434e-875a-93a119d44169", "position": 9}, {"type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "id": "51bc18e6-2582-4681-8ed5-c007b1379c68", "position": 10}, {"type": "bulletListItem", "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "id": "3eda4e6d-3832-4b16-8a33-aa972a62bdfb", "position": 11}, {"type": "numberedListItem", "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "id": "d4657556-e734-4677-ab77-301c748aeac3", "position": 12}, {"type": "checkListItem", "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "id": "73bba0e7-039f-40ac-8d63-ba6291cf3fe0", "position": 13}, {"type": "paragraph", "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "id": "4e9e2f9d-43d7-426e-9082-9bc7b2dd3980", "position": 14}, {"type": "paragraph", "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "id": "ccd2eba6-0f9b-4cfc-ab2e-1e74f6868237", "position": 15}, {"type": "paragraph", "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "id": "3ddfc6b7-9080-4adb-acc8-8e22197302f8", "position": 16}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "1fc4aeb9-8dd7-4011-824b-2a86f5731e6d", "position": 17}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "id": "643f4a3c-9cd3-4ab3-9621-d9d95b463b65", "position": 18}, {"type": "paragraph", "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "id": "ad9e4f50-9d39-472a-af60-182b63411201", "position": 19}, {"type": "bulletListItem", "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "id": "12c78102-dfec-4ee3-827a-3ca345e4a0f5", "position": 20}, {"type": "bulletListItem", "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "id": "17e9cc22-309c-42a6-9d06-669a7fa7cb99", "position": 21}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "b917e3fc-9a1c-4747-a8db-ae0ab1c80735", "position": 22}, {"type": "paragraph", "content": [{"text": "Here are examples of nested content:", "type": "text", "styles": {}}], "id": "7969b5d8-d7c5-4116-9b04-24478b05cdfb", "position": 23}, {"type": "paragraph", "content": [{"text": "Nested Lists Example", "type": "text", "styles": {"bold": true}}], "id": "a40a1460-654c-4999-b6d5-6143b951ca8c", "position": 24}, {"type": "bulletListItem", "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "id": "51949a34-0747-4355-8ea4-2183c9f139c9", "position": 25}, {"type": "bulletListItem", "content": [{"text": "Main topic 2", "type": "text", "styles": {}}], "id": "ef67f5c0-4972-4996-af35-8aac1cb31678", "position": 26}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "310dc57d-e02c-4b94-92ec-70743082884f", "position": 27}, {"type": "paragraph", "content": [{"text": "Nested Numbered Lists", "type": "text", "styles": {"bold": true}}], "id": "09382024-bd37-47cc-8258-6c2ffc89f7c7", "position": 28}, {"type": "numberedListItem", "content": [{"text": "First step", "type": "text", "styles": {}}], "children": [{"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.1 (indented with Tab)", "type": "text", "styles": {}}]}, {"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.2", "type": "text", "styles": {}}]}], "id": "f476cb89-6ea8-4244-874b-c0c0a5106f0d", "position": 29}, {"type": "numberedListItem", "content": [{"text": "Second step", "type": "text", "styles": {}}], "id": "45d98c50-e82b-4b89-b75b-77d28505e18c", "position": 30}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "83e6141d-cb3e-444a-8180-6be3bb26b02f", "position": 31}, {"type": "paragraph", "content": [{"text": "Tips for working with nested content:", "type": "text", "styles": {"bold": true}}], "id": "6ab8e342-2591-49d4-8805-6bec8aa1bad5", "position": 32}, {"type": "bulletListItem", "content": [{"text": "To unnest/outdent an item, press Shift+Tab", "type": "text", "styles": {}}], "id": "332ca5b7-5d13-469f-973e-faffa7c141e5", "position": 33}, {"type": "bulletListItem", "content": [{"text": "You can mix bullet and numbered lists in your nesting hierarchy", "type": "text", "styles": {}}], "id": "3a829e67-4e8e-4130-8813-3e12eeefdea5", "position": 34}, {"type": "bulletListItem", "content": [{"text": "Nesting helps create a clear organizational structure for complex topics", "type": "text", "styles": {}}], "id": "6957e7c6-e718-4f17-b861-6fe78bd10cac", "position": 35}, {"type": "paragraph", "content": [{"text": "", "type": "text", "styles": {}}], "id": "f3a20267-9d0f-4e86-99aa-3a4578c8a37a", "position": 36}, {"type": "heading", "props": {"level": 3}, "content": [{"text": "Publishing Your Content", "type": "text", "styles": {}}], "id": "6c618bb0-d899-4fbe-90f1-61dda1e8d384", "position": 37}, {"type": "paragraph", "content": [{"text": "When you are ready to make your content available to learners, click the Publish button. You can always edit and republish your content later.", "type": "text", "styles": {}}], "id": "2dd4e6ac-cf1f-4a23-80f1-f7b6b4b2130a", "position": 38}, {"type": "paragraph", "content": [{"text": "Feel free to delete or modify this template to create your own learning material!", "type": "text", "styles": {}}], "id": "6a93e8af-9374-4752-9960-e981fa229463", "position": 39}]', status = 'draft', title = 'New Learning Material', scheduled_publish_at = NULL WHERE id = 14
2025-05-19 17:11:24,175 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:11:24,187 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:11:24,190 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:11:28,171 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:11:28,174 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:12:12,976 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:12:12,976 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:42:12.973529+00:00'
        RETURNING id
        
2025-05-19 17:12:12,977 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:13:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:13:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:43:12.979433+00:00'
        RETURNING id
        
2025-05-19 17:13:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:14:12,980 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:14:12,980 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:44:12.976726+00:00'
        RETURNING id
        
2025-05-19 17:14:12,980 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:15:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:15:12,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:45:12.982776+00:00'
        RETURNING id
        
2025-05-19 17:15:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:16:12,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:16:12,987 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:46:12.974889+00:00'
        RETURNING id
        
2025-05-19 17:16:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:17:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:17:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:47:12.985327+00:00'
        RETURNING id
        
2025-05-19 17:17:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:17:51,067 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:17:51,071 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:17:51,072 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "1259e338-c126-439c-9a6c-d252170649c2", "type": "heading", "props": {"level": 2}, "content": [{"text": "Welcome to the Learning Material Editor!", "type": "text", "styles": {}}], "children": [], "position": 0}, {"id": "238d410d-4061-4c1b-9772-09ac9bcc5fd5", "type": "paragraph", "props": {}, "content": [{"text": "This is where you will create your learning material. You can either modify this template or remove it entirely to start from scratch.", "type": "text", "styles": {}}], "children": [], "position": 1}, {"id": "e0b33e0c-1975-41ea-875b-d7058a025e30", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 2}, {"id": "5e1adf1b-fd7a-4f5d-a337-33eabe747691", "type": "heading", "props": {"level": 3}, "content": [{"text": "Key Features", "type": "text", "styles": {}}], "children": [], "position": 3}, {"id": "f6e45ef5-f889-447a-865d-8d3042da1e4a", "type": "bulletListItem", "props": {}, "content": [{"text": "Add new blocks by clicking the + icon that appears between blocks", "type": "text", "styles": {}}], "children": [], "position": 4}, {"id": "5dc517b5-77f2-49e4-a711-b285a99dde55", "type": "bulletListItem", "props": {}, "content": [{"text": "Reorder blocks using the side menu (hover near the left edge of any block and drag the button with 6 dots to reorder)", "type": "text", "styles": {}}], "children": [], "position": 5}, {"id": "abeb7ae1-6f69-44d5-9ec7-cf3f5f772bd8", "type": "bulletListItem", "props": {}, "content": [{"text": "Format text using the toolbar that appears when you select text", "type": "text", "styles": {}}], "children": [], "position": 6}, {"id": "076ef1e2-8002-4bae-80a0-04fd76af961d", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 7}, {"id": "4f707ef9-45cf-4311-8299-ed634612b81c", "type": "heading", "props": {"level": 3}, "content": [{"text": "Available Block Types", "type": "text", "styles": {}}], "children": [], "position": 8}, {"id": "00c87f1e-30bc-434e-875a-93a119d44169", "type": "paragraph", "props": {}, "content": [{"text": "Here are some examples of the different types of blocks you can use:", "type": "text", "styles": {}}], "children": [], "position": 9}, {"id": "51bc18e6-2582-4681-8ed5-c007b1379c68", "type": "heading", "props": {"level": 2}, "content": [{"text": "Headings (like this one)", "type": "text", "styles": {}}], "children": [], "position": 10}, {"id": "3eda4e6d-3832-4b16-8a33-aa972a62bdfb", "type": "bulletListItem", "props": {}, "content": [{"text": "Bullet lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 11}, {"id": "d4657556-e734-4677-ab77-301c748aeac3", "type": "numberedListItem", "props": {}, "content": [{"text": "Numbered lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 12}, {"id": "73bba0e7-039f-40ac-8d63-ba6291cf3fe0", "type": "checkListItem", "props": {}, "content": [{"text": "Check lists (like this)", "type": "text", "styles": {}}], "children": [], "position": 13}, {"id": "4e9e2f9d-43d7-426e-9082-9bc7b2dd3980", "type": "paragraph", "props": {}, "content": [{"text": "Regular paragraphs for your main content", "type": "text", "styles": {}}], "children": [], "position": 14}, {"id": "ccd2eba6-0f9b-4cfc-ab2e-1e74f6868237", "type": "paragraph", "props": {}, "content": [{"text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "type": "text", "styles": {}}], "children": [], "position": 15}, {"id": "3ddfc6b7-9080-4adb-acc8-8e22197302f8", "type": "paragraph", "props": {}, "content": [{"text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "type": "text", "styles": {}}], "children": [], "position": 16}, {"id": "1fc4aeb9-8dd7-4011-824b-2a86f5731e6d", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 17}, {"id": "643f4a3c-9cd3-4ab3-9621-d9d95b463b65", "type": "heading", "props": {"level": 3}, "content": [{"text": "Creating Nested Content", "type": "text", "styles": {}}], "children": [], "position": 18}, {"id": "ad9e4f50-9d39-472a-af60-182b63411201", "type": "paragraph", "props": {}, "content": [{"text": "You can create nested content in two ways:", "type": "text", "styles": {}}], "children": [], "position": 19}, {"id": "12c78102-dfec-4ee3-827a-3ca345e4a0f5", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "type": "text", "styles": {}}], "children": [], "position": 20}, {"id": "17e9cc22-309c-42a6-9d06-669a7fa7cb99", "type": "bulletListItem", "props": {}, "content": [{"text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "type": "text", "styles": {}}], "children": [], "position": 21}, {"id": "b917e3fc-9a1c-4747-a8db-ae0ab1c80735", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 22}, {"id": "7969b5d8-d7c5-4116-9b04-24478b05cdfb", "type": "paragraph", "props": {}, "content": [{"text": "Here are examples of nested content:", "type": "text", "styles": {}}], "children": [], "position": 23}, {"id": "a40a1460-654c-4999-b6d5-6143b951ca8c", "type": "paragraph", "props": {}, "content": [{"text": "Nested Lists Example", "type": "text", "styles": {"bold": true}}], "children": [], "position": 24}, {"id": "51949a34-0747-4355-8ea4-2183c9f139c9", "type": "bulletListItem", "props": {}, "content": [{"text": "Main topic 1", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.1 (indented using Tab or side menu)", "type": "text", "styles": {}}]}, {"type": "bulletListItem", "props": {"indent": 1}, "content": [{"text": "Subtopic 1.2", "type": "text", "styles": {}}], "children": [{"type": "bulletListItem", "props": {"indent": 2}, "content": [{"text": "Further nested item (press Tab again to create deeper nesting)", "type": "text", "styles": {}}]}]}], "position": 25}, {"id": "ef67f5c0-4972-4996-af35-8aac1cb31678", "type": "bulletListItem", "props": {}, "content": [{"text": "Main topic 2", "type": "text", "styles": {}}], "children": [], "position": 26}, {"id": "310dc57d-e02c-4b94-92ec-70743082884f", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 27}, {"id": "09382024-bd37-47cc-8258-6c2ffc89f7c7", "type": "paragraph", "props": {}, "content": [{"text": "Nested Numbered Lists", "type": "text", "styles": {"bold": true}}], "children": [], "position": 28}, {"id": "f476cb89-6ea8-4244-874b-c0c0a5106f0d", "type": "numberedListItem", "props": {}, "content": [{"text": "First step", "type": "text", "styles": {}}], "children": [{"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.1 (indented with Tab)", "type": "text", "styles": {}}]}, {"type": "numberedListItem", "props": {"indent": 1}, "content": [{"text": "Substep 1.2", "type": "text", "styles": {}}]}], "position": 29}, {"id": "45d98c50-e82b-4b89-b75b-77d28505e18c", "type": "numberedListItem", "props": {}, "content": [{"text": "Second step", "type": "text", "styles": {}}], "children": [], "position": 30}, {"id": "83e6141d-cb3e-444a-8180-6be3bb26b02f", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 31}, {"id": "6ab8e342-2591-49d4-8805-6bec8aa1bad5", "type": "paragraph", "props": {}, "content": [{"text": "Tips for working with nested content:", "type": "text", "styles": {"bold": true}}], "children": [], "position": 32}, {"id": "332ca5b7-5d13-469f-973e-faffa7c141e5", "type": "bulletListItem", "props": {}, "content": [{"text": "To unnest/outdent an item, press Shift+Tab", "type": "text", "styles": {}}], "children": [], "position": 33}, {"id": "3a829e67-4e8e-4130-8813-3e12eeefdea5", "type": "bulletListItem", "props": {}, "content": [{"text": "You can mix bullet and numbered lists in your nesting hierarchy", "type": "text", "styles": {}}], "children": [], "position": 34}, {"id": "6957e7c6-e718-4f17-b861-6fe78bd10cac", "type": "bulletListItem", "props": {}, "content": [{"text": "Nesting helps create a clear organizational structure for complex topics", "type": "text", "styles": {}}], "children": [], "position": 35}, {"id": "f3a20267-9d0f-4e86-99aa-3a4578c8a37a", "type": "paragraph", "props": {}, "content": [{"text": "", "type": "text", "styles": {}}], "children": [], "position": 36}, {"id": "6c618bb0-d899-4fbe-90f1-61dda1e8d384", "type": "heading", "props": {"level": 3}, "content": [{"text": "Publishing Your Content", "type": "text", "styles": {}}], "children": [], "position": 37}, {"id": "2dd4e6ac-cf1f-4a23-80f1-f7b6b4b2130a", "type": "paragraph", "props": {}, "content": [{"text": "When you are ready to make your content available to learners, click the Publish button. You can always edit and republish your content later.", "type": "text", "styles": {}}], "children": [], "position": 38}, {"id": "6a93e8af-9374-4752-9960-e981fa229463", "type": "paragraph", "props": {}, "content": [{"text": "Feel free to delete or modify this template to create your own learning material!", "type": "text", "styles": {}}], "children": [], "position": 39}]', status = 'published', title = 'New Learning Material', scheduled_publish_at = NULL WHERE id = 14
2025-05-19 17:17:51,072 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:17:51,084 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:17:51,087 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:18:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:18:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:48:12.984872+00:00'
        RETURNING id
        
2025-05-19 17:18:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:18:33,683 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:18:33,686 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:19:13,010 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:19:13,010 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:49:12.987235+00:00'
        RETURNING id
        
2025-05-19 17:19:13,011 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:20:12,981 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:20:12,981 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:50:12.978627+00:00'
        RETURNING id
        
2025-05-19 17:20:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:21:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:21:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:51:12.986078+00:00'
        RETURNING id
        
2025-05-19 17:21:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:21:47,340 - api.utils.logging - INFO - Executing operation: 
        SELECT id
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:21:47,345 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:21:47,345 - api.utils.logging - INFO - Executing operation: UPDATE tasks SET blocks = '[{"id": "1259e338-c126-439c-9a6c-d252170649c2", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Welcome to the Learning Material Editor!", "styles": {}}], "children": [], "position": 0}, {"id": "238d410d-4061-4c1b-9772-09ac9bcc5fd5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "This is where you will create your learning material. You can either modify this template or remove it entirely to start from scratch.", "styles": {}}], "children": [], "position": 1}, {"id": "e0b33e0c-1975-41ea-875b-d7058a025e30", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 2}, {"id": "5e1adf1b-fd7a-4f5d-a337-33eabe747691", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Key Features", "styles": {}}], "children": [], "position": 3}, {"id": "f6e45ef5-f889-447a-865d-8d3042da1e4a", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Add new blocks by clicking the + icon that appears between blocks", "styles": {}}], "children": [], "position": 4}, {"id": "5dc517b5-77f2-49e4-a711-b285a99dde55", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Reorder blocks using the side menu (hover near the left edge of any block and drag the button with 6 dots to reorder)", "styles": {}}], "children": [], "position": 5}, {"id": "abeb7ae1-6f69-44d5-9ec7-cf3f5f772bd8", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Format text using the toolbar that appears when you pick text", "styles": {}}], "children": [], "position": 6}, {"id": "076ef1e2-8002-4bae-80a0-04fd76af961d", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 7}, {"id": "4f707ef9-45cf-4311-8299-ed634612b81c", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Available Block Types", "styles": {}}], "children": [], "position": 8}, {"id": "00c87f1e-30bc-434e-875a-93a119d44169", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Here are some examples of the different types of blocks you can use:", "styles": {}}], "children": [], "position": 9}, {"id": "51bc18e6-2582-4681-8ed5-c007b1379c68", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 2}, "content": [{"type": "text", "text": "Headings (like this one)", "styles": {}}], "children": [], "position": 10}, {"id": "3eda4e6d-3832-4b16-8a33-aa972a62bdfb", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Bullet lists (like this)", "styles": {}}], "children": [], "position": 11}, {"id": "d4657556-e734-4677-ab77-301c748aeac3", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Numbered lists (like this)", "styles": {}}], "children": [], "position": 12}, {"id": "73bba0e7-039f-40ac-8d63-ba6291cf3fe0", "type": "checkListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "checked": false}, "content": [{"type": "text", "text": "Check lists (like this)", "styles": {}}], "children": [], "position": 13}, {"id": "4e9e2f9d-43d7-426e-9082-9bc7b2dd3980", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Regular paragraphs for your main content", "styles": {}}], "children": [], "position": 14}, {"id": "ccd2eba6-0f9b-4cfc-ab2e-1e74f6868237", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Insert images/videos/audio clips by clicking the + icon on the left and selecting Image/Video/Audio", "styles": {}}], "children": [], "position": 15}, {"id": "3ddfc6b7-9080-4adb-acc8-8e22197302f8", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Insert code blocks by clicking the + icon on the left and selecting Code Block", "styles": {}}], "children": [], "position": 16}, {"id": "1fc4aeb9-8dd7-4011-824b-2a86f5731e6d", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 17}, {"id": "643f4a3c-9cd3-4ab3-9621-d9d95b463b65", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Creating Nested Content", "styles": {}}], "children": [], "position": 18}, {"id": "ad9e4f50-9d39-472a-af60-182b63411201", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "You can create nested content in two ways:", "styles": {}}], "children": [], "position": 19}, {"id": "12c78102-dfec-4ee3-827a-3ca345e4a0f5", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Using the Tab key: Simply press Tab while your cursor is on a block to indent it", "styles": {}}], "children": [], "position": 20}, {"id": "17e9cc22-309c-42a6-9d06-669a7fa7cb99", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Using the side menu: Hover near the left edge of a block, click the menu icon (the button with 6 dots), and drag the block to the desired nested position inside another block", "styles": {}}], "children": [], "position": 21}, {"id": "b917e3fc-9a1c-4747-a8db-ae0ab1c80735", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 22}, {"id": "7969b5d8-d7c5-4116-9b04-24478b05cdfb", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Here are examples of nested content:", "styles": {}}], "children": [], "position": 23}, {"id": "a40a1460-654c-4999-b6d5-6143b951ca8c", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Nested Lists Example", "styles": {"bold": true}}], "children": [], "position": 24}, {"id": "51949a34-0747-4355-8ea4-2183c9f139c9", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Main topic 1", "styles": {}}], "children": [{"id": "8e354af3-8e3a-4495-97a4-c3fa4dd2905a", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Subtopic 1.1 (indented using Tab or side menu)", "styles": {}}], "children": []}, {"id": "b4d95289-2cf8-4467-b610-073e355b80fc", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Subtopic 1.2", "styles": {}}], "children": [{"id": "5fd4a9d8-56a3-44b5-814b-75c2b03d0f90", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Further nested item (press Tab again to create deeper nesting)", "styles": {}}], "children": []}]}], "position": 25}, {"id": "ef67f5c0-4972-4996-af35-8aac1cb31678", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Main topic 2", "styles": {}}], "children": [], "position": 26}, {"id": "310dc57d-e02c-4b94-92ec-70743082884f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 27}, {"id": "09382024-bd37-47cc-8258-6c2ffc89f7c7", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Nested Numbered Lists", "styles": {"bold": true}}], "children": [], "position": 28}, {"id": "f476cb89-6ea8-4244-874b-c0c0a5106f0d", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "First step", "styles": {}}], "children": [{"id": "04fade62-fb8c-4038-a62f-512ba1d17b34", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Substep 1.1 (indented with Tab)", "styles": {}}], "children": []}, {"id": "4f4178b2-f0f2-4223-b381-3da9dd5edb9d", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Substep 1.2", "styles": {}}], "children": []}], "position": 29}, {"id": "45d98c50-e82b-4b89-b75b-77d28505e18c", "type": "numberedListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Second step", "styles": {}}], "children": [], "position": 30}, {"id": "83e6141d-cb3e-444a-8180-6be3bb26b02f", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 31}, {"id": "6ab8e342-2591-49d4-8805-6bec8aa1bad5", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Tips for working with nested content:", "styles": {"bold": true}}], "children": [], "position": 32}, {"id": "332ca5b7-5d13-469f-973e-faffa7c141e5", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "To unnest/outdent an item, press Shift+Tab", "styles": {}}], "children": [], "position": 33}, {"id": "3a829e67-4e8e-4130-8813-3e12eeefdea5", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "You can mix bullet and numbered lists in your nesting hierarchy", "styles": {}}], "children": [], "position": 34}, {"id": "6957e7c6-e718-4f17-b861-6fe78bd10cac", "type": "bulletListItem", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Nesting helps create a clear organizational structure for complex topics", "styles": {}}], "children": [], "position": 35}, {"id": "f3a20267-9d0f-4e86-99aa-3a4578c8a37a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 36}, {"id": "6c618bb0-d899-4fbe-90f1-61dda1e8d384", "type": "heading", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left", "level": 3}, "content": [{"type": "text", "text": "Publishing Your Content", "styles": {}}], "children": [], "position": 37}, {"id": "2dd4e6ac-cf1f-4a23-80f1-f7b6b4b2130a", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "When you are ready to make your content available to learners, click the Publish button. You can always edit and republish your content later.", "styles": {}}], "children": [], "position": 38}, {"id": "6a93e8af-9374-4752-9960-e981fa229463", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [{"type": "text", "text": "Feel free to delete or modify this template to create your own learning material!", "styles": {}}], "children": [], "position": 39}, {"id": "4c0cbb8d-b4f0-43df-86c0-acd1526631c1", "type": "paragraph", "props": {"textColor": "default", "backgroundColor": "default", "textAlignment": "left"}, "content": [], "children": [], "position": 40}]', status = 'published', title = 'New Learning Material', scheduled_publish_at = NULL WHERE id = 14
2025-05-19 17:21:47,346 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:21:47,358 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:21:47,362 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:21:47,405 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:21:47,409 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:21:47,582 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:21:47,585 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:22:12,976 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:22:12,977 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:52:12.974074+00:00'
        RETURNING id
        
2025-05-19 17:22:12,977 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:22:44,064 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:22:44,067 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:22:48,056 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 14 AND deleted_at IS NULL
        
2025-05-19 17:22:48,060 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 14
2025-05-19 17:23:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:23:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:53:12.987177+00:00'
        RETURNING id
        
2025-05-19 17:23:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:24:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:24:12,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:54:12.983170+00:00'
        RETURNING id
        
2025-05-19 17:24:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:25:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:25:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:55:12.984876+00:00'
        RETURNING id
        
2025-05-19 17:25:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:26:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:26:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:56:12.986721+00:00'
        RETURNING id
        
2025-05-19 17:26:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:27:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:27:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:57:12.979028+00:00'
        RETURNING id
        
2025-05-19 17:27:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:28:12,976 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:28:12,977 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:58:12.973462+00:00'
        RETURNING id
        
2025-05-19 17:28:12,977 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:29:09,234 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 17:29:09,244 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 17:29:09,289 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 17:29:09,305 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 17:29:09,312 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 17:29:09,322 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 17:29:09,341 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 17:29:09,351 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 17:29:09,360 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 17:29:09,366 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 17:29:09,374 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 17:29:11,760 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 13 AND deleted_at IS NULL
        
2025-05-19 17:29:11,761 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 13 AND deleted_at IS NULL
        
2025-05-19 17:29:11,768 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 13
2025-05-19 17:29:11,768 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 13
2025-05-19 17:29:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:29:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 11:59:12.979330+00:00'
        RETURNING id
        
2025-05-19 17:29:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:30:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:30:12,983 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:00:12.979434+00:00'
        RETURNING id
        
2025-05-19 17:30:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:31:12,984 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:31:12,984 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:01:12.981597+00:00'
        RETURNING id
        
2025-05-19 17:31:12,985 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:32:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:32:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:02:12.984730+00:00'
        RETURNING id
        
2025-05-19 17:32:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:33:12,978 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:33:12,978 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:03:12.974833+00:00'
        RETURNING id
        
2025-05-19 17:33:12,978 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:34:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:34:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:04:12.979326+00:00'
        RETURNING id
        
2025-05-19 17:34:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:35:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:35:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:05:12.978690+00:00'
        RETURNING id
        
2025-05-19 17:35:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:36:12,983 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:36:12,983 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:06:12.980724+00:00'
        RETURNING id
        
2025-05-19 17:36:12,984 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:37:12,990 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:37:12,990 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:07:12.986779+00:00'
        RETURNING id
        
2025-05-19 17:37:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:38:12,983 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:38:12,983 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:08:12.980124+00:00'
        RETURNING id
        
2025-05-19 17:38:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:38:38,969 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 17:38:38,983 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 17:38:39,034 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 17:38:39,054 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 17:38:39,062 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 17:38:39,073 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 17:38:39,086 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-19 17:38:39,096 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-19 17:38:39,103 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-19 17:38:39,110 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-19 17:38:39,120 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-19 17:38:41,748 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 13 AND deleted_at IS NULL
        
2025-05-19 17:38:41,749 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 13 AND deleted_at IS NULL
        
2025-05-19 17:38:41,753 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 13
2025-05-19 17:38:41,754 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 13
2025-05-19 17:39:12,999 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:39:12,999 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:09:12.996309+00:00'
        RETURNING id
        
2025-05-19 17:39:13,000 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:40:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:40:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:10:12.985318+00:00'
        RETURNING id
        
2025-05-19 17:40:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:41:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:41:12,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:11:12.983859+00:00'
        RETURNING id
        
2025-05-19 17:41:12,987 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:42:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:42:12,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:12:12.982709+00:00'
        RETURNING id
        
2025-05-19 17:42:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:43:12,976 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:43:12,976 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:13:12.973864+00:00'
        RETURNING id
        
2025-05-19 17:43:12,977 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:44:12,976 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:44:12,976 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:14:12.973730+00:00'
        RETURNING id
        
2025-05-19 17:44:12,976 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:45:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:45:12,983 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:15:12.979348+00:00'
        RETURNING id
        
2025-05-19 17:45:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:46:12,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:46:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:16:12.984242+00:00'
        RETURNING id
        
2025-05-19 17:46:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:47:12,981 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:47:12,981 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:17:12.978608+00:00'
        RETURNING id
        
2025-05-19 17:47:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:48:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:48:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:18:12.979244+00:00'
        RETURNING id
        
2025-05-19 17:48:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:49:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:49:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:19:12.979162+00:00'
        RETURNING id
        
2025-05-19 17:49:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:50:12,991 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:50:12,991 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:20:12.985987+00:00'
        RETURNING id
        
2025-05-19 17:50:12,991 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:51:12,998 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:51:12,999 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:21:12.986054+00:00'
        RETURNING id
        
2025-05-19 17:51:12,999 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:52:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:52:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:22:12.978441+00:00'
        RETURNING id
        
2025-05-19 17:52:12,991 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:53:12,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:53:12,987 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:23:12.984352+00:00'
        RETURNING id
        
2025-05-19 17:53:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:54:12,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:54:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:24:12.984639+00:00'
        RETURNING id
        
2025-05-19 17:54:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:55:12,995 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:55:12,995 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:25:12.983127+00:00'
        RETURNING id
        
2025-05-19 17:55:12,996 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:56:12,977 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:56:12,978 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:26:12.974753+00:00'
        RETURNING id
        
2025-05-19 17:56:12,978 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:57:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:57:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:27:12.979112+00:00'
        RETURNING id
        
2025-05-19 17:57:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:58:12,980 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:58:12,980 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:28:12.977207+00:00'
        RETURNING id
        
2025-05-19 17:58:12,981 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 17:59:12,990 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 17:59:12,990 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:29:12.987011+00:00'
        RETURNING id
        
2025-05-19 17:59:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:00:12,978 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:00:12,978 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:30:12.975331+00:00'
        RETURNING id
        
2025-05-19 18:00:12,979 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:01:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:01:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:31:12.986281+00:00'
        RETURNING id
        
2025-05-19 18:01:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:02:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:02:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:32:12.986615+00:00'
        RETURNING id
        
2025-05-19 18:02:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:03:12,985 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:03:12,985 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:33:12.981737+00:00'
        RETURNING id
        
2025-05-19 18:03:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:04:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:04:12,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:34:12.983625+00:00'
        RETURNING id
        
2025-05-19 18:04:12,987 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:05:12,991 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:05:12,991 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:35:12.978870+00:00'
        RETURNING id
        
2025-05-19 18:05:12,992 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:06:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:06:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:36:12.979589+00:00'
        RETURNING id
        
2025-05-19 18:06:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:07:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:07:12,983 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:37:12.980396+00:00'
        RETURNING id
        
2025-05-19 18:07:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:08:12,981 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:08:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:38:12.979434+00:00'
        RETURNING id
        
2025-05-19 18:08:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:09:12,977 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:09:12,977 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:39:12.974171+00:00'
        RETURNING id
        
2025-05-19 18:09:12,977 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:10:12,977 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:10:12,978 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:40:12.974307+00:00'
        RETURNING id
        
2025-05-19 18:10:12,978 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:11:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:11:12,990 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:41:12.986890+00:00'
        RETURNING id
        
2025-05-19 18:11:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:12:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:12:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:42:12.986137+00:00'
        RETURNING id
        
2025-05-19 18:12:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:13:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:13:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:43:12.985858+00:00'
        RETURNING id
        
2025-05-19 18:13:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:14:12,990 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:14:12,990 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:44:12.987090+00:00'
        RETURNING id
        
2025-05-19 18:14:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:15:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:15:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:45:12.979524+00:00'
        RETURNING id
        
2025-05-19 18:15:12,983 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:16:12,983 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:16:12,984 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:46:12.981111+00:00'
        RETURNING id
        
2025-05-19 18:16:12,984 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:17:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:17:12,987 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:47:12.983555+00:00'
        RETURNING id
        
2025-05-19 18:17:12,987 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:18:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:18:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:48:12.977338+00:00'
        RETURNING id
        
2025-05-19 18:18:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:19:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:19:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:49:12.979220+00:00'
        RETURNING id
        
2025-05-19 18:19:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:20:12,977 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:20:12,977 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:50:12.974276+00:00'
        RETURNING id
        
2025-05-19 18:20:12,978 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:21:12,984 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:21:12,984 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:51:12.980960+00:00'
        RETURNING id
        
2025-05-19 18:21:12,985 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:22:12,977 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:22:12,977 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:52:12.974744+00:00'
        RETURNING id
        
2025-05-19 18:22:12,978 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:23:12,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:23:12,987 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:53:12.984477+00:00'
        RETURNING id
        
2025-05-19 18:23:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:24:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:24:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:54:12.985629+00:00'
        RETURNING id
        
2025-05-19 18:24:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:25:12,981 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:25:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:55:12.978861+00:00'
        RETURNING id
        
2025-05-19 18:25:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:26:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:26:12,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:56:12.982810+00:00'
        RETURNING id
        
2025-05-19 18:26:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:27:12,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:27:12,987 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:57:12.984688+00:00'
        RETURNING id
        
2025-05-19 18:27:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:28:12,984 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:28:12,984 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:58:12.981554+00:00'
        RETURNING id
        
2025-05-19 18:28:12,985 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:29:12,984 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:29:12,984 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 12:59:12.980827+00:00'
        RETURNING id
        
2025-05-19 18:29:12,984 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:30:12,985 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:30:12,985 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:00:12.982302+00:00'
        RETURNING id
        
2025-05-19 18:30:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:31:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:31:12,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:01:12.982603+00:00'
        RETURNING id
        
2025-05-19 18:31:12,987 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:32:12,981 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:32:12,981 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:02:12.977477+00:00'
        RETURNING id
        
2025-05-19 18:32:12,981 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:33:12,990 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:33:12,990 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:03:12.986309+00:00'
        RETURNING id
        
2025-05-19 18:33:12,991 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:34:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:34:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:04:12.979591+00:00'
        RETURNING id
        
2025-05-19 18:34:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:35:12,983 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:35:12,983 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:05:12.980703+00:00'
        RETURNING id
        
2025-05-19 18:35:12,984 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:36:12,981 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:36:12,981 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:06:12.977403+00:00'
        RETURNING id
        
2025-05-19 18:36:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:37:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:37:12,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:07:12.982663+00:00'
        RETURNING id
        
2025-05-19 18:37:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:38:12,985 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:38:12,985 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:08:12.983045+00:00'
        RETURNING id
        
2025-05-19 18:38:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:39:12,986 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:39:12,986 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:09:12.983008+00:00'
        RETURNING id
        
2025-05-19 18:39:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:40:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:40:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:10:12.984513+00:00'
        RETURNING id
        
2025-05-19 18:40:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:41:12,987 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:41:12,987 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:11:12.984333+00:00'
        RETURNING id
        
2025-05-19 18:41:12,988 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:42:12,985 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:42:12,985 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:12:12.982120+00:00'
        RETURNING id
        
2025-05-19 18:42:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:43:12,978 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:43:12,978 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:13:12.975534+00:00'
        RETURNING id
        
2025-05-19 18:43:12,979 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:44:12,980 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:44:12,981 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:14:12.977571+00:00'
        RETURNING id
        
2025-05-19 18:44:12,981 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:45:12,980 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:45:12,980 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:15:12.976939+00:00'
        RETURNING id
        
2025-05-19 18:45:12,980 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:46:12,979 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:46:12,979 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:16:12.975702+00:00'
        RETURNING id
        
2025-05-19 18:46:12,979 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:47:12,977 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:47:12,977 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:17:12.973681+00:00'
        RETURNING id
        
2025-05-19 18:47:12,977 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:48:12,980 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:48:12,980 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:18:12.977181+00:00'
        RETURNING id
        
2025-05-19 18:48:12,980 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:49:12,983 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:49:12,984 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:19:12.980486+00:00'
        RETURNING id
        
2025-05-19 18:49:12,984 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:50:12,985 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:50:12,985 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:20:12.982888+00:00'
        RETURNING id
        
2025-05-19 18:50:12,986 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:51:12,984 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:51:12,992 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:21:12.981428+00:00'
        RETURNING id
        
2025-05-19 18:51:12,993 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:52:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:52:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:22:12.985525+00:00'
        RETURNING id
        
2025-05-19 18:52:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:53:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:53:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:23:12.984767+00:00'
        RETURNING id
        
2025-05-19 18:53:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:54:12,977 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:54:12,978 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:24:12.975234+00:00'
        RETURNING id
        
2025-05-19 18:54:12,978 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:55:12,976 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:55:12,977 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:25:12.974206+00:00'
        RETURNING id
        
2025-05-19 18:55:12,977 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:56:12,981 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:56:12,981 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:26:12.978050+00:00'
        RETURNING id
        
2025-05-19 18:56:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:57:12,979 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:57:12,979 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:27:12.976015+00:00'
        RETURNING id
        
2025-05-19 18:57:12,979 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:58:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:58:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:28:12.986322+00:00'
        RETURNING id
        
2025-05-19 18:58:12,990 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 18:59:12,979 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 18:59:12,979 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:29:12.976058+00:00'
        RETURNING id
        
2025-05-19 18:59:12,979 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 19:00:12,977 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 19:00:12,977 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:30:12.974153+00:00'
        RETURNING id
        
2025-05-19 19:00:12,977 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 19:01:12,989 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 19:01:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:31:12.985712+00:00'
        RETURNING id
        
2025-05-19 19:01:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 19:02:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 19:02:12,988 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:32:12.985110+00:00'
        RETURNING id
        
2025-05-19 19:02:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 19:03:12,977 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 19:03:12,977 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:33:12.974499+00:00'
        RETURNING id
        
2025-05-19 19:03:12,978 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 19:04:12,988 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 19:04:12,989 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:34:12.985972+00:00'
        RETURNING id
        
2025-05-19 19:04:12,989 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-19 19:05:12,982 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-19 19:05:12,982 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-19 13:35:12.979195+00:00'
        RETURNING id
        
2025-05-19 19:05:12,982 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:46:17,087 - api.utils.logging - INFO - Logging system initialized
2025-05-21 10:46:17,874 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-21 10:46:17,893 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-21 10:47:17,273 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:47:17,273 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:17:17.259940+00:00'
        RETURNING id
        
2025-05-21 10:47:17,275 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:48:17,264 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:48:17,265 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:18:17.261620+00:00'
        RETURNING id
        
2025-05-21 10:48:17,265 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:49:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:49:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:19:17.253445+00:00'
        RETURNING id
        
2025-05-21 10:49:17,261 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:49:53,203 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-21 10:49:53,205 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:49:53,214 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:49:53,218 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:49:53,219 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-21 10:49:53,220 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-21 10:49:53,221 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-21 10:49:53,222 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-21 10:50:17,268 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:50:17,268 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:20:17.264242+00:00'
        RETURNING id
        
2025-05-21 10:50:17,271 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:51:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:51:17,264 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:21:17.259666+00:00'
        RETURNING id
        
2025-05-21 10:51:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:52:17,254 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:52:17,254 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:22:17.251391+00:00'
        RETURNING id
        
2025-05-21 10:52:17,255 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:53:04,457 - api.utils.logging - INFO - Executing operation: SELECT * FROM users WHERE email = 'saranz1593@gmail.com'
2025-05-21 10:53:05,255 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:53:05,261 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:53:05,266 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-21 10:53:05,270 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:53:05,274 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-21 10:53:05,276 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-21 10:53:05,276 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-21 10:53:05,277 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-21 10:53:12,116 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:53:12,123 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:53:12,145 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-21 10:53:12,156 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:53:12,165 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-21 10:53:12,174 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-21 10:53:12,182 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-21 10:53:12,191 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-21 10:53:12,200 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-21 10:53:12,209 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-21 10:53:12,219 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-21 10:53:12,243 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 10:53:17,268 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:53:17,268 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:23:17.263162+00:00'
        RETURNING id
        
2025-05-21 10:53:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:54:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:54:17,263 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:24:17.258321+00:00'
        RETURNING id
        
2025-05-21 10:54:17,263 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:55:17,262 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:55:17,262 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:25:17.258318+00:00'
        RETURNING id
        
2025-05-21 10:55:17,263 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:56:17,267 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:56:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:26:17.263273+00:00'
        RETURNING id
        
2025-05-21 10:56:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:57:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:57:17,257 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:27:17.252978+00:00'
        RETURNING id
        
2025-05-21 10:57:17,258 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:58:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:58:17,257 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:28:17.254284+00:00'
        RETURNING id
        
2025-05-21 10:58:17,257 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 10:59:17,262 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 10:59:17,262 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:29:17.258394+00:00'
        RETURNING id
        
2025-05-21 10:59:17,262 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:00:17,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:00:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:30:17.254253+00:00'
        RETURNING id
        
2025-05-21 11:00:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:01:17,259 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:01:17,259 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:31:17.255673+00:00'
        RETURNING id
        
2025-05-21 11:01:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:02:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:02:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:32:17.263285+00:00'
        RETURNING id
        
2025-05-21 11:02:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:03:17,268 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:03:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:33:17.265394+00:00'
        RETURNING id
        
2025-05-21 11:03:17,269 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:04:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:04:17,266 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:34:17.262744+00:00'
        RETURNING id
        
2025-05-21 11:04:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:05:17,272 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:05:17,272 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:35:17.267861+00:00'
        RETURNING id
        
2025-05-21 11:05:17,273 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:05:46,553 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-21 11:05:46,553 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 11:05:46,557 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-21 11:05:46,565 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-21 11:05:46,577 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-21 11:05:46,587 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-21 11:05:46,604 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-21 11:05:46,611 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-21 11:05:46,618 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-21 11:06:17,255 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:06:17,256 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:36:17.251191+00:00'
        RETURNING id
        
2025-05-21 11:06:17,258 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:07:17,260 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:07:17,260 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:37:17.256421+00:00'
        RETURNING id
        
2025-05-21 11:07:17,261 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:07:40,036 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:07:40,043 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:07:54,111 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-21 11:07:54,130 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-21 11:07:54,136 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-21 11:07:54,137 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-21 11:07:54,142 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-21 11:07:54,147 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            AND t.status = 'published' AND t.scheduled_publish_at IS NULL
            ORDER BY ct.milestone_id, ct.ordering
2025-05-21 11:07:54,432 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 11:07:54,447 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-21 11:08:17,265 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:08:17,265 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:38:17.261568+00:00'
        RETURNING id
        
2025-05-21 11:08:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:09:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:09:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:39:17.263580+00:00'
        RETURNING id
        
2025-05-21 11:09:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:10:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:10:17,266 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:40:17.262924+00:00'
        RETURNING id
        
2025-05-21 11:10:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:11:02,404 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:11:02,409 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:11:02,755 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:11:02,758 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:11:02,770 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:11:02,775 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:11:17,269 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:11:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:41:17.265425+00:00'
        RETURNING id
        
2025-05-21 11:11:17,270 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:11:21,744 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:11:21,751 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:11:59,595 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:11:59,601 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:12:17,265 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:12:17,265 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:42:17.261988+00:00'
        RETURNING id
        
2025-05-21 11:12:17,265 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:13:17,259 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:13:17,259 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:43:17.255670+00:00'
        RETURNING id
        
2025-05-21 11:13:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:14:17,259 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:14:17,259 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:44:17.255468+00:00'
        RETURNING id
        
2025-05-21 11:14:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:15:17,265 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:15:17,265 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:45:17.262026+00:00'
        RETURNING id
        
2025-05-21 11:15:17,266 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:16:17,255 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:16:17,256 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:46:17.252264+00:00'
        RETURNING id
        
2025-05-21 11:16:17,256 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:17:17,261 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:17:17,261 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:47:17.257216+00:00'
        RETURNING id
        
2025-05-21 11:17:17,262 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:18:17,253 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:18:17,254 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:48:17.250595+00:00'
        RETURNING id
        
2025-05-21 11:18:17,263 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:19:01,151 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-21 11:19:01,157 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-21 11:19:04,460 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:19:04,465 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:19:04,501 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:19:04,504 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:19:04,515 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:19:04,522 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:19:17,260 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:19:17,260 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:49:17.255737+00:00'
        RETURNING id
        
2025-05-21 11:19:17,261 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:20:17,267 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:20:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:50:17.263140+00:00'
        RETURNING id
        
2025-05-21 11:20:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:20:25,696 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 7 AND deleted_at IS NULL
        
2025-05-21 11:20:25,700 - api.utils.logging - INFO - Executing operation: 
            SELECT q.id, q.type, q.blocks, q.answer, q.input_type, q.response_type, qs.scorecard_id, q.context, q.coding_language, q.max_attempts, q.is_feedback_shown
            FROM questions q
            LEFT JOIN question_scorecards qs ON q.id = qs.question_id
            WHERE task_id = 7 ORDER BY position ASC
            
2025-05-21 11:20:29,242 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:20:29,248 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:20:29,271 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:20:29,275 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:20:29,283 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-21 11:20:29,293 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-21 11:21:17,255 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:21:17,255 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:51:17.251285+00:00'
        RETURNING id
        
2025-05-21 11:21:17,255 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:22:17,264 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:22:17,264 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:52:17.260413+00:00'
        RETURNING id
        
2025-05-21 11:22:17,264 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:23:17,269 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:23:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:53:17.265840+00:00'
        RETURNING id
        
2025-05-21 11:23:17,269 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:24:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:24:17,257 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:54:17.253594+00:00'
        RETURNING id
        
2025-05-21 11:24:17,258 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:25:17,256 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:25:17,256 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:55:17.252000+00:00'
        RETURNING id
        
2025-05-21 11:25:17,256 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:26:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:26:17,257 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:56:17.252980+00:00'
        RETURNING id
        
2025-05-21 11:26:17,257 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:27:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:27:17,264 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:57:17.256195+00:00'
        RETURNING id
        
2025-05-21 11:27:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:28:17,272 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:28:17,273 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:58:17.263923+00:00'
        RETURNING id
        
2025-05-21 11:28:17,276 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:29:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:29:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 05:59:17.252712+00:00'
        RETURNING id
        
2025-05-21 11:29:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:30:17,256 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:30:17,256 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:00:17.251669+00:00'
        RETURNING id
        
2025-05-21 11:30:17,257 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:31:17,271 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:31:17,271 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:01:17.266668+00:00'
        RETURNING id
        
2025-05-21 11:31:17,272 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:32:17,261 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:32:17,261 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:02:17.256873+00:00'
        RETURNING id
        
2025-05-21 11:32:17,262 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:33:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:33:17,266 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:03:17.262036+00:00'
        RETURNING id
        
2025-05-21 11:33:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:34:17,268 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:34:17,268 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:04:17.262898+00:00'
        RETURNING id
        
2025-05-21 11:34:17,271 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:35:17,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:35:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:05:17.254515+00:00'
        RETURNING id
        
2025-05-21 11:35:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:36:17,269 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:36:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:06:17.263075+00:00'
        RETURNING id
        
2025-05-21 11:36:17,270 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:37:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:37:17,264 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:07:17.260352+00:00'
        RETURNING id
        
2025-05-21 11:37:17,264 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:38:17,312 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:38:17,314 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:08:17.274264+00:00'
        RETURNING id
        
2025-05-21 11:38:17,318 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:39:17,267 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:39:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:09:17.263544+00:00'
        RETURNING id
        
2025-05-21 11:39:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:40:17,269 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:40:17,270 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:10:17.263756+00:00'
        RETURNING id
        
2025-05-21 11:40:17,270 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:41:17,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:41:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:11:17.253779+00:00'
        RETURNING id
        
2025-05-21 11:41:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:42:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:42:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:12:17.262734+00:00'
        RETURNING id
        
2025-05-21 11:42:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:43:17,260 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:43:17,260 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:13:17.256263+00:00'
        RETURNING id
        
2025-05-21 11:43:17,261 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:44:17,269 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:44:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:14:17.262568+00:00'
        RETURNING id
        
2025-05-21 11:44:17,272 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:45:17,269 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:45:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:15:17.265358+00:00'
        RETURNING id
        
2025-05-21 11:45:17,270 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:46:17,268 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:46:17,268 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:16:17.264692+00:00'
        RETURNING id
        
2025-05-21 11:46:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:47:17,255 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:47:17,255 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:17:17.251849+00:00'
        RETURNING id
        
2025-05-21 11:47:17,256 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:48:17,259 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:48:17,259 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:18:17.254993+00:00'
        RETURNING id
        
2025-05-21 11:48:17,260 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:49:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:49:17,263 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:19:17.259789+00:00'
        RETURNING id
        
2025-05-21 11:49:17,266 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:50:17,259 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:50:17,259 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:20:17.252130+00:00'
        RETURNING id
        
2025-05-21 11:50:17,262 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:51:17,262 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:51:17,262 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:21:17.257736+00:00'
        RETURNING id
        
2025-05-21 11:51:17,263 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:52:17,269 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:52:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:22:17.264651+00:00'
        RETURNING id
        
2025-05-21 11:52:17,270 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:53:17,269 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:53:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:23:17.262907+00:00'
        RETURNING id
        
2025-05-21 11:53:17,269 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:54:17,264 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:54:17,265 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:24:17.260818+00:00'
        RETURNING id
        
2025-05-21 11:54:17,265 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:55:17,278 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:55:17,278 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:25:17.265620+00:00'
        RETURNING id
        
2025-05-21 11:55:17,278 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:56:17,271 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:56:17,271 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:26:17.258084+00:00'
        RETURNING id
        
2025-05-21 11:56:17,271 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:57:17,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:57:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:27:17.254203+00:00'
        RETURNING id
        
2025-05-21 11:57:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:58:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:58:17,264 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:28:17.255969+00:00'
        RETURNING id
        
2025-05-21 11:58:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 11:59:17,259 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 11:59:17,259 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:29:17.253769+00:00'
        RETURNING id
        
2025-05-21 11:59:17,260 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:00:17,275 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:00:17,276 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:30:17.262773+00:00'
        RETURNING id
        
2025-05-21 12:00:17,279 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:01:17,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:01:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:31:17.253743+00:00'
        RETURNING id
        
2025-05-21 12:01:17,258 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:02:17,264 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:02:17,264 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:32:17.260676+00:00'
        RETURNING id
        
2025-05-21 12:02:17,265 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:03:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:03:17,263 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:33:17.258252+00:00'
        RETURNING id
        
2025-05-21 12:03:17,264 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:04:17,269 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:04:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:34:17.257085+00:00'
        RETURNING id
        
2025-05-21 12:04:17,270 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:05:17,262 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:05:17,263 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:35:17.250761+00:00'
        RETURNING id
        
2025-05-21 12:05:17,263 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:06:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:06:17,264 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:36:17.260036+00:00'
        RETURNING id
        
2025-05-21 12:06:17,264 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:07:17,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:07:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:37:17.254141+00:00'
        RETURNING id
        
2025-05-21 12:07:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:08:17,268 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:08:17,268 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:38:17.264512+00:00'
        RETURNING id
        
2025-05-21 12:08:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:09:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:09:17,257 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:39:17.254464+00:00'
        RETURNING id
        
2025-05-21 12:09:17,258 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:10:17,267 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:10:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:40:17.263045+00:00'
        RETURNING id
        
2025-05-21 12:10:17,268 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:11:17,278 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:11:17,278 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:41:17.265614+00:00'
        RETURNING id
        
2025-05-21 12:11:17,279 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:12:17,267 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:12:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:42:17.262995+00:00'
        RETURNING id
        
2025-05-21 12:12:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:13:17,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:13:17,259 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:43:17.252781+00:00'
        RETURNING id
        
2025-05-21 12:13:17,262 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:14:17,261 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:14:17,261 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:44:17.257658+00:00'
        RETURNING id
        
2025-05-21 12:14:17,262 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:15:17,261 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:15:17,261 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:45:17.253138+00:00'
        RETURNING id
        
2025-05-21 12:15:17,264 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:16:17,268 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:16:17,268 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:46:17.263828+00:00'
        RETURNING id
        
2025-05-21 12:16:17,269 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:17:17,276 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:17:17,276 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:47:17.263093+00:00'
        RETURNING id
        
2025-05-21 12:17:17,276 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:18:17,260 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:18:17,261 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:48:17.255657+00:00'
        RETURNING id
        
2025-05-21 12:18:17,261 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:19:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:19:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:49:17.253456+00:00'
        RETURNING id
        
2025-05-21 12:19:17,258 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:20:17,265 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:20:17,265 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:50:17.261176+00:00'
        RETURNING id
        
2025-05-21 12:20:17,266 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:21:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:21:17,257 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:51:17.251961+00:00'
        RETURNING id
        
2025-05-21 12:21:17,261 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:22:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:22:17,268 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:52:17.257390+00:00'
        RETURNING id
        
2025-05-21 12:22:17,272 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:23:17,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:23:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:53:17.251631+00:00'
        RETURNING id
        
2025-05-21 12:23:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:24:17,264 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:24:17,265 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:54:17.260522+00:00'
        RETURNING id
        
2025-05-21 12:24:17,266 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:25:17,272 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:25:17,272 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:55:17.259121+00:00'
        RETURNING id
        
2025-05-21 12:25:17,273 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:26:17,257 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:26:17,257 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:56:17.252916+00:00'
        RETURNING id
        
2025-05-21 12:26:17,257 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:27:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:27:17,267 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:57:17.252544+00:00'
        RETURNING id
        
2025-05-21 12:27:17,267 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:28:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:28:17,287 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:58:17.260395+00:00'
        RETURNING id
        
2025-05-21 12:28:17,288 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:29:17,265 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:29:17,272 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 06:59:17.261156+00:00'
        RETURNING id
        
2025-05-21 12:29:17,273 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:30:17,260 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:30:17,260 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:00:17.255816+00:00'
        RETURNING id
        
2025-05-21 12:30:17,260 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:31:17,258 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:31:17,258 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:01:17.253227+00:00'
        RETURNING id
        
2025-05-21 12:31:17,259 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:32:17,268 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:32:17,269 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:02:17.265056+00:00'
        RETURNING id
        
2025-05-21 12:32:17,269 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:33:17,266 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:33:17,266 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:03:17.261810+00:00'
        RETURNING id
        
2025-05-21 12:33:17,275 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:34:17,259 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:34:17,268 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:04:17.254910+00:00'
        RETURNING id
        
2025-05-21 12:34:17,269 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:35:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:35:17,263 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:05:17.259046+00:00'
        RETURNING id
        
2025-05-21 12:35:17,263 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:36:17,268 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:36:17,268 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:06:17.264616+00:00'
        RETURNING id
        
2025-05-21 12:36:17,269 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:37:17,262 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:37:17,262 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:07:17.258762+00:00'
        RETURNING id
        
2025-05-21 12:37:17,263 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:38:17,263 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:38:17,263 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:08:17.259828+00:00'
        RETURNING id
        
2025-05-21 12:38:17,264 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:39:17,273 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:39:17,274 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:09:17.259577+00:00'
        RETURNING id
        
2025-05-21 12:39:17,275 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:40:17,264 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:40:17,264 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:10:17.260266+00:00'
        RETURNING id
        
2025-05-21 12:40:17,264 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-21 12:41:17,264 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-21 12:41:17,265 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-21 07:11:17.251418+00:00'
        RETURNING id
        
2025-05-21 12:41:17,265 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:24:53,043 - api.utils.logging - INFO - Logging system initialized
2025-05-23 10:24:53,859 - api.utils.logging - INFO - Executing operation: SELECT uuid, course_id, job_details FROM course_generation_jobs WHERE status = 'started'
2025-05-23 10:24:53,859 - api.utils.logging - INFO - Executing operation: SELECT uuid, job_details FROM task_generation_jobs WHERE status = 'started'
2025-05-23 10:25:53,224 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:25:53,225 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 04:55:53.212026+00:00'
        RETURNING id
        
2025-05-23 10:25:53,228 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:26:53,210 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:26:53,210 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 04:56:53.206526+00:00'
        RETURNING id
        
2025-05-23 10:26:53,213 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:27:09,876 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:27:09,887 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:27:09,894 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-23 10:27:09,897 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:27:09,901 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-23 10:27:09,902 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-23 10:27:09,902 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-23 10:27:09,903 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-23 10:27:53,210 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:27:53,210 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 04:57:53.207450+00:00'
        RETURNING id
        
2025-05-23 10:27:53,211 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:28:53,217 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:28:53,217 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 04:58:53.213770+00:00'
        RETURNING id
        
2025-05-23 10:28:53,218 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:29:53,211 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:29:53,211 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 04:59:53.207747+00:00'
        RETURNING id
        
2025-05-23 10:29:53,212 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:30:53,211 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:30:53,211 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:00:53.208321+00:00'
        RETURNING id
        
2025-05-23 10:30:53,212 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:31:53,210 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:31:53,210 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:01:53.207670+00:00'
        RETURNING id
        
2025-05-23 10:31:53,211 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:32:53,210 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:32:53,210 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:02:53.206698+00:00'
        RETURNING id
        
2025-05-23 10:32:53,210 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:33:48,276 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:33:48,287 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:33:48,314 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-23 10:33:48,325 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:33:48,333 - api.utils.logging - INFO - Executing operation: SELECT * FROM organizations WHERE id = 1
2025-05-23 10:33:48,341 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-23 10:33:48,349 - api.utils.logging - INFO - Executing operation: SELECT uo.user_id, u.email, uo.role 
        FROM user_organizations uo
        JOIN users u ON uo.user_id = u.id 
        WHERE uo.org_id = 1
2025-05-23 10:33:48,357 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-23 10:33:48,366 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name
        FROM cohorts c
        WHERE c.org_id = 1
        ORDER BY c.id DESC
        
2025-05-23 10:33:48,375 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-23 10:33:48,383 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-23 10:33:48,403 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:33:50,790 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:33:50,793 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-23 10:33:50,795 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:33:50,797 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:33:50,800 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-23 10:33:50,801 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-23 10:33:50,802 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-23 10:33:50,802 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-23 10:33:53,215 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:33:53,215 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:03:53.211501+00:00'
        RETURNING id
        
2025-05-23 10:33:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:34:53,218 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:34:53,219 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:04:53.215943+00:00'
        RETURNING id
        
2025-05-23 10:34:53,219 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:35:53,222 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:35:53,223 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:05:53.219858+00:00'
        RETURNING id
        
2025-05-23 10:35:53,223 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:36:53,215 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:36:53,216 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:06:53.211789+00:00'
        RETURNING id
        
2025-05-23 10:36:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:37:53,218 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:37:53,218 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:07:53.215295+00:00'
        RETURNING id
        
2025-05-23 10:37:53,218 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:38:53,221 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:38:53,221 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:08:53.218002+00:00'
        RETURNING id
        
2025-05-23 10:38:53,222 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:39:53,215 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:39:53,215 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:09:53.211631+00:00'
        RETURNING id
        
2025-05-23 10:39:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:40:53,215 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:40:53,216 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:10:53.211812+00:00'
        RETURNING id
        
2025-05-23 10:40:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:41:53,213 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:41:53,214 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:11:53.207369+00:00'
        RETURNING id
        
2025-05-23 10:41:53,214 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:42:53,213 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:42:53,213 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:12:53.207051+00:00'
        RETURNING id
        
2025-05-23 10:42:53,214 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:43:53,215 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:43:53,215 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:13:53.211682+00:00'
        RETURNING id
        
2025-05-23 10:43:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:44:22,282 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:44:22,290 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:44:22,332 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-23 10:44:22,351 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-23 10:44:22,367 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-23 10:44:22,388 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-23 10:44:22,396 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:44:22,403 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-23 10:44:22,409 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-23 10:44:22,416 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-23 10:44:22,427 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-23 10:44:53,226 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:44:53,226 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:14:53.222770+00:00'
        RETURNING id
        
2025-05-23 10:44:53,228 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:45:53,228 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:45:53,228 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:15:53.216465+00:00'
        RETURNING id
        
2025-05-23 10:45:53,229 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:46:14,030 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-23 10:46:14,035 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-23 10:46:16,973 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:46:16,981 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:46:16,983 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-23 10:46:16,987 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:46:16,989 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-23 10:46:16,990 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-23 10:46:16,990 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-23 10:46:16,991 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-23 10:46:18,939 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:46:18,946 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:46:18,971 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-23 10:46:18,978 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-23 10:46:18,981 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:46:18,981 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-23 10:46:18,983 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-23 10:46:18,990 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-23 10:46:19,009 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-23 10:46:19,015 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-23 10:46:19,022 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-23 10:46:53,213 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:46:53,214 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:16:53.209909+00:00'
        RETURNING id
        
2025-05-23 10:46:53,214 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:47:22,148 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-23 10:47:22,157 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-23 10:47:35,606 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:47:35,617 - api.utils.logging - INFO - Executing operation: 
        SELECT c.id, c.name, uc.role, o.id, o.name
        FROM cohorts c
        JOIN user_cohorts uc ON uc.cohort_id = c.id
        JOIN organizations o ON o.id = c.org_id
        WHERE uc.user_id = 1
        
2025-05-23 10:47:35,621 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:47:35,626 - api.utils.logging - INFO - Executing operation: SELECT id, name FROM courses WHERE org_id = 1 ORDER BY id DESC
2025-05-23 10:47:35,627 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 3
2025-05-23 10:47:35,627 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 2
2025-05-23 10:47:35,627 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, o.id, o.name, o.slug FROM courses c JOIN organizations o ON c.org_id = o.id WHERE c.id = 1
2025-05-23 10:47:35,635 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:47:37,881 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:47:37,889 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:47:37,913 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-23 10:47:37,913 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-23 10:47:37,920 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-23 10:47:37,934 - api.utils.logging - INFO - Executing operation: 
        SELECT ch.id, ch.name 
        FROM cohorts ch
        JOIN course_cohorts cc ON ch.id = cc.cohort_id
        WHERE cc.course_id = 3
        
2025-05-23 10:47:37,938 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-23 10:47:37,941 - api.utils.logging - INFO - Executing operation: SELECT uo.org_id, o.name, uo.role, o.openai_api_key, o.openai_free_trial
        FROM user_organizations uo
        JOIN organizations o ON uo.org_id = o.id 
        WHERE uo.user_id = 1 ORDER BY uo.id DESC
2025-05-23 10:47:37,948 - api.utils.logging - INFO - Executing operation: SELECT c.id, c.name, cgj.status as course_generation_status FROM courses c LEFT JOIN course_generation_jobs cgj ON c.id = cgj.course_id WHERE c.id = 3
2025-05-23 10:47:37,956 - api.utils.logging - INFO - Executing operation: SELECT m.id, m.name, m.color, cm.ordering 
            FROM course_milestones cm
            JOIN milestones m ON cm.milestone_id = m.id
            WHERE cm.course_id = 3 ORDER BY cm.ordering
2025-05-23 10:47:37,962 - api.utils.logging - INFO - Executing operation: SELECT t.id, t.title, t.type, t.status, t.scheduled_publish_at, ct.milestone_id, ct.ordering,
            (CASE WHEN t.type = 'quiz' THEN 
                (SELECT COUNT(*) FROM questions q 
                 WHERE q.task_id = t.id)
             ELSE NULL END) as num_questions,
            tgj.status as task_generation_status
            FROM course_tasks ct
            JOIN tasks t ON ct.task_id = t.id
            LEFT JOIN task_generation_jobs tgj ON t.id = tgj.task_id
            WHERE ct.course_id = 3 AND t.deleted_at IS NULL
            
            ORDER BY ct.milestone_id, ct.ordering
2025-05-23 10:47:40,294 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-23 10:47:40,301 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-23 10:47:40,311 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-23 10:47:40,316 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-23 10:47:41,595 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-23 10:47:41,600 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-23 10:47:41,604 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-23 10:47:41,608 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-23 10:47:53,210 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:47:53,210 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:17:53.206577+00:00'
        RETURNING id
        
2025-05-23 10:47:53,211 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:48:53,211 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:48:53,211 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:18:53.208523+00:00'
        RETURNING id
        
2025-05-23 10:48:53,212 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:49:53,215 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:49:53,215 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:19:53.212262+00:00'
        RETURNING id
        
2025-05-23 10:49:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:50:04,904 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-23 10:50:04,908 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-23 10:50:27,844 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-23 10:50:27,849 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-23 10:50:53,211 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:50:53,211 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:20:53.207337+00:00'
        RETURNING id
        
2025-05-23 10:50:53,211 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:51:12,394 - api.utils.logging - INFO - Executing operation: 
        SELECT id, title, type, status, org_id, scheduled_publish_at
        FROM tasks
        WHERE id = 4 AND deleted_at IS NULL
        
2025-05-23 10:51:12,400 - api.utils.logging - INFO - Executing operation: SELECT blocks FROM tasks WHERE id = 4
2025-05-23 10:51:53,223 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:51:53,223 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:21:53.219561+00:00'
        RETURNING id
        
2025-05-23 10:51:53,224 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:52:53,222 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:52:53,222 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:22:53.219321+00:00'
        RETURNING id
        
2025-05-23 10:52:53,223 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:53:53,222 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:53:53,223 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:23:53.218829+00:00'
        RETURNING id
        
2025-05-23 10:53:53,223 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:54:53,214 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:54:53,215 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:24:53.210265+00:00'
        RETURNING id
        
2025-05-23 10:54:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:55:53,228 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:55:53,228 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:25:53.224463+00:00'
        RETURNING id
        
2025-05-23 10:55:53,228 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:56:53,223 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:56:53,223 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:26:53.220272+00:00'
        RETURNING id
        
2025-05-23 10:56:53,224 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:57:53,213 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:57:53,213 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:27:53.208844+00:00'
        RETURNING id
        
2025-05-23 10:57:53,214 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:58:53,210 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:58:53,210 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:28:53.206373+00:00'
        RETURNING id
        
2025-05-23 10:58:53,219 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 10:59:53,225 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 10:59:53,225 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:29:53.211958+00:00'
        RETURNING id
        
2025-05-23 10:59:53,226 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:00:53,211 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:00:53,211 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:30:53.206875+00:00'
        RETURNING id
        
2025-05-23 11:00:53,211 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:01:53,224 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:01:53,224 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:31:53.212505+00:00'
        RETURNING id
        
2025-05-23 11:01:53,224 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:02:53,220 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:02:53,220 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:32:53.216593+00:00'
        RETURNING id
        
2025-05-23 11:02:53,221 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:03:53,216 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:03:53,216 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:33:53.212991+00:00'
        RETURNING id
        
2025-05-23 11:03:53,217 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:04:53,223 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:04:53,224 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:34:53.219449+00:00'
        RETURNING id
        
2025-05-23 11:04:53,224 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:05:53,215 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:05:53,215 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:35:53.211612+00:00'
        RETURNING id
        
2025-05-23 11:05:53,215 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:06:53,218 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:06:53,218 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:36:53.213718+00:00'
        RETURNING id
        
2025-05-23 11:06:53,218 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:07:53,219 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:07:53,219 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:37:53.215612+00:00'
        RETURNING id
        
2025-05-23 11:07:53,220 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:08:53,212 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:08:53,212 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:38:53.207996+00:00'
        RETURNING id
        
2025-05-23 11:08:53,213 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:09:53,223 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:09:53,223 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:39:53.219907+00:00'
        RETURNING id
        
2025-05-23 11:09:53,224 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:10:53,223 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:10:53,224 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:40:53.219970+00:00'
        RETURNING id
        
2025-05-23 11:10:53,224 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:11:53,215 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:11:53,216 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:41:53.211112+00:00'
        RETURNING id
        
2025-05-23 11:11:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:12:53,211 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:12:53,211 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:42:53.207240+00:00'
        RETURNING id
        
2025-05-23 11:12:53,211 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:13:53,225 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:13:53,226 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:43:53.222046+00:00'
        RETURNING id
        
2025-05-23 11:13:53,226 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:14:53,218 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:14:53,218 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:44:53.215470+00:00'
        RETURNING id
        
2025-05-23 11:14:53,218 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:15:53,220 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:15:53,221 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:45:53.216678+00:00'
        RETURNING id
        
2025-05-23 11:15:53,221 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:16:53,222 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:16:53,222 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:46:53.209115+00:00'
        RETURNING id
        
2025-05-23 11:16:53,223 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:17:53,216 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:17:53,216 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:47:53.213163+00:00'
        RETURNING id
        
2025-05-23 11:17:53,217 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:18:53,231 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:18:53,232 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:48:53.219846+00:00'
        RETURNING id
        
2025-05-23 11:18:53,232 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:19:53,220 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:19:53,221 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:49:53.217192+00:00'
        RETURNING id
        
2025-05-23 11:19:53,221 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:20:53,218 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:20:53,218 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:50:53.214907+00:00'
        RETURNING id
        
2025-05-23 11:20:53,219 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:21:53,227 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:21:53,228 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:51:53.224266+00:00'
        RETURNING id
        
2025-05-23 11:21:53,228 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:22:53,216 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:22:53,216 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:52:53.212289+00:00'
        RETURNING id
        
2025-05-23 11:22:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:23:53,219 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:23:53,219 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:53:53.216096+00:00'
        RETURNING id
        
2025-05-23 11:23:53,220 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:24:53,222 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:24:53,222 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:54:53.210181+00:00'
        RETURNING id
        
2025-05-23 11:24:53,222 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:25:53,224 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:25:53,224 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:55:53.220559+00:00'
        RETURNING id
        
2025-05-23 11:25:53,225 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:26:53,218 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:26:53,218 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:56:53.214826+00:00'
        RETURNING id
        
2025-05-23 11:26:53,219 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:27:53,212 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:27:53,212 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:57:53.208456+00:00'
        RETURNING id
        
2025-05-23 11:27:53,213 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:28:53,218 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:28:53,218 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:58:53.214469+00:00'
        RETURNING id
        
2025-05-23 11:28:53,219 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:29:53,213 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:29:53,213 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 05:59:53.209990+00:00'
        RETURNING id
        
2025-05-23 11:29:53,214 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:30:53,215 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:30:53,215 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:00:53.211174+00:00'
        RETURNING id
        
2025-05-23 11:30:53,215 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:31:53,222 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:31:53,222 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:01:53.218334+00:00'
        RETURNING id
        
2025-05-23 11:31:53,222 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:32:53,210 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:32:53,210 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:02:53.206689+00:00'
        RETURNING id
        
2025-05-23 11:32:53,211 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:33:53,213 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:33:53,214 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:03:53.209911+00:00'
        RETURNING id
        
2025-05-23 11:33:53,214 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:34:53,212 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:34:53,212 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:04:53.209323+00:00'
        RETURNING id
        
2025-05-23 11:34:53,213 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:35:53,212 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:35:53,212 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:05:53.208791+00:00'
        RETURNING id
        
2025-05-23 11:35:53,213 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:36:53,221 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:36:53,221 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:06:53.217346+00:00'
        RETURNING id
        
2025-05-23 11:36:53,222 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:37:53,222 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:37:53,222 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:07:53.218110+00:00'
        RETURNING id
        
2025-05-23 11:37:53,222 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:38:53,227 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:38:53,228 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:08:53.214721+00:00'
        RETURNING id
        
2025-05-23 11:38:53,228 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:39:53,214 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:39:53,214 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:09:53.210553+00:00'
        RETURNING id
        
2025-05-23 11:39:53,214 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:40:53,229 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:40:53,230 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:10:53.226118+00:00'
        RETURNING id
        
2025-05-23 11:40:53,230 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:41:53,218 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:41:53,218 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:11:53.206379+00:00'
        RETURNING id
        
2025-05-23 11:41:53,219 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:42:53,211 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:42:53,211 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:12:53.207260+00:00'
        RETURNING id
        
2025-05-23 11:42:53,211 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:43:53,216 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:43:53,216 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:13:53.212420+00:00'
        RETURNING id
        
2025-05-23 11:43:53,216 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:44:53,224 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:44:53,224 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:14:53.220262+00:00'
        RETURNING id
        
2025-05-23 11:44:53,224 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:45:53,210 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:45:53,210 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:15:53.207111+00:00'
        RETURNING id
        
2025-05-23 11:45:53,210 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:46:53,214 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:46:53,214 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:16:53.210555+00:00'
        RETURNING id
        
2025-05-23 11:46:53,215 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:47:53,216 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:47:53,216 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:17:53.212306+00:00'
        RETURNING id
        
2025-05-23 11:47:53,217 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:48:53,220 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:48:53,220 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:18:53.216507+00:00'
        RETURNING id
        
2025-05-23 11:48:53,220 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:49:53,217 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:49:53,217 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:19:53.213336+00:00'
        RETURNING id
        
2025-05-23 11:49:53,217 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:50:53,229 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:50:53,229 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:20:53.226208+00:00'
        RETURNING id
        
2025-05-23 11:50:53,230 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:51:53,220 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:51:53,220 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:21:53.216676+00:00'
        RETURNING id
        
2025-05-23 11:51:53,220 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:52:53,212 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:52:53,212 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:22:53.208560+00:00'
        RETURNING id
        
2025-05-23 11:52:53,222 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:53:53,211 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:53:53,211 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:23:53.208608+00:00'
        RETURNING id
        
2025-05-23 11:53:53,212 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:54:53,214 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:54:53,214 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:24:53.210579+00:00'
        RETURNING id
        
2025-05-23 11:54:53,214 - api.utils.logging - INFO - Executing operation: COMMIT
2025-05-23 11:55:53,220 - api.utils.logging - INFO - Executing operation: BEGIN 
2025-05-23 11:55:53,220 - api.utils.logging - INFO - Executing operation: 
        UPDATE tasks
        SET scheduled_publish_at = NULL
        WHERE status = 'published'
        AND scheduled_publish_at IS NOT NULL AND deleted_at IS NULL
        AND scheduled_publish_at <= '2025-05-23 06:25:53.216388+00:00'
        RETURNING id
        
2025-05-23 11:55:53,220 - api.utils.logging - INFO - Executing operation: COMMIT
